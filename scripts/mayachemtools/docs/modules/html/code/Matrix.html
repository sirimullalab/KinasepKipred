<html>
<head>
<title>MayaChemTools:Code:Matrix.pm</title>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../../css/MayaChemToolsCode.css">
</head>
<body leftmargin="20" rightmargin="20" topmargin="10" bottommargin="10">
<br/>
<center>
<a href="http://www.mayachemtools.org" title="MayaChemTools Home"><img src="../../../images/MayaChemToolsLogo.gif" border="0" alt="MayaChemTools"></a>
</center>
<br/>
<pre>
<a name="package-Matrix-"></a>   1 <span class="k">package </span><span class="i">Matrix</span><span class="sc">;</span>
   2 <span class="c">#</span>
   3 <span class="c"># File: Matrix.pm</span>
   4 <span class="c"># Author: Manish Sud &lt;msud@san.rr.com&gt;</span>
   5 <span class="c">#</span>
   6 <span class="c"># Copyright (C) 2018 Manish Sud. All rights reserved.</span>
   7 <span class="c">#</span>
   8 <span class="c"># This file is part of MayaChemTools.</span>
   9 <span class="c">#</span>
  10 <span class="c"># MayaChemTools is free software; you can redistribute it and/or modify it under</span>
  11 <span class="c"># the terms of the GNU Lesser General Public License as published by the Free</span>
  12 <span class="c"># Software Foundation; either version 3 of the License, or (at your option) any</span>
  13 <span class="c"># later version.</span>
  14 <span class="c">#</span>
  15 <span class="c"># MayaChemTools is distributed in the hope that it will be useful, but without</span>
  16 <span class="c"># any warranty; without even the implied warranty of merchantability of fitness</span>
  17 <span class="c"># for a particular purpose.  See the GNU Lesser General Public License for more</span>
  18 <span class="c"># details.</span>
  19 <span class="c">#</span>
  20 <span class="c"># You should have received a copy of the GNU Lesser General Public License</span>
  21 <span class="c"># along with MayaChemTools; if not, see &lt;http://www.gnu.org/licenses/&gt; or</span>
  22 <span class="c"># write to the Free Software Foundation Inc., 59 Temple Place, Suite 330,</span>
  23 <span class="c"># Boston, MA, 02111-1307, USA.</span>
  24 <span class="c">#</span>
  25 
  26 <span class="k">use</span> <span class="w">strict</span><span class="sc">;</span>
  27 <span class="k">use</span> <span class="w">Carp</span><span class="sc">;</span>
  28 <span class="k">use</span> <span class="w">Exporter</span><span class="sc">;</span>
  29 <span class="k">use</span> <span class="w">Scalar::Util</span> <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  30 <span class="k">use</span> <span class="w">Vector</span><span class="sc">;</span>
  31 
  32 <span class="k">use</span> <span class="w">vars</span> <span class="q">qw(@ISA @EXPORT @EXPORT_OK %EXPORT_TAGS)</span><span class="sc">;</span>
  33 
  34 <span class="i">@ISA</span> = <span class="q">qw(Exporter)</span><span class="sc">;</span>
  35 <span class="i">@EXPORT</span> = <span class="q">qw(IsMatrix IdentityMatrix NewFromRows NewFromColumns NewFromDiagonal UnitMatrix ZeroMatrix)</span><span class="sc">;</span>
  36 <span class="i">@EXPORT_OK</span> = <span class="q">qw(SetValuePrintFormat)</span><span class="sc">;</span>
  37 
  38 <span class="i">%EXPORT_TAGS</span> = <span class="s">(</span>
  39                 <span class="w">all</span>  <span class="cm">=&gt;</span> <span class="s">[</span><span class="i">@EXPORT</span><span class="cm">,</span> <span class="i">@EXPORT_OK</span><span class="s">]</span>
  40                <span class="s">)</span><span class="sc">;</span>
  41 
  42 <span class="c"># Setup class variables...</span>
  43 <span class="k">my</span><span class="s">(</span><span class="i">$ClassName</span><span class="cm">,</span> <span class="i">$ValueFormat</span><span class="cm">,</span> <span class="i">$MatrixPrintStyle</span><span class="s">)</span><span class="sc">;</span>
  44 <span class="i">_InitializeClass</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  45 
  46 <span class="c">#</span>
  47 <span class="c"># Using the following explicity overloaded operators, Perl automatically generates methods</span>
  48 <span class="c"># for operations with no explicitly defined methods. Autogenerated methods are possible for</span>
  49 <span class="c"># these operators:</span>
  50 <span class="c">#</span>
  51 <span class="c">#    o Arithmetic operators: += -= *= /= **= %= ++ -- x= .=</span>
  52 <span class="c">#    o Increment and decrement: ++ --</span>
  53 <span class="c">#</span>
  54 <span class="c"># &#39;fallback&#39; is set to &#39;false&#39; to raise exception for all other operators.</span>
  55 <span class="c">#</span>
  56 <span class="k">use</span> <span class="w">overload</span> <span class="q">&#39;&quot;&quot;&#39;</span> <span class="cm">=&gt;</span> <span class="q">&#39;StringifyMatrix&#39;</span><span class="cm">,</span>
  57 
  58   <span class="q">&#39;@{}&#39;</span> <span class="cm">=&gt;</span> <span class="q">&#39;_MatrixToArrayOperator&#39;</span><span class="cm">,</span>
  59 
  60   <span class="q">&#39;+&#39;</span> <span class="cm">=&gt;</span> <span class="q">&#39;_MatrixAdditionOperator&#39;</span><span class="cm">,</span>
  61   <span class="q">&#39;-&#39;</span> <span class="cm">=&gt;</span> <span class="q">&#39;_MatrixSubtractionOperator&#39;</span><span class="cm">,</span>
  62   <span class="q">&#39;*&#39;</span> <span class="cm">=&gt;</span> <span class="q">&#39;_MatrixMultiplicationOperator&#39;</span><span class="cm">,</span>
  63   <span class="q">&#39;/&#39;</span> <span class="cm">=&gt;</span> <span class="q">&#39;_MatrixDivisionOperator&#39;</span><span class="cm">,</span>
  64   <span class="q">&#39;**&#39;</span> <span class="cm">=&gt;</span> <span class="q">&#39;_MatrixExponentiationOperator&#39;</span><span class="cm">,</span>
  65   <span class="q">&#39;%&#39;</span> <span class="cm">=&gt;</span> <span class="q">&#39;_MatrixModulusOperator&#39;</span><span class="cm">,</span>
  66 
  67   <span class="q">&#39;bool&#39;</span> <span class="cm">=&gt;</span> <span class="q">&#39;_MatrixBooleanOperator&#39;</span><span class="cm">,</span>
  68   <span class="q">&#39;!&#39;</span> <span class="cm">=&gt;</span> <span class="q">&#39;_MatrixNotBooleanOperator&#39;</span><span class="cm">,</span>
  69 
  70   <span class="q">&#39;==&#39;</span> <span class="cm">=&gt;</span> <span class="q">&#39;_MatrixEqualOperator&#39;</span><span class="cm">,</span>
  71   <span class="q">&#39;!=&#39;</span> <span class="cm">=&gt;</span> <span class="q">&#39;_MatrixNotEqualOperator&#39;</span><span class="cm">,</span>
  72   <span class="q">&#39;&lt;&#39;</span> <span class="cm">=&gt;</span> <span class="q">&#39;_MatrixLessThanOperator&#39;</span><span class="cm">,</span>
  73   <span class="q">&#39;&lt;=&#39;</span> <span class="cm">=&gt;</span> <span class="q">&#39;_MatrixLessThanEqualOperator&#39;</span><span class="cm">,</span>
  74   <span class="q">&#39;&gt;&#39;</span> <span class="cm">=&gt;</span> <span class="q">&#39;_MatrixGreatarThanOperator&#39;</span><span class="cm">,</span>
  75   <span class="q">&#39;&gt;=&#39;</span> <span class="cm">=&gt;</span> <span class="q">&#39;_MatrixGreatarThanEqualOperator&#39;</span><span class="cm">,</span>
  76 
  77   <span class="q">&#39;neg&#39;</span> <span class="cm">=&gt;</span> <span class="q">&#39;_MatrixNegativeValueOperator&#39;</span><span class="cm">,</span>
  78 
  79   <span class="q">&#39;abs&#39;</span> <span class="cm">=&gt;</span> <span class="q">&#39;_MatrixAbsoluteValueOperator&#39;</span><span class="cm">,</span>
  80   <span class="q">&#39;exp&#39;</span> <span class="cm">=&gt;</span> <span class="q">&#39;_MatrixExpNaturalBaseOperator&#39;</span><span class="cm">,</span>
  81   <span class="q">&#39;log&#39;</span> <span class="cm">=&gt;</span> <span class="q">&#39;_MatrixLogNaturalBaseOperator&#39;</span><span class="cm">,</span>
  82   <span class="q">&#39;sqrt&#39;</span> <span class="cm">=&gt;</span> <span class="q">&#39;_MatrixSquareRootOperator&#39;</span><span class="cm">,</span>
  83   <span class="q">&#39;cos&#39;</span> <span class="cm">=&gt;</span> <span class="q">&#39;_MatrixCosineOperator&#39;</span><span class="cm">,</span>
  84   <span class="q">&#39;sin&#39;</span> <span class="cm">=&gt;</span> <span class="q">&#39;_MatrixSineOperator&#39;</span><span class="cm">,</span>
  85 
  86   <span class="q">&#39;fallback&#39;</span> <span class="cm">=&gt;</span> <span class="k">undef</span><span class="sc">;</span>
  87 
  88 <span class="c"># Class constructor...</span>
<a name="new-"></a>  89 <span class="k">sub </span><span class="m">new</span> <span class="s">{</span>
  90   <span class="k">my</span><span class="s">(</span><span class="i">$Class</span><span class="cm">,</span> <span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
  91 
  92   <span class="c"># Initialize object...</span>
  93   <span class="k">my</span> <span class="i">$This</span> = <span class="s">{</span><span class="s">}</span><span class="sc">;</span>
  94   <span class="k">bless</span> <span class="i">$This</span><span class="cm">,</span> <span class="k">ref</span><span class="s">(</span><span class="i">$Class</span><span class="s">)</span> || <span class="i">$Class</span><span class="sc">;</span>
  95   <span class="i">$This</span><span class="i">-&gt;_InitializeMatrix</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span><span class="sc">;</span>
  96 
  97   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
  98 <span class="s">}</span>
  99 
 100 <span class="c"># Initialize object data...</span>
 101 <span class="c">#</span>
<a name="_InitializeMatrix-"></a> 102 <span class="k">sub </span><span class="m">_InitializeMatrix</span> <span class="s">{</span>
 103   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 104 
 105   <span class="k">if</span> <span class="s">(</span>!<span class="s">(</span><span class="k">defined</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="s">)</span> &amp;&amp; <span class="k">defined</span><span class="s">(</span><span class="i">$NumOfCols</span><span class="s">)</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 106     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;_InitializeMatrix: NumOfRows and NumOfCols must be specified...&quot;</span><span class="sc">;</span>
 107   <span class="s">}</span>
 108   <span class="k">if</span> <span class="s">(</span>!<span class="s">(</span><span class="s">(</span><span class="i">$NumOfRows</span> &gt; <span class="n">0</span><span class="s">)</span> &amp;&amp; <span class="s">(</span><span class="i">$NumOfRows</span> &gt; <span class="n">0</span><span class="s">)</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 109     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;_InitializeMatrix: NumOfRows and NumOfCols must be a positive number...&quot;</span><span class="sc">;</span>
 110   <span class="s">}</span>
 111   <span class="c"># Initialize matrix elements to zero...</span>
 112   <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">Values</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 113 
 114   <span class="k">my</span><span class="s">(</span><span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">@EmptyRow</span><span class="s">)</span><span class="sc">;</span>
 115 
 116   <span class="i">@EmptyRow</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 117   <span class="i">@EmptyRow</span> = <span class="s">(</span><span class="q">&#39;0&#39;</span><span class="s">)</span> x <span class="i">$NumOfCols</span><span class="sc">;</span>
 118 
 119   <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 120     <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>]} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 121     <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>]} = <span class="i">@EmptyRow</span><span class="sc">;</span>
 122   <span class="s">}</span>
 123 <span class="s">}</span>
 124 
 125 <span class="c"># Initialize class ...</span>
<a name="_InitializeClass-"></a> 126 <span class="k">sub </span><span class="m">_InitializeClass</span> <span class="s">{</span>
 127   <span class="c">#Class name...</span>
 128   <span class="i">$ClassName</span> = <span class="w">__PACKAGE__</span><span class="sc">;</span>
 129 
 130   <span class="c"># Print style for matrix rows during StringifyMatrix operation.</span>
 131   <span class="c"># Possible values: AllRowsInOneLine, OneRowPerLine</span>
 132   <span class="c">#</span>
 133   <span class="i">$MatrixPrintStyle</span> = <span class="q">&quot;AllRowsInOneLine&quot;</span><span class="sc">;</span>
 134 
 135   <span class="c"># Print format for matrix values...</span>
 136   <span class="i">$ValueFormat</span> = <span class="q">&quot;%g&quot;</span><span class="sc">;</span>
 137 <span class="s">}</span>
 138 
 139 <span class="c"># Get matrix size...</span>
 140 <span class="c">#</span>
<a name="GetSize-"></a> 141 <span class="k">sub </span><span class="m">GetSize</span> <span class="s">{</span>
 142   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 143 
 144   <span class="k">return</span> <span class="s">(</span><span class="i">$This</span><span class="i">-&gt;GetNumOfRows</span><span class="s">(</span><span class="s">)</span><span class="cm">,</span> <span class="i">$This</span><span class="i">-&gt;GetNumOfColumns</span><span class="s">(</span><span class="s">)</span><span class="s">)</span><span class="sc">;</span>
 145 <span class="s">}</span>
 146 
 147 <span class="c"># Get matrix dimensions...</span>
 148 <span class="c">#</span>
<a name="GetDimension-"></a> 149 <span class="k">sub </span><span class="m">GetDimension</span> <span class="s">{</span>
 150   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 151 
 152   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 153 <span class="s">}</span>
 154 
 155 <span class="c"># Get number of rows in matrix</span>
 156 <span class="c">#</span>
<a name="GetNumOfRows-"></a> 157 <span class="k">sub </span><span class="m">GetNumOfRows</span> <span class="s">{</span>
 158   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 159   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="s">)</span><span class="sc">;</span>
 160 
 161   <span class="c"># Size of row array...</span>
 162   <span class="i">$NumOfRows</span> = <span class="i">$#</span>{<span class="i">$This</span>-&gt;{<span class="w">Values</span>}} + <span class="n">1</span><span class="sc">;</span>
 163 
 164   <span class="k">return</span> <span class="i">$NumOfRows</span><span class="sc">;</span>
 165 <span class="s">}</span>
 166 
 167 <span class="c"># Get number of columns in matrix</span>
 168 <span class="c">#</span>
<a name="GetNumOfColumns-"></a> 169 <span class="k">sub </span><span class="m">GetNumOfColumns</span> <span class="s">{</span>
 170   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 171   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfCols</span><span class="s">)</span><span class="sc">;</span>
 172 
 173   <span class="c"># Size of column array for first row assuming sizes of columns are same...</span>
 174   <span class="i">$NumOfCols</span> = <span class="i">$#</span>{<span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="n">0</span>]} + <span class="n">1</span><span class="sc">;</span>
 175 
 176   <span class="k">return</span> <span class="i">$NumOfCols</span><span class="sc">;</span>
 177 <span class="s">}</span>
 178 
 179 <span class="c"># Get reference to array holding matrix values in order to directly manipulate these values...</span>
 180 <span class="c">#</span>
<a name="GetMatrixValuesReference-"></a> 181 <span class="k">sub </span><span class="m">GetMatrixValuesReference</span> <span class="s">{</span>
 182   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 183 
 184   <span class="k">return</span> \<span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">Values</span>}}<span class="sc">;</span>
 185 <span class="s">}</span>
 186 
 187 <span class="c"># Copy matrix...</span>
 188 <span class="c">#</span>
<a name="Copy-"></a> 189 <span class="k">sub </span><span class="m">Copy</span> <span class="s">{</span>
 190   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 191   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="cm">,</span> <span class="i">$Matrix</span><span class="s">)</span><span class="sc">;</span>
 192 
 193   <span class="c"># Create a new matrix...</span>
 194   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 195   <span class="i">$Matrix</span> = <span class="i">new</span> <span class="i">Matrix</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span><span class="sc">;</span>
 196 
 197   <span class="c"># Set matrix values...</span>
 198   <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> -<span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 199     <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> -<span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 200       <span class="i">$Matrix</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] = <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>]<span class="sc">;</span>
 201     <span class="s">}</span>
 202   <span class="s">}</span>
 203   <span class="k">return</span> <span class="i">$Matrix</span><span class="sc">;</span>
 204 <span class="s">}</span>
 205 
 206 <span class="c"># Create a new matrix using rows specified in one of the following formats:</span>
 207 <span class="c">#   o List of vector objects</span>
 208 <span class="c">#   o References to list of values</span>
 209 <span class="c">#   o List of strings containing row values delimited by space</span>
 210 <span class="c">#</span>
 211 <span class="c"># Each row must contain the same number of values.</span>
 212 <span class="c">#</span>
 213 <span class="c"># This functionality can be either invoked as a class function or an</span>
 214 <span class="c"># object method.</span>
 215 <span class="c">#</span>
<a name="NewFromRows-"></a> 216 <span class="k">sub </span><span class="m">NewFromRows</span> <span class="s">{</span>
 217   <span class="k">my</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">@OtherParamaters</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 218 
 219   <span class="k">if</span> <span class="s">(</span><span class="i">IsMatrix</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 220     <span class="k">return</span> <span class="i">_NewFromRowsOrColumns</span><span class="s">(</span><span class="q">&#39;FromRows&#39;</span><span class="cm">,</span> <span class="i">@OtherParamaters</span><span class="s">)</span><span class="sc">;</span>
 221   <span class="s">}</span>
 222   <span class="k">else</span> <span class="s">{</span>
 223     <span class="k">return</span> <span class="i">_NewFromRowsOrColumns</span><span class="s">(</span><span class="q">&#39;FromRows&#39;</span><span class="cm">,</span> <span class="i">@_</span><span class="s">)</span><span class="sc">;</span>
 224   <span class="s">}</span>
 225 <span class="s">}</span>
 226 
 227 <span class="c"># Create a new matrix using columns specified in one of the following formats:</span>
 228 <span class="c">#   o List of vector objects</span>
 229 <span class="c">#   o References to list of values</span>
 230 <span class="c">#   o List of strings containing columns values delimited by space</span>
 231 <span class="c">#</span>
 232 <span class="c"># Each columns must contain the same number of values.</span>
 233 <span class="c">#</span>
 234 <span class="c"># This functionality can be either invoked as a class function or an</span>
 235 <span class="c"># object method.</span>
 236 <span class="c">#</span>
<a name="NewFromColumns-"></a> 237 <span class="k">sub </span><span class="m">NewFromColumns</span> <span class="s">{</span>
 238   <span class="k">my</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">@OtherParamaters</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 239 
 240   <span class="k">if</span> <span class="s">(</span><span class="i">IsMatrix</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 241     <span class="k">return</span> <span class="i">_NewFromRowsOrColumns</span><span class="s">(</span><span class="q">&#39;FromColumns&#39;</span><span class="cm">,</span> <span class="i">@OtherParamaters</span><span class="s">)</span><span class="sc">;</span>
 242   <span class="s">}</span>
 243   <span class="k">else</span> <span class="s">{</span>
 244     <span class="k">return</span> <span class="i">_NewFromRowsOrColumns</span><span class="s">(</span><span class="q">&#39;FromColumns&#39;</span><span class="cm">,</span> <span class="i">@_</span><span class="s">)</span><span class="sc">;</span>
 245   <span class="s">}</span>
 246 <span class="s">}</span>
 247 
 248 <span class="c"># Create a new matrix using diagonal values specified in one of the following formats:</span>
 249 <span class="c">#   o A vector object</span>
 250 <span class="c">#   o Reference to list of values</span>
 251 <span class="c">#   o Strings containing diagonal values delimited by space</span>
 252 <span class="c">#</span>
 253 <span class="c"># This functionality can be either invoked as a class function or an</span>
 254 <span class="c"># object method.</span>
 255 <span class="c">#</span>
<a name="NewFromDiagonal-"></a> 256 <span class="k">sub </span><span class="m">NewFromDiagonal</span> <span class="s">{</span>
 257   <span class="k">my</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">@OtherParamaters</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 258 
 259   <span class="k">if</span> <span class="s">(</span><span class="i">IsMatrix</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 260     <span class="k">return</span> <span class="i">_NewFromDiagonal</span><span class="s">(</span><span class="i">@OtherParamaters</span><span class="s">)</span><span class="sc">;</span>
 261   <span class="s">}</span>
 262   <span class="k">else</span> <span class="s">{</span>
 263     <span class="k">return</span> <span class="i">_NewFromDiagonal</span><span class="s">(</span><span class="i">@_</span><span class="s">)</span><span class="sc">;</span>
 264   <span class="s">}</span>
 265 <span class="s">}</span>
 266 
 267 <span class="c"># Create a new matrix using diagonal values specified in one of the following formats:</span>
 268 <span class="c">#   o A vector object</span>
 269 <span class="c">#   o Reference to list of values</span>
 270 <span class="c">#   o Strings containing diagonal values delimited by space</span>
 271 <span class="c">#</span>
<a name="_NewFromDiagonal-"></a> 272 <span class="k">sub </span><span class="m">_NewFromDiagonal</span> <span class="s">{</span>
 273   <span class="k">my</span><span class="s">(</span><span class="i">@SpecifiedDiagonalValues</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 274   <span class="k">my</span><span class="s">(</span><span class="i">$ErrorMsgPrefix</span><span class="cm">,</span> <span class="i">$CheckSizes</span><span class="cm">,</span> <span class="i">$CombineValues</span><span class="cm">,</span> <span class="i">$ValuesRefs</span><span class="cm">,</span> <span class="i">$DiagonalValuesRef</span><span class="s">)</span><span class="sc">;</span>
 275 
 276   <span class="i">$ErrorMsgPrefix</span> = <span class="q">&quot;Error: ${ClassName}::_NewFromDiagonal&quot;</span><span class="sc">;</span>
 277   <span class="k">if</span> <span class="s">(</span>!<span class="i">@SpecifiedDiagonalValues</span><span class="s">)</span> <span class="s">{</span>
 278     <span class="w">croak</span> <span class="q">&quot;$ErrorMsgPrefix: No diagonal values specified...&quot;</span><span class="sc">;</span>
 279   <span class="s">}</span>
 280 
 281   <span class="c"># Collect specified diagonal values...</span>
 282   <span class="i">$CheckSizes</span> = <span class="n">0</span><span class="sc">;</span> <span class="i">$CombineValues</span> = <span class="n">1</span><span class="sc">;</span>
 283   <span class="i">$ValuesRefs</span> = <span class="i">_ProcessSpecifiedMatrixValues</span><span class="s">(</span><span class="i">$ErrorMsgPrefix</span><span class="cm">,</span> <span class="i">$CheckSizes</span><span class="cm">,</span> <span class="i">$CombineValues</span><span class="cm">,</span> <span class="i">@SpecifiedDiagonalValues</span><span class="s">)</span><span class="sc">;</span>
 284   <span class="i">$DiagonalValuesRef</span> = <span class="i">$ValuesRefs</span>-&gt;[<span class="n">0</span>]<span class="sc">;</span>
 285 
 286   <span class="c"># Create a new matrix...</span>
 287   <span class="k">my</span><span class="s">(</span><span class="i">$Matrix</span><span class="cm">,</span> <span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="s">)</span><span class="sc">;</span>
 288 
 289   <span class="i">$NumOfRows</span> = <span class="i">@</span>{<span class="i">$DiagonalValuesRef</span>}<span class="sc">;</span>
 290   <span class="i">$NumOfCols</span> = <span class="i">$NumOfRows</span><span class="sc">;</span>
 291 
 292   <span class="i">$Matrix</span> = <span class="i">new</span> <span class="i">Matrix</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span><span class="sc">;</span>
 293 
 294   <span class="c"># Set diagonal values...</span>
 295   <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 296     <span class="i">$Matrix</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$RowIndex</span>] = <span class="i">$DiagonalValuesRef</span>-&gt;[<span class="i">$RowIndex</span>]<span class="sc">;</span>
 297   <span class="s">}</span>
 298 
 299   <span class="k">return</span> <span class="i">$Matrix</span><span class="sc">;</span>
 300 <span class="s">}</span>
 301 
 302 <span class="c"># Create a new matrix using rows or columns specified in one of the following formats:</span>
 303 <span class="c">#   o List of vector objects</span>
 304 <span class="c">#   o References to list of values</span>
 305 <span class="c">#   o List of strings containing row values delimited by space</span>
 306 <span class="c">#</span>
 307 <span class="c"># Each row or column must contain the same number of values.</span>
 308 <span class="c">#</span>
<a name="_NewFromRowsOrColumns-"></a> 309 <span class="k">sub </span><span class="m">_NewFromRowsOrColumns</span> <span class="s">{</span>
 310   <span class="k">my</span><span class="s">(</span><span class="i">$Mode</span><span class="cm">,</span> <span class="i">@SpecifiedValues</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 311 
 312   <span class="k">if</span> <span class="s">(</span><span class="i">$Mode</span> !~ <span class="q">/^(FromRows|FromColumns)$/i</span><span class="s">)</span> <span class="s">{</span>
 313     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}::_NewFromRowsOrColumns: Unknown mode: $Mode...&quot;</span><span class="sc">;</span>
 314   <span class="s">}</span>
 315   <span class="k">my</span><span class="s">(</span><span class="i">$ErrorMsgPrefix</span><span class="cm">,</span> <span class="i">$CheckSizes</span><span class="cm">,</span> <span class="i">$CombineValues</span><span class="cm">,</span> <span class="i">$ValuesRefs</span><span class="s">)</span><span class="sc">;</span>
 316 
 317   <span class="c"># Retrieve information about specified values and make sure similar number of values</span>
 318   <span class="c"># are specified for each row or column...</span>
 319   <span class="k">if</span> <span class="s">(</span><span class="i">$Mode</span> =~ <span class="q">/^FromRows$/i</span><span class="s">)</span> <span class="s">{</span>
 320     <span class="i">$ErrorMsgPrefix</span> = <span class="q">&quot;Error: ${ClassName}::_NewFromRows&quot;</span><span class="sc">;</span>
 321   <span class="s">}</span>
 322   <span class="k">else</span> <span class="s">{</span>
 323     <span class="i">$ErrorMsgPrefix</span> = <span class="q">&quot;Error: ${ClassName}::_NewFromColumns&quot;</span><span class="sc">;</span>
 324   <span class="s">}</span>
 325   <span class="i">$CheckSizes</span> = <span class="n">1</span><span class="sc">;</span> <span class="i">$CombineValues</span> = <span class="n">0</span><span class="sc">;</span>
 326   <span class="i">$ValuesRefs</span> = <span class="i">_ProcessSpecifiedMatrixValues</span><span class="s">(</span><span class="i">$ErrorMsgPrefix</span><span class="cm">,</span> <span class="i">$CheckSizes</span><span class="cm">,</span> <span class="i">$CombineValues</span><span class="cm">,</span> <span class="i">@SpecifiedValues</span><span class="s">)</span><span class="sc">;</span>
 327 
 328   <span class="c"># Create a new matrix...</span>
 329   <span class="k">my</span><span class="s">(</span><span class="i">$Matrix</span><span class="cm">,</span> <span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="cm">,</span> <span class="i">$RowMode</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span><span class="sc">;</span>
 330 
 331   <span class="k">if</span> <span class="s">(</span><span class="i">$Mode</span> =~ <span class="q">/^FromRows$/i</span><span class="s">)</span> <span class="s">{</span>
 332     <span class="i">$NumOfRows</span> = <span class="k">scalar</span> <span class="i">@</span>{<span class="i">$ValuesRefs</span>}<span class="sc">;</span>
 333     <span class="i">$NumOfCols</span> = <span class="k">scalar</span> <span class="i">@</span>{<span class="i">$ValuesRefs</span>-&gt;[<span class="n">0</span>]}<span class="sc">;</span>
 334     <span class="i">$RowMode</span> = <span class="n">1</span><span class="sc">;</span>
 335   <span class="s">}</span>
 336   <span class="k">elsif</span> <span class="s">(</span><span class="i">$Mode</span> =~ <span class="q">/^FromColumns$/i</span><span class="s">)</span> <span class="s">{</span>
 337     <span class="i">$NumOfRows</span> = <span class="k">scalar</span> <span class="i">@</span>{<span class="i">$ValuesRefs</span>-&gt;[<span class="n">0</span>]}<span class="sc">;</span>
 338     <span class="i">$NumOfCols</span> = <span class="k">scalar</span> <span class="i">@</span>{<span class="i">$ValuesRefs</span>}<span class="sc">;</span>
 339     <span class="i">$RowMode</span> = <span class="n">0</span><span class="sc">;</span>
 340   <span class="s">}</span>
 341   <span class="i">$Matrix</span> = <span class="i">new</span> <span class="i">Matrix</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span><span class="sc">;</span>
 342 
 343   <span class="c"># Setup matrix values...</span>
 344   <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 345     <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 346       <span class="i">$Value</span> = <span class="i">$RowMode</span> ? <span class="i">$ValuesRefs</span>-&gt;[<span class="i">$RowIndex</span>]-&gt;[<span class="i">$ColIndex</span>]<span class="co">:</span> <span class="i">$ValuesRefs</span>-&gt;[<span class="i">$ColIndex</span>]-&gt;[<span class="i">$RowIndex</span>]<span class="sc">;</span>
 347       <span class="i">$Matrix</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] = <span class="i">$Value</span><span class="sc">;</span>
 348     <span class="s">}</span>
 349   <span class="s">}</span>
 350 
 351   <span class="k">return</span> <span class="i">$Matrix</span><span class="sc">;</span>
 352 <span class="s">}</span>
 353 
 354 <span class="c"># Process specified matrix values in any of the following supported formats:</span>
 355 <span class="c">#</span>
 356 <span class="c">#   o List of vector objects</span>
 357 <span class="c">#   o References to list of values</span>
 358 <span class="c">#   o List of strings containing row values delimited by space</span>
 359 <span class="c">#</span>
 360 <span class="c"># And return a reference to an array containing references to arrays with specified values.</span>
 361 <span class="c">#</span>
 362 <span class="c"># Value of CombineValuesStatus determines whether all the values specified are combined</span>
 363 <span class="c"># into one array and return its reference as the only entry in the array being returned.</span>
 364 <span class="c">#</span>
<a name="_ProcessSpecifiedMatrixValues-"></a> 365 <span class="k">sub </span><span class="m">_ProcessSpecifiedMatrixValues</span> <span class="s">{</span>
 366   <span class="k">my</span><span class="s">(</span><span class="i">$ErrorMsgPrefix</span><span class="cm">,</span> <span class="i">$CheckSizesStatus</span><span class="cm">,</span> <span class="i">$CombineValuesStatus</span><span class="cm">,</span> <span class="i">@SpecifiedValues</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 367   <span class="k">my</span><span class="s">(</span><span class="i">$Value</span><span class="cm">,</span> <span class="i">$TypeOfValue</span><span class="cm">,</span> <span class="i">@ValuesRefs</span><span class="s">)</span><span class="sc">;</span>
 368 
 369   <span class="i">@ValuesRefs</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 370   <span class="k">if</span> <span class="s">(</span>!<span class="i">@SpecifiedValues</span><span class="s">)</span> <span class="s">{</span>
 371     <span class="w">croak</span> <span class="q">&quot;$ErrorMsgPrefix: No values specified...&quot;</span><span class="sc">;</span>
 372   <span class="s">}</span>
 373 
 374   <span class="c"># Collect values...</span>
 375   <span class="k">for</span> <span class="i">$Value</span> <span class="s">(</span><span class="i">@SpecifiedValues</span><span class="s">)</span> <span class="s">{</span>
 376     <span class="i">$TypeOfValue</span> = <span class="k">ref</span> <span class="i">$Value</span><span class="sc">;</span>
 377 
 378     <span class="k">if</span> <span class="s">(</span><span class="i">Vector::IsVector</span><span class="s">(</span><span class="i">$Value</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 379       <span class="c"># Feference to vector object...</span>
 380       <span class="k">my</span><span class="s">(</span><span class="i">$ValuesRef</span><span class="s">)</span><span class="sc">;</span>
 381       <span class="i">$ValuesRef</span> = <span class="i">$Value</span><span class="i">-&gt;GetValues</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 382       <span class="k">if</span> <span class="s">(</span>!<span class="i">@</span>{<span class="i">$ValuesRef</span>}<span class="s">)</span> <span class="s">{</span>
 383         <span class="w">croak</span> <span class="q">&quot;$ErrorMsgPrefix: Specified vector object must contain some values...&quot;</span><span class="sc">;</span>
 384       <span class="s">}</span>
 385       <span class="k">push</span> <span class="i">@ValuesRefs</span><span class="cm">,</span> <span class="i">$ValuesRef</span><span class="sc">;</span>
 386     <span class="s">}</span>
 387     <span class="k">elsif</span> <span class="s">(</span><span class="i">$TypeOfValue</span> =~ <span class="q">/^ARRAY/</span><span class="s">)</span> <span class="s">{</span>
 388       <span class="c"># Refernece to an array...</span>
 389       <span class="k">if</span> <span class="s">(</span>!<span class="i">@</span>{<span class="i">$Value</span>}<span class="s">)</span> <span class="s">{</span>
 390         <span class="w">croak</span> <span class="q">&quot;$ErrorMsgPrefix: Specified array reference must contain some values...&quot;</span><span class="sc">;</span>
 391       <span class="s">}</span>
 392       <span class="k">push</span> <span class="i">@ValuesRefs</span><span class="cm">,</span> <span class="i">$Value</span><span class="sc">;</span>
 393     <span class="s">}</span>
 394     <span class="k">elsif</span> <span class="s">(</span><span class="i">$TypeOfValue</span> <span class="k">eq</span> <span class="q">&#39;&#39;</span><span class="s">)</span> <span class="s">{</span>
 395       <span class="c"># String value...</span>
 396       <span class="k">my</span><span class="s">(</span><span class="i">@Values</span><span class="s">)</span><span class="sc">;</span>
 397       <span class="i">@Values</span> = <span class="k">split</span><span class="s">(</span><span class="q">&#39; &#39;</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span><span class="sc">;</span>
 398       <span class="k">if</span> <span class="s">(</span>!<span class="i">@Values</span><span class="s">)</span> <span class="s">{</span>
 399         <span class="w">croak</span> <span class="q">&quot;$ErrorMsgPrefix: Specified string must contain some values...&quot;</span><span class="sc">;</span>
 400       <span class="s">}</span>
 401       <span class="k">push</span> <span class="i">@ValuesRefs</span><span class="cm">,</span> \<span class="i">@Values</span><span class="sc">;</span>
 402     <span class="s">}</span>
 403     <span class="k">else</span> <span class="s">{</span>
 404       <span class="w">croak</span> <span class="q">&quot;$ErrorMsgPrefix: Value format, $TypeOfValue, of a specified value to be added to matrix object is not supported...&quot;</span><span class="sc">;</span>
 405     <span class="s">}</span>
 406   <span class="s">}</span>
 407 
 408   <span class="c"># Combine all specified values into one array...</span>
 409   <span class="k">if</span> <span class="s">(</span><span class="i">$CombineValuesStatus</span><span class="s">)</span> <span class="s">{</span>
 410     <span class="k">my</span><span class="s">(</span><span class="i">$ValuesRef</span><span class="cm">,</span> <span class="i">@Values</span><span class="s">)</span><span class="sc">;</span>
 411 
 412     <span class="i">@Values</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 413     <span class="k">for</span> <span class="i">$ValuesRef</span> <span class="s">(</span><span class="i">@ValuesRefs</span><span class="s">)</span> <span class="s">{</span>
 414       <span class="k">push</span> <span class="i">@Values</span><span class="cm">,</span> <span class="i">@</span>{<span class="i">$ValuesRef</span>}<span class="sc">;</span>
 415     <span class="s">}</span>
 416     <span class="i">@ValuesRefs</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 417     <span class="k">push</span> <span class="i">@ValuesRefs</span><span class="cm">,</span> \<span class="i">@Values</span><span class="sc">;</span>
 418   <span class="s">}</span>
 419 
 420   <span class="c"># Make sure reference to all specified value arrays contain the same number of values...</span>
 421   <span class="k">if</span> <span class="s">(</span><span class="i">$CheckSizesStatus</span><span class="s">)</span> <span class="s">{</span>
 422     <span class="k">my</span><span class="s">(</span><span class="i">$Index</span><span class="cm">,</span> <span class="i">$FirstValueSize</span><span class="s">)</span><span class="sc">;</span>
 423     <span class="i">$FirstValueSize</span> = <span class="i">$#</span>{<span class="i">$ValuesRefs</span>[<span class="n">0</span>]}<span class="sc">;</span>
 424     <span class="k">for</span> <span class="i">$Index</span> <span class="s">(</span><span class="n">1</span> .. <span class="i">$#ValuesRefs</span><span class="s">)</span> <span class="s">{</span>
 425       <span class="k">if</span> <span class="s">(</span><span class="i">$FirstValueSize</span> != <span class="i">$#</span>{<span class="i">$ValuesRefs</span>[<span class="i">$Index</span>]}<span class="s">)</span> <span class="s">{</span>
 426         <span class="w">croak</span> <span class="q">&quot;$ErrorMsgPrefix: Number of values in each specified value type to be added to matrix object must be same...&quot;</span><span class="sc">;</span>
 427       <span class="s">}</span>
 428     <span class="s">}</span>
 429   <span class="s">}</span>
 430 
 431   <span class="k">return</span> \<span class="i">@ValuesRefs</span><span class="sc">;</span>
 432 <span class="s">}</span>
 433 
 434 <span class="c"># Create a new zero matrix of specified size or default size of 3 x 3.</span>
 435 <span class="c">#</span>
 436 <span class="c"># This functionality can be either invoked as a class function or an</span>
 437 <span class="c"># object method.</span>
 438 <span class="c">#</span>
<a name="ZeroMatrix-"></a> 439 <span class="k">sub </span><span class="m">ZeroMatrix (;$$$)</span> <span class="s">{</span>
 440   <span class="k">my</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="cm">,</span> <span class="i">$ThirdParameter</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 441   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$Matrix</span><span class="s">)</span><span class="sc">;</span>
 442 
 443   <span class="i">$This</span> = <span class="k">undef</span><span class="sc">;</span>
 444   <span class="k">if</span> <span class="s">(</span><span class="k">defined</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="s">)</span> &amp;&amp; <span class="i">IsMatrix</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 445     <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="cm">,</span> <span class="i">$ThirdParameter</span><span class="s">)</span><span class="sc">;</span>
 446   <span class="s">}</span>
 447   <span class="k">else</span> <span class="s">{</span>
 448     <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="s">(</span><span class="k">undef</span><span class="cm">,</span> <span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="s">)</span><span class="sc">;</span>
 449   <span class="s">}</span>
 450   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="s">(</span><span class="k">defined</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="s">)</span> &amp;&amp; <span class="k">defined</span><span class="s">(</span><span class="i">$NumOfCols</span><span class="s">)</span><span class="s">)</span> ? <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> <span class="co">:</span> <span class="s">(</span><span class="n">3</span><span class="cm">,</span> <span class="n">3</span><span class="s">)</span><span class="sc">;</span>
 451 
 452   <span class="c"># Set up a new zero matrix</span>
 453   <span class="i">$Matrix</span> = <span class="i">new</span> <span class="i">Matrix</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span><span class="sc">;</span>
 454 
 455   <span class="k">return</span> <span class="i">$Matrix</span><span class="sc">;</span>
 456 <span class="s">}</span>
 457 
 458 <span class="c"># Create a new unit matrix of specified size or default size of 3 x 3.</span>
 459 <span class="c">#</span>
 460 <span class="c"># This functionality can be either invoked as a class function or an</span>
 461 <span class="c"># object method.</span>
 462 <span class="c">#</span>
<a name="UnitMatrix-"></a> 463 <span class="k">sub </span><span class="m">UnitMatrix (;$$$)</span> <span class="s">{</span>
 464   <span class="k">my</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="cm">,</span> <span class="i">$ThirdParameter</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 465   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$Matrix</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="s">)</span><span class="sc">;</span>
 466 
 467   <span class="i">$This</span> = <span class="k">undef</span><span class="sc">;</span>
 468   <span class="k">if</span> <span class="s">(</span><span class="k">defined</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="s">)</span> &amp;&amp; <span class="i">IsMatrix</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 469     <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="cm">,</span> <span class="i">$ThirdParameter</span><span class="s">)</span><span class="sc">;</span>
 470   <span class="s">}</span>
 471   <span class="k">else</span> <span class="s">{</span>
 472     <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="s">(</span><span class="k">undef</span><span class="cm">,</span> <span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="s">)</span><span class="sc">;</span>
 473   <span class="s">}</span>
 474   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="s">(</span><span class="k">defined</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="s">)</span> &amp;&amp; <span class="k">defined</span><span class="s">(</span><span class="i">$NumOfCols</span><span class="s">)</span><span class="s">)</span> ? <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> <span class="co">:</span> <span class="s">(</span><span class="n">3</span><span class="cm">,</span> <span class="n">3</span><span class="s">)</span><span class="sc">;</span>
 475 
 476   <span class="c"># Set up a new zero matrix</span>
 477   <span class="i">$Matrix</span> = <span class="i">new</span> <span class="i">Matrix</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span><span class="sc">;</span>
 478 
 479   <span class="k">if</span> <span class="s">(</span><span class="i">$NumOfRows</span> != <span class="i">$NumOfCols</span><span class="s">)</span> <span class="s">{</span>
 480     <span class="w">carp</span> <span class="q">&quot;Warning: ${ClassName}::UnitMatrix: Specified matrix, $NumOfRows x $NumOfCols, is not a square matrix...&quot;</span><span class="sc">;</span>
 481   <span class="s">}</span>
 482 
 483   <span class="c"># Initialize diagonal elements to 1...</span>
 484   <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 485     <span class="i">$Matrix</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$RowIndex</span>] = <span class="n">1.0</span><span class="sc">;</span>
 486   <span class="s">}</span>
 487 
 488   <span class="k">return</span> <span class="i">$Matrix</span><span class="sc">;</span>
 489 <span class="s">}</span>
 490 
 491 <span class="c"># Identity matrix of specified size or size 3 x 3...</span>
 492 <span class="c">#</span>
<a name="IdentityMatrix-"></a> 493 <span class="k">sub </span><span class="m">IdentityMatrix (;$$$)</span> <span class="s">{</span>
 494   <span class="k">my</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="cm">,</span> <span class="i">$ThirdParameter</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 495 
 496   <span class="k">return</span> <span class="i">UnitMatrix</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="cm">,</span> <span class="i">$ThirdParameter</span><span class="s">)</span><span class="sc">;</span>
 497 <span class="s">}</span>
 498 
 499 <span class="c"># Set all matrix values to 0s...</span>
 500 <span class="c">#</span>
<a name="Zero-"></a> 501 <span class="k">sub </span><span class="m">Zero</span> <span class="s">{</span>
 502   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 503 
 504   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;SetAllValues</span><span class="s">(</span><span class="n">0.0</span><span class="s">)</span><span class="sc">;</span>
 505 <span class="s">}</span>
 506 
 507 <span class="c"># Set all matrix values to 1s...</span>
 508 <span class="c">#</span>
<a name="One-"></a> 509 <span class="k">sub </span><span class="m">One</span> <span class="s">{</span>
 510   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 511 
 512   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;SetAllValues</span><span class="s">(</span><span class="n">1.0</span><span class="s">)</span><span class="sc">;</span>
 513 <span class="s">}</span>
 514 
 515 <span class="c"># Get a matrix value with row and column indicies starting from 0...</span>
 516 <span class="c">#</span>
<a name="GetValue-"></a> 517 <span class="k">sub </span><span class="m">GetValue</span> <span class="s">{</span>
 518   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="cm">,</span> <span class="i">$SkipIndexCheck</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 519 
 520   <span class="k">if</span> <span class="s">(</span><span class="i">$SkipIndexCheck</span><span class="s">)</span> <span class="s">{</span>
 521     <span class="i">$This</span><span class="i">-&gt;_GetValue</span><span class="s">(</span><span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
 522   <span class="s">}</span>
 523 
 524   <span class="i">$This</span><span class="i">-&gt;_ValidateRowAndColumnIndicies</span><span class="s">(</span><span class="q">&quot;Error: ${ClassName}::GetValue&quot;</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
 525 
 526   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_GetValue</span><span class="s">(</span><span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
 527 <span class="s">}</span>
 528 
 529 <span class="c"># Get a matrix value...</span>
 530 <span class="c">#</span>
<a name="_GetValue-"></a> 531 <span class="k">sub </span><span class="m">_GetValue</span> <span class="s">{</span>
 532   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 533 
 534   <span class="k">return</span> <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>]<span class="sc">;</span>
 535 <span class="s">}</span>
 536 
 537 <span class="c"># Set a matrix value with row and column indicies starting from 0...</span>
 538 <span class="c">#</span>
<a name="SetValue-"></a> 539 <span class="k">sub </span><span class="m">SetValue</span> <span class="s">{</span>
 540   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="cm">,</span> <span class="i">$Value</span><span class="cm">,</span> <span class="i">$SkipIndexCheck</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 541 
 542   <span class="k">if</span> <span class="s">(</span><span class="i">$SkipIndexCheck</span><span class="s">)</span> <span class="s">{</span>
 543     <span class="i">$This</span><span class="i">-&gt;_SetValue</span><span class="s">(</span><span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span><span class="sc">;</span>
 544   <span class="s">}</span>
 545 
 546   <span class="i">$This</span><span class="i">-&gt;_ValidateRowAndColumnIndicies</span><span class="s">(</span><span class="q">&quot;Error: ${ClassName}::SetValue&quot;</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
 547 
 548   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_SetValue</span><span class="s">(</span><span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span><span class="sc">;</span>
 549 <span class="s">}</span>
 550 
 551 <span class="c"># Set a matrix value...</span>
 552 <span class="c">#</span>
<a name="_SetValue-"></a> 553 <span class="k">sub </span><span class="m">_SetValue</span> <span class="s">{</span>
 554   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 555 
 556   <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] = <span class="i">$Value</span><span class="sc">;</span>
 557 
 558   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 559 <span class="s">}</span>
 560 
 561 <span class="c"># Set all matrix values to a specified value...</span>
 562 <span class="c">#</span>
<a name="SetAllValues-"></a> 563 <span class="k">sub </span><span class="m">SetAllValues</span> <span class="s">{</span>
 564   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 565   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
 566 
 567   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 568   <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 569     <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 570       <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] = <span class="i">$Value</span><span class="sc">;</span>
 571     <span class="s">}</span>
 572   <span class="s">}</span>
 573   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 574 <span class="s">}</span>
 575 
 576 <span class="c"># Set values of a row in a matrix value with row index starting from 0...</span>
 577 <span class="c">#</span>
<a name="SetRowValues-"></a> 578 <span class="k">sub </span><span class="m">SetRowValues</span> <span class="s">{</span>
 579   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">@SpecifiedValues</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 580   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="cm">,</span> <span class="i">$ErrorMsgPrefix</span><span class="cm">,</span> <span class="i">$CheckSizes</span><span class="cm">,</span> <span class="i">$CombineValues</span><span class="cm">,</span> <span class="i">$ValuesRefs</span><span class="cm">,</span> <span class="i">$RowValuesRef</span><span class="cm">,</span> <span class="i">$NumOfRowValues</span><span class="s">)</span><span class="sc">;</span>
 581 
 582   <span class="i">$ErrorMsgPrefix</span> = <span class="q">&quot;Error: ${ClassName}-&gt;SetRowValues&quot;</span><span class="sc">;</span>
 583 
 584   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 585   <span class="i">$This</span><span class="i">-&gt;_ValidateRowIndex</span><span class="s">(</span><span class="i">$ErrorMsgPrefix</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="s">)</span><span class="sc">;</span>
 586 
 587   <span class="c"># Collect specified row values...</span>
 588   <span class="i">$CheckSizes</span> = <span class="n">0</span><span class="sc">;</span> <span class="i">$CombineValues</span> = <span class="n">1</span><span class="sc">;</span>
 589   <span class="i">$ValuesRefs</span> = <span class="i">_ProcessSpecifiedMatrixValues</span><span class="s">(</span><span class="i">$ErrorMsgPrefix</span><span class="cm">,</span> <span class="i">$CheckSizes</span><span class="cm">,</span> <span class="i">$CombineValues</span><span class="cm">,</span> <span class="i">@SpecifiedValues</span><span class="s">)</span><span class="sc">;</span>
 590   <span class="i">$RowValuesRef</span> = <span class="i">$ValuesRefs</span>-&gt;[<span class="n">0</span>]<span class="sc">;</span>
 591 
 592   <span class="c"># Check number of specified row values...</span>
 593   <span class="i">$NumOfRowValues</span> = <span class="i">@</span>{<span class="i">$RowValuesRef</span>}<span class="sc">;</span>
 594   <span class="k">if</span> <span class="s">(</span><span class="i">$NumOfRowValues</span> != <span class="i">$NumOfCols</span><span class="s">)</span> <span class="s">{</span>
 595     <span class="w">croak</span> <span class="q">&quot;$ErrorMsgPrefix: Number of specified row values, $NumOfRowValues, must be equal to number of row values, $NumOfCols, in matrix...&quot;</span><span class="sc">;</span>
 596   <span class="s">}</span>
 597 
 598   <span class="c"># Set row values...</span>
 599   <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRowValues</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 600     <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] = <span class="i">$RowValuesRef</span>-&gt;[<span class="i">$ColIndex</span>]<span class="sc">;</span>
 601   <span class="s">}</span>
 602   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 603 <span class="s">}</span>
 604 
 605 <span class="c"># Add new row values to a matrix...</span>
 606 <span class="c">#</span>
<a name="AddRowValues-"></a> 607 <span class="k">sub </span><span class="m">AddRowValues</span> <span class="s">{</span>
 608   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">@SpecifiedValues</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 609   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ErrorMsgPrefix</span><span class="cm">,</span> <span class="i">$CheckSizes</span><span class="cm">,</span> <span class="i">$CombineValues</span><span class="cm">,</span> <span class="i">$RowValueRef</span><span class="cm">,</span> <span class="i">$RowValuesRefs</span><span class="cm">,</span> <span class="i">$NumOfNewRows</span><span class="cm">,</span> <span class="i">$NumOfNewCols</span><span class="s">)</span><span class="sc">;</span>
 610 
 611   <span class="i">$ErrorMsgPrefix</span> = <span class="q">&quot;Error: ${ClassName}-&gt;AddRowValues&quot;</span><span class="sc">;</span>
 612 
 613   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 614 
 615   <span class="c"># Collect specified row values...</span>
 616   <span class="i">$CheckSizes</span> = <span class="n">1</span><span class="sc">;</span> <span class="i">$CombineValues</span> = <span class="n">0</span><span class="sc">;</span>
 617   <span class="i">$RowValuesRefs</span> = <span class="i">_ProcessSpecifiedMatrixValues</span><span class="s">(</span><span class="i">$ErrorMsgPrefix</span><span class="cm">,</span> <span class="i">$CheckSizes</span><span class="cm">,</span> <span class="i">$CombineValues</span><span class="cm">,</span> <span class="i">@SpecifiedValues</span><span class="s">)</span><span class="sc">;</span>
 618 
 619   <span class="c"># Check number of specified row values...</span>
 620   <span class="i">$NumOfNewRows</span> = <span class="k">scalar</span> <span class="i">@</span>{<span class="i">$RowValuesRefs</span>}<span class="sc">;</span>
 621   <span class="i">$NumOfNewCols</span> = <span class="k">scalar</span> <span class="i">@</span>{<span class="i">$RowValuesRefs</span>-&gt;[<span class="n">0</span>]}<span class="sc">;</span>
 622 
 623   <span class="k">if</span> <span class="s">(</span><span class="i">$NumOfNewCols</span> != <span class="i">$NumOfCols</span><span class="s">)</span> <span class="s">{</span>
 624     <span class="w">croak</span> <span class="q">&quot;$ErrorMsgPrefix: Number of values in each specified row, $NumOfNewCols, must be equal to number of row values, $NumOfCols, in matrix...&quot;</span><span class="sc">;</span>
 625   <span class="s">}</span>
 626 
 627   <span class="c"># Add each row to the matrix...</span>
 628   <span class="i">$RowIndex</span> = <span class="i">$NumOfRows</span> - <span class="n">1</span><span class="sc">;</span>
 629   <span class="k">for</span> <span class="i">$RowValueRef</span> <span class="s">(</span><span class="i">@</span>{<span class="i">$RowValuesRefs</span>}<span class="s">)</span> <span class="s">{</span>
 630     <span class="i">$RowIndex</span>++<span class="sc">;</span>
 631     <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>]} = <span class="i">@</span>{<span class="i">$RowValueRef</span>}<span class="sc">;</span>
 632   <span class="s">}</span>
 633 
 634   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 635 <span class="s">}</span>
 636 
 637 <span class="c"># Get values of a row in matrix as an array. In scalar context, number of row</span>
 638 <span class="c"># values is returned...</span>
 639 <span class="c">#</span>
<a name="GetRowValues-"></a> 640 <span class="k">sub </span><span class="m">GetRowValues</span> <span class="s">{</span>
 641   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 642 
 643   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_GetRowOrColumnValues</span><span class="s">(</span><span class="q">&#39;AsArray&#39;</span><span class="cm">,</span> <span class="q">&#39;FromRow&#39;</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="s">)</span><span class="sc">;</span>
 644 <span class="s">}</span>
 645 
 646 <span class="c"># Get values of a row in matrix as a vector object...</span>
 647 <span class="c">#</span>
<a name="GetRowValuesAsVector-"></a> 648 <span class="k">sub </span><span class="m">GetRowValuesAsVector</span> <span class="s">{</span>
 649   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 650 
 651   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_GetRowOrColumnValues</span><span class="s">(</span><span class="q">&#39;AsVector&#39;</span><span class="cm">,</span> <span class="q">&#39;FromRow&#39;</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="s">)</span><span class="sc">;</span>
 652 <span class="s">}</span>
 653 
 654 <span class="c"># Get values of a row as row matrix object...</span>
 655 <span class="c">#</span>
<a name="GetRowValuesAsRowMatrix-"></a> 656 <span class="k">sub </span><span class="m">GetRowValuesAsRowMatrix</span> <span class="s">{</span>
 657   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 658 
 659   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_GetRowOrColumnValues</span><span class="s">(</span><span class="q">&#39;AsRowMatrix&#39;</span><span class="cm">,</span> <span class="q">&#39;FromRow&#39;</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="s">)</span><span class="sc">;</span>
 660 <span class="s">}</span>
 661 
 662 <span class="c"># Get values of a row as column matrix object...</span>
 663 <span class="c">#</span>
<a name="GetRowValuesAsColumnMatrix-"></a> 664 <span class="k">sub </span><span class="m">GetRowValuesAsColumnMatrix</span> <span class="s">{</span>
 665   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 666 
 667   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_GetRowOrColumnValues</span><span class="s">(</span><span class="q">&#39;AsColumnMatrix&#39;</span><span class="cm">,</span> <span class="q">&#39;FromRow&#39;</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="s">)</span><span class="sc">;</span>
 668 <span class="s">}</span>
 669 
 670 <span class="c"># Get values of a row in matrix as a space delimited string...</span>
 671 <span class="c">#</span>
<a name="GetRowValuesAsString-"></a> 672 <span class="k">sub </span><span class="m">GetRowValuesAsString</span> <span class="s">{</span>
 673   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 674 
 675   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_GetRowOrColumnValues</span><span class="s">(</span><span class="q">&#39;AsString&#39;</span><span class="cm">,</span> <span class="q">&#39;FromRow&#39;</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="s">)</span><span class="sc">;</span>
 676 <span class="s">}</span>
 677 
 678 <span class="c"># Set values of a column in a matrix value with row index starting from 0...</span>
 679 <span class="c">#</span>
<a name="SetColumnValues-"></a> 680 <span class="k">sub </span><span class="m">SetColumnValues</span> <span class="s">{</span>
 681   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="cm">,</span> <span class="i">@SpecifiedValues</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 682   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ErrorMsgPrefix</span><span class="cm">,</span> <span class="i">$CheckSizes</span><span class="cm">,</span> <span class="i">$CombineValues</span><span class="cm">,</span> <span class="i">$ValuesRefs</span><span class="cm">,</span> <span class="i">$ColValuesRef</span><span class="cm">,</span> <span class="i">$NumOfColValues</span><span class="s">)</span><span class="sc">;</span>
 683 
 684   <span class="i">$ErrorMsgPrefix</span> = <span class="q">&quot;Error: ${ClassName}-&gt;SetColumnValues&quot;</span><span class="sc">;</span>
 685 
 686   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 687   <span class="i">$This</span><span class="i">-&gt;_ValidateColumnIndex</span><span class="s">(</span><span class="i">$ErrorMsgPrefix</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
 688 
 689   <span class="c"># Collect specified row values...</span>
 690   <span class="i">$CheckSizes</span> = <span class="n">0</span><span class="sc">;</span> <span class="i">$CombineValues</span> = <span class="n">1</span><span class="sc">;</span>
 691   <span class="i">$ValuesRefs</span> = <span class="i">_ProcessSpecifiedMatrixValues</span><span class="s">(</span><span class="i">$ErrorMsgPrefix</span><span class="cm">,</span> <span class="i">$CheckSizes</span><span class="cm">,</span> <span class="i">$CombineValues</span><span class="cm">,</span> <span class="i">@SpecifiedValues</span><span class="s">)</span><span class="sc">;</span>
 692   <span class="i">$ColValuesRef</span> = <span class="i">$ValuesRefs</span>-&gt;[<span class="n">0</span>]<span class="sc">;</span>
 693 
 694   <span class="c"># Check number of specified col values...</span>
 695   <span class="i">$NumOfColValues</span> = <span class="i">@</span>{<span class="i">$ColValuesRef</span>}<span class="sc">;</span>
 696   <span class="k">if</span> <span class="s">(</span><span class="i">$NumOfColValues</span> != <span class="i">$NumOfRows</span><span class="s">)</span> <span class="s">{</span>
 697     <span class="w">croak</span> <span class="q">&quot;$ErrorMsgPrefix: Number of specified col values, $NumOfColValues, must be equal to number of column values, $NumOfRows, in matrix...&quot;</span><span class="sc">;</span>
 698   <span class="s">}</span>
 699 
 700   <span class="c"># Set col values...</span>
 701   <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfColValues</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 702     <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] = <span class="i">$ColValuesRef</span>-&gt;[<span class="i">$RowIndex</span>]<span class="sc">;</span>
 703   <span class="s">}</span>
 704   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 705 <span class="s">}</span>
 706 
 707 <span class="c"># Add new column values to a matrix...</span>
 708 <span class="c">#</span>
<a name="AddColumnValues-"></a> 709 <span class="k">sub </span><span class="m">AddColumnValues</span> <span class="s">{</span>
 710   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">@SpecifiedValues</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 711   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="cm">,</span> <span class="i">$ErrorMsgPrefix</span><span class="cm">,</span> <span class="i">$CheckSizes</span><span class="cm">,</span> <span class="i">$CombineValues</span><span class="cm">,</span> <span class="i">$ColValueRef</span><span class="cm">,</span> <span class="i">$ColValuesRefs</span><span class="cm">,</span> <span class="i">$NumOfNewRows</span><span class="cm">,</span> <span class="i">$NumOfNewCols</span><span class="s">)</span><span class="sc">;</span>
 712 
 713   <span class="i">$ErrorMsgPrefix</span> = <span class="q">&quot;Error: ${ClassName}-&gt;AddColumnValues&quot;</span><span class="sc">;</span>
 714 
 715   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 716 
 717   <span class="c"># Collect specified column values...</span>
 718   <span class="i">$CheckSizes</span> = <span class="n">1</span><span class="sc">;</span> <span class="i">$CombineValues</span> = <span class="n">0</span><span class="sc">;</span>
 719   <span class="i">$ColValuesRefs</span> = <span class="i">_ProcessSpecifiedMatrixValues</span><span class="s">(</span><span class="i">$ErrorMsgPrefix</span><span class="cm">,</span> <span class="i">$CheckSizes</span><span class="cm">,</span> <span class="i">$CombineValues</span><span class="cm">,</span> <span class="i">@SpecifiedValues</span><span class="s">)</span><span class="sc">;</span>
 720 
 721   <span class="c"># Check number of specified column values...</span>
 722   <span class="i">$NumOfNewCols</span> = <span class="k">scalar</span> <span class="i">@</span>{<span class="i">$ColValuesRefs</span>}<span class="sc">;</span>
 723   <span class="i">$NumOfNewRows</span> = <span class="k">scalar</span> <span class="i">@</span>{<span class="i">$ColValuesRefs</span>-&gt;[<span class="n">0</span>]}<span class="sc">;</span>
 724 
 725   <span class="k">if</span> <span class="s">(</span><span class="i">$NumOfNewRows</span> != <span class="i">$NumOfRows</span><span class="s">)</span> <span class="s">{</span>
 726     <span class="w">croak</span> <span class="q">&quot;$ErrorMsgPrefix: Number of values in each specified column, $NumOfNewRows, must be equal to number of column values, $NumOfRows, in matrix...&quot;</span><span class="sc">;</span>
 727   <span class="s">}</span>
 728 
 729   <span class="c"># Add each column to the matrix...</span>
 730   <span class="i">$ColIndex</span> = <span class="i">$NumOfCols</span> - <span class="n">1</span><span class="sc">;</span>
 731   <span class="k">for</span> <span class="i">$ColValueRef</span> <span class="s">(</span><span class="i">@</span>{<span class="i">$ColValuesRefs</span>}<span class="s">)</span> <span class="s">{</span>
 732     <span class="i">$ColIndex</span>++<span class="sc">;</span>
 733     <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 734       <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] = <span class="i">$ColValueRef</span>-&gt;[<span class="i">$RowIndex</span>]<span class="sc">;</span>
 735     <span class="s">}</span>
 736   <span class="s">}</span>
 737 
 738   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 739 <span class="s">}</span>
 740 
 741 <span class="c"># Get values of a column in matrix as an array. In scalar context, number of column</span>
 742 <span class="c"># values is returned...</span>
 743 <span class="c">#</span>
<a name="GetColumnValues-"></a> 744 <span class="k">sub </span><span class="m">GetColumnValues</span> <span class="s">{</span>
 745   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 746 
 747   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_GetRowOrColumnValues</span><span class="s">(</span><span class="q">&#39;AsArray&#39;</span><span class="cm">,</span> <span class="q">&#39;FromColumn&#39;</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
 748 <span class="s">}</span>
 749 
 750 <span class="c"># Get values of a column in matrix as a vector object...</span>
 751 <span class="c">#</span>
<a name="GetColumnValuesAsVector-"></a> 752 <span class="k">sub </span><span class="m">GetColumnValuesAsVector</span> <span class="s">{</span>
 753   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 754 
 755   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_GetRowOrColumnValues</span><span class="s">(</span><span class="q">&#39;AsVector&#39;</span><span class="cm">,</span> <span class="q">&#39;FromColumn&#39;</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
 756 <span class="s">}</span>
 757 
 758 <span class="c"># Get values of a column as row matrix object...</span>
 759 <span class="c">#</span>
<a name="GetColumnValuesAsRowMatrix-"></a> 760 <span class="k">sub </span><span class="m">GetColumnValuesAsRowMatrix</span> <span class="s">{</span>
 761   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 762 
 763   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_GetRowOrColumnValues</span><span class="s">(</span><span class="q">&#39;AsRowMatrix&#39;</span><span class="cm">,</span> <span class="q">&#39;FromColumn&#39;</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
 764 <span class="s">}</span>
 765 
 766 <span class="c"># Get values of a column as column matrix object...</span>
 767 <span class="c">#</span>
<a name="GetColumnValuesAsColumnMatrix-"></a> 768 <span class="k">sub </span><span class="m">GetColumnValuesAsColumnMatrix</span> <span class="s">{</span>
 769   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 770 
 771   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_GetRowOrColumnValues</span><span class="s">(</span><span class="q">&#39;AsColumnMatrix&#39;</span><span class="cm">,</span> <span class="q">&#39;FromColumn&#39;</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
 772 <span class="s">}</span>
 773 
 774 <span class="c"># Get values of a column in matrix as a space delimited string...</span>
 775 <span class="c">#</span>
<a name="GetColumnValuesAsString-"></a> 776 <span class="k">sub </span><span class="m">GetColumnValuesAsString</span> <span class="s">{</span>
 777   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 778 
 779   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_GetRowOrColumnValues</span><span class="s">(</span><span class="q">&#39;AsString&#39;</span><span class="cm">,</span> <span class="q">&#39;FromColumn&#39;</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
 780 <span class="s">}</span>
 781 
 782 <span class="c"># Get row or column values...</span>
 783 <span class="c">#</span>
<a name="_GetRowOrColumnValues-"></a> 784 <span class="k">sub </span><span class="m">_GetRowOrColumnValues</span> <span class="s">{</span>
 785   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Mode</span><span class="cm">,</span> <span class="i">$ValueMode</span><span class="cm">,</span> <span class="i">$ValueModeIndex</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 786 
 787   <span class="k">if</span> <span class="s">(</span><span class="i">$Mode</span> !~ <span class="q">/^(AsArray|AsVector|AsRowMatrix|AsColumnMatrix|AsString)$/i</span><span class="s">)</span> <span class="s">{</span>
 788     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;_GetRowOrColumnValues: Unknown mode, $Mode, specified...&quot;</span><span class="sc">;</span>
 789   <span class="s">}</span>
 790   <span class="k">if</span> <span class="s">(</span><span class="i">$ValueMode</span> !~ <span class="q">/^(FromRow|FromColumn)$/i</span><span class="s">)</span> <span class="s">{</span>
 791     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;_GetRowOrColumnValues: Unknown value mode, $ValueMode, specified...&quot;</span><span class="sc">;</span>
 792   <span class="s">}</span>
 793 
 794   <span class="c"># Setup error message prefix...</span>
 795   <span class="k">my</span><span class="s">(</span><span class="i">$ErrorMsgPrefix</span><span class="s">)</span><span class="sc">;</span>
 796 
 797   <span class="i">$ErrorMsgPrefix</span> = <span class="q">&quot;${ClassName}-&gt;_GetRowOrColumnValues&quot;</span><span class="sc">;</span>
 798   <span class="k">if</span> <span class="s">(</span><span class="i">$ValueMode</span> =~ <span class="q">/^FromRow$/i</span><span class="s">)</span> <span class="s">{</span>
 799     <span class="i">$ErrorMsgPrefix</span> = <span class="q">&quot;Error: ${ClassName}-&gt;GetRowValues${Mode}&quot;</span><span class="sc">;</span>
 800   <span class="s">}</span>
 801   <span class="k">elsif</span> <span class="s">(</span><span class="i">$ValueMode</span> =~ <span class="q">/^FromColumn$/i</span><span class="s">)</span> <span class="s">{</span>
 802     <span class="i">$ErrorMsgPrefix</span> = <span class="q">&quot;Error: ${ClassName}-&gt;GetColumnValues${Mode}&quot;</span><span class="sc">;</span>
 803   <span class="s">}</span>
 804 
 805   <span class="c"># Validate specified index and collect values...</span>
 806   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="cm">,</span> <span class="i">@Values</span><span class="s">)</span><span class="sc">;</span>
 807 
 808   <span class="i">@Values</span>  = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 809   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 810 
 811   <span class="k">if</span> <span class="s">(</span><span class="i">$ValueMode</span> =~ <span class="q">/^FromRow$/i</span><span class="s">)</span> <span class="s">{</span>
 812     <span class="i">$RowIndex</span> = <span class="i">$ValueModeIndex</span><span class="sc">;</span>
 813     <span class="i">$This</span><span class="i">-&gt;_ValidateRowIndex</span><span class="s">(</span><span class="i">$ErrorMsgPrefix</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="s">)</span><span class="sc">;</span>
 814 
 815     <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 816       <span class="k">push</span> <span class="i">@Values</span><span class="cm">,</span> <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>]<span class="sc">;</span>
 817     <span class="s">}</span>
 818   <span class="s">}</span>
 819   <span class="k">elsif</span> <span class="s">(</span><span class="i">$ValueMode</span> =~ <span class="q">/^FromColumn$/i</span><span class="s">)</span> <span class="s">{</span>
 820     <span class="i">$ColIndex</span> = <span class="i">$ValueModeIndex</span><span class="sc">;</span>
 821     <span class="i">$This</span><span class="i">-&gt;_ValidateColumnIndex</span><span class="s">(</span><span class="i">$ErrorMsgPrefix</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
 822 
 823     <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 824       <span class="k">push</span> <span class="i">@Values</span><span class="cm">,</span> <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>]<span class="sc">;</span>
 825     <span class="s">}</span>
 826   <span class="s">}</span>
 827 
 828   <span class="c"># Return values...</span>
 829   <span class="k">if</span> <span class="s">(</span><span class="i">$Mode</span> =~ <span class="q">/^AsRowMatrix$/i</span><span class="s">)</span> <span class="s">{</span>
 830     <span class="k">return</span> <span class="i">NewFromRows</span><span class="s">(</span>\<span class="i">@Values</span><span class="s">)</span><span class="sc">;</span>
 831   <span class="s">}</span>
 832   <span class="k">elsif</span> <span class="s">(</span><span class="i">$Mode</span> =~ <span class="q">/^AsColumnMatrix$/i</span><span class="s">)</span> <span class="s">{</span>
 833     <span class="k">return</span> <span class="i">NewFromColumns</span><span class="s">(</span>\<span class="i">@Values</span><span class="s">)</span><span class="sc">;</span>
 834   <span class="s">}</span>
 835   <span class="k">elsif</span> <span class="s">(</span><span class="i">$Mode</span> =~ <span class="q">/^AsVector$/i</span><span class="s">)</span> <span class="s">{</span>
 836     <span class="k">return</span> <span class="i">new</span> <span class="i">Vector</span><span class="s">(</span><span class="i">@Values</span><span class="s">)</span><span class="sc">;</span>
 837   <span class="s">}</span>
 838   <span class="k">elsif</span> <span class="s">(</span><span class="i">$Mode</span> =~ <span class="q">/^AsString$/i</span><span class="s">)</span> <span class="s">{</span>
 839     <span class="k">return</span> <span class="k">join</span><span class="s">(</span><span class="q">&#39; &#39;</span><span class="cm">,</span> <span class="i">@Values</span><span class="s">)</span><span class="sc">;</span>
 840   <span class="s">}</span>
 841   <span class="k">else</span> <span class="s">{</span>
 842     <span class="k">return</span> <span class="k">wantarray</span> ? <span class="i">@Values</span> <span class="co">:</span> <span class="k">scalar</span> <span class="i">@Values</span><span class="sc">;</span>
 843   <span class="s">}</span>
 844 <span class="s">}</span>
 845 
 846 <span class="c"># Set values of the diagonal in a square matrix...</span>
 847 <span class="c">#</span>
<a name="SetDiagonalValues-"></a> 848 <span class="k">sub </span><span class="m">SetDiagonalValues</span> <span class="s">{</span>
 849   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">@SpecifiedDiagonalValues</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 850   <span class="k">my</span><span class="s">(</span><span class="i">$ErrorMsgPrefix</span><span class="cm">,</span> <span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$CheckSizes</span><span class="cm">,</span> <span class="i">$CombineValues</span><span class="cm">,</span> <span class="i">$ValuesRefs</span><span class="cm">,</span> <span class="i">$NumOfDiagonalValues</span><span class="cm">,</span> <span class="i">$DiagonalValuesRef</span><span class="s">)</span><span class="sc">;</span>
 851 
 852   <span class="i">$ErrorMsgPrefix</span> = <span class="q">&quot;Error: ${ClassName}-&gt;SetDiagonalValues&quot;</span><span class="sc">;</span>
 853   <span class="k">if</span> <span class="s">(</span>!<span class="i">@SpecifiedDiagonalValues</span><span class="s">)</span> <span class="s">{</span>
 854     <span class="w">croak</span> <span class="q">&quot;$ErrorMsgPrefix: No diagonal values specified...&quot;</span><span class="sc">;</span>
 855   <span class="s">}</span>
 856 
 857   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 858   <span class="k">if</span> <span class="s">(</span><span class="i">$NumOfRows</span> != <span class="i">$NumOfCols</span><span class="s">)</span> <span class="s">{</span>
 859     <span class="w">croak</span> <span class="q">&quot;Error: $ErrorMsgPrefix: Specified matrix, $NumOfRows x $NumOfCols, is not a square matrix...&quot;</span><span class="sc">;</span>
 860   <span class="s">}</span>
 861 
 862   <span class="c"># Collect specified diagonal values...</span>
 863   <span class="i">$CheckSizes</span> = <span class="n">0</span><span class="sc">;</span> <span class="i">$CombineValues</span> = <span class="n">1</span><span class="sc">;</span>
 864   <span class="i">$ValuesRefs</span> = <span class="i">_ProcessSpecifiedMatrixValues</span><span class="s">(</span><span class="i">$ErrorMsgPrefix</span><span class="cm">,</span> <span class="i">$CheckSizes</span><span class="cm">,</span> <span class="i">$CombineValues</span><span class="cm">,</span> <span class="i">@SpecifiedDiagonalValues</span><span class="s">)</span><span class="sc">;</span>
 865   <span class="i">$DiagonalValuesRef</span> = <span class="i">$ValuesRefs</span>-&gt;[<span class="n">0</span>]<span class="sc">;</span>
 866   <span class="i">$NumOfDiagonalValues</span> = <span class="i">@</span>{<span class="i">$DiagonalValuesRef</span>}<span class="sc">;</span>
 867 
 868   <span class="k">if</span> <span class="s">(</span><span class="i">$NumOfDiagonalValues</span> != <span class="i">$NumOfRows</span><span class="s">)</span> <span class="s">{</span>
 869     <span class="w">croak</span> <span class="q">&quot;Error: $ErrorMsgPrefix: Number of specified diagonal values, $NumOfDiagonalValues, must be equal to number of rows, $NumOfRows, in square matrix...&quot;</span><span class="sc">;</span>
 870   <span class="s">}</span>
 871 
 872   <span class="c"># Set diagonal values...</span>
 873   <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 874     <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$RowIndex</span>] = <span class="i">$DiagonalValuesRef</span>-&gt;[<span class="i">$RowIndex</span>]<span class="sc">;</span>
 875   <span class="s">}</span>
 876 
 877   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 878 <span class="s">}</span>
 879 
 880 <span class="c"># Get values of the diagonal in a square matrix as an array. In scalar context, number of</span>
 881 <span class="c"># diagonal values is returned...</span>
 882 <span class="c">#</span>
<a name="GetDiagonalValues-"></a> 883 <span class="k">sub </span><span class="m">GetDiagonalValues</span> <span class="s">{</span>
 884   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 885 
 886   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_GetDiagonalValues</span><span class="s">(</span><span class="q">&#39;AsArray&#39;</span><span class="s">)</span><span class="sc">;</span>
 887 <span class="s">}</span>
 888 
 889 <span class="c"># Get values of the diagonal in a square matrix as vector object...</span>
 890 <span class="c">#</span>
<a name="GetDiagonalValuesAsVector-"></a> 891 <span class="k">sub </span><span class="m">GetDiagonalValuesAsVector</span> <span class="s">{</span>
 892   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 893 
 894   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_GetDiagonalValues</span><span class="s">(</span><span class="q">&#39;AsVector&#39;</span><span class="s">)</span><span class="sc">;</span>
 895 <span class="s">}</span>
 896 
 897 <span class="c"># Get values of the diagonal in a square matrix as row matrix object</span>
 898 <span class="c">#</span>
<a name="GetDiagonalValuesAsRowMatrix-"></a> 899 <span class="k">sub </span><span class="m">GetDiagonalValuesAsRowMatrix</span> <span class="s">{</span>
 900   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 901 
 902   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_GetDiagonalValues</span><span class="s">(</span><span class="q">&#39;AsRowMatrix&#39;</span><span class="s">)</span><span class="sc">;</span>
 903 <span class="s">}</span>
 904 
 905 <span class="c"># Get values of the diagonal in a square matrix as column matrix object</span>
 906 <span class="c">#</span>
<a name="GetDiagonalValuesAsColumnMatrix-"></a> 907 <span class="k">sub </span><span class="m">GetDiagonalValuesAsColumnMatrix</span> <span class="s">{</span>
 908   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 909 
 910   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_GetDiagonalValues</span><span class="s">(</span><span class="q">&#39;AsColumnMatrix&#39;</span><span class="s">)</span><span class="sc">;</span>
 911 <span class="s">}</span>
 912 
 913 <span class="c"># Get values of the diagonal in a square matrix as a space delimited string...</span>
 914 <span class="c">#</span>
<a name="GetDiagonalValuesAsString-"></a> 915 <span class="k">sub </span><span class="m">GetDiagonalValuesAsString</span> <span class="s">{</span>
 916   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 917 
 918   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_GetDiagonalValues</span><span class="s">(</span><span class="q">&#39;AsString&#39;</span><span class="s">)</span><span class="sc">;</span>
 919 <span class="s">}</span>
 920 
 921 <span class="c"># Get diagonal values...</span>
<a name="_GetDiagonalValues-"></a> 922 <span class="k">sub </span><span class="m">_GetDiagonalValues</span> <span class="s">{</span>
 923   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Mode</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 924 
 925   <span class="k">if</span> <span class="s">(</span><span class="i">$Mode</span> !~ <span class="q">/^(AsArray|AsVector|AsRowMatrix|AsColumnMatrix|AsString)$/i</span><span class="s">)</span> <span class="s">{</span>
 926     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;_GetDiagonalValues: Unknown mode, $Mode, specified...&quot;</span><span class="sc">;</span>
 927   <span class="s">}</span>
 928 
 929   <span class="c"># Make sure it&#39;s a square matrix...</span>
 930   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$ErrorMsgPrefix</span><span class="s">)</span><span class="sc">;</span>
 931 
 932   <span class="i">$ErrorMsgPrefix</span> = <span class="q">&quot;${ClassName}-&gt;_GetDiagonalValues${Mode}&quot;</span><span class="sc">;</span>
 933   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 934   <span class="k">if</span> <span class="s">(</span><span class="i">$NumOfRows</span> != <span class="i">$NumOfCols</span><span class="s">)</span> <span class="s">{</span>
 935     <span class="w">croak</span> <span class="q">&quot;Error: $ErrorMsgPrefix: Specified matrix, $NumOfRows x $NumOfCols, is not a square matrix...&quot;</span><span class="sc">;</span>
 936   <span class="s">}</span>
 937 
 938   <span class="c"># Collect values...</span>
 939   <span class="k">my</span><span class="s">(</span><span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">@Values</span><span class="s">)</span><span class="sc">;</span>
 940   <span class="i">@Values</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 941 
 942   <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 943     <span class="k">push</span> <span class="i">@Values</span><span class="cm">,</span> <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$RowIndex</span>]<span class="sc">;</span>
 944   <span class="s">}</span>
 945 
 946   <span class="c"># Return values...</span>
 947   <span class="k">if</span> <span class="s">(</span><span class="i">$Mode</span> =~ <span class="q">/^AsRowMatrix$/i</span><span class="s">)</span> <span class="s">{</span>
 948     <span class="k">return</span> <span class="i">NewFromRows</span><span class="s">(</span>\<span class="i">@Values</span><span class="s">)</span><span class="sc">;</span>
 949   <span class="s">}</span>
 950   <span class="k">elsif</span> <span class="s">(</span><span class="i">$Mode</span> =~ <span class="q">/^AsColumnMatrix$/i</span><span class="s">)</span> <span class="s">{</span>
 951     <span class="k">return</span> <span class="i">NewFromColumns</span><span class="s">(</span>\<span class="i">@Values</span><span class="s">)</span><span class="sc">;</span>
 952   <span class="s">}</span>
 953   <span class="k">elsif</span> <span class="s">(</span><span class="i">$Mode</span> =~ <span class="q">/^AsVector$/i</span><span class="s">)</span> <span class="s">{</span>
 954     <span class="k">return</span> <span class="i">new</span> <span class="i">Vector</span><span class="s">(</span><span class="i">@Values</span><span class="s">)</span><span class="sc">;</span>
 955   <span class="s">}</span>
 956   <span class="k">elsif</span> <span class="s">(</span><span class="i">$Mode</span> =~ <span class="q">/^AsString$/i</span><span class="s">)</span> <span class="s">{</span>
 957     <span class="k">return</span> <span class="k">join</span><span class="s">(</span><span class="q">&#39; &#39;</span><span class="cm">,</span> <span class="i">@Values</span><span class="s">)</span><span class="sc">;</span>
 958   <span class="s">}</span>
 959   <span class="k">else</span> <span class="s">{</span>
 960     <span class="k">return</span> <span class="k">wantarray</span> ? <span class="i">@Values</span> <span class="co">:</span> <span class="k">scalar</span> <span class="i">@Values</span><span class="sc">;</span>
 961   <span class="s">}</span>
 962 <span class="s">}</span>
 963 
 964 <span class="c"># Is it a square matrix?</span>
 965 <span class="c">#</span>
<a name="IsSquare-"></a> 966 <span class="k">sub </span><span class="m">IsSquare</span> <span class="s">{</span>
 967   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 968   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 969 
 970   <span class="k">return</span> <span class="s">(</span><span class="i">$NumOfRows</span> == <span class="i">$NumOfCols</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 971 <span class="s">}</span>
 972 
 973 <span class="c"># Is it a unit matrix?</span>
 974 <span class="c">#</span>
 975 <span class="c"># A matrix is a unit matrix:</span>
 976 <span class="c">#   o It&#39;s a square matrix</span>
 977 <span class="c">#   o All its diagonal elements are ones and its off-diagonal elements are zeros</span>
 978 <span class="c">#</span>
<a name="IsUnit-"></a> 979 <span class="k">sub </span><span class="m">IsUnit</span> <span class="s">{</span>
 980   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 981 
 982   <span class="c"># Is is a square matrix?</span>
 983   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;IsSquare</span><span class="s">(</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 984     <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
 985   <span class="s">}</span>
 986 
 987   <span class="c"># Check matrix values...</span>
 988   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="cm">,</span> <span class="i">$ExpectedValue</span><span class="s">)</span><span class="sc">;</span>
 989   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 990 
 991   <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 992     <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 993       <span class="i">$ExpectedValue</span> = <span class="s">(</span><span class="i">$RowIndex</span> == <span class="i">$ColIndex</span><span class="s">)</span> ? <span class="n">1.0</span> <span class="co">:</span> <span class="n">0.0</span><span class="sc">;</span>
 994       <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] != <span class="i">$ExpectedValue</span><span class="s">)</span> <span class="s">{</span>
 995         <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
 996       <span class="s">}</span>
 997     <span class="s">}</span>
 998   <span class="s">}</span>
 999   <span class="k">return</span> <span class="n">1</span><span class="sc">;</span>
1000 <span class="s">}</span>
1001 
1002 <span class="c"># Is it an identity matrix?</span>
1003 <span class="c">#</span>
<a name="IsIdentity-"></a>1004 <span class="k">sub </span><span class="m">IsIdentity</span> <span class="s">{</span>
1005   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1006 
1007   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;IsUnit</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1008 <span class="s">}</span>
1009 
1010 <span class="c"># Is it a diagonal matrix?</span>
1011 <span class="c">#</span>
1012 <span class="c"># A matrix is a diagonal matrix:</span>
1013 <span class="c">#   o It&#39;s a square matrix</span>
1014 <span class="c">#   o All its off-diagonal elements are zeros and its diagonal elements may or may not</span>
1015 <span class="c">#     be zeros</span>
1016 <span class="c">#</span>
1017 <span class="c">#</span>
<a name="IsDiagonal-"></a>1018 <span class="k">sub </span><span class="m">IsDiagonal</span> <span class="s">{</span>
1019   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1020 
1021   <span class="c"># Is is a square matrix?</span>
1022   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;IsSquare</span><span class="s">(</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1023     <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1024   <span class="s">}</span>
1025 
1026   <span class="c"># Check off-diagonal matrix values...</span>
1027   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
1028   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1029 
1030   <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1031     <span class="j">COLINDEX:</span> <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1032       <span class="k">if</span> <span class="s">(</span><span class="i">$RowIndex</span> == <span class="i">$ColIndex</span><span class="s">)</span> <span class="s">{</span>
1033         <span class="k">next</span> <span class="j">COLINDEX</span><span class="sc">;</span>
1034       <span class="s">}</span>
1035       <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] != <span class="n">0.0</span><span class="s">)</span> <span class="s">{</span>
1036         <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1037       <span class="s">}</span>
1038     <span class="s">}</span>
1039   <span class="s">}</span>
1040   <span class="k">return</span> <span class="n">1</span><span class="sc">;</span>
1041 <span class="s">}</span>
1042 
1043 <span class="c"># Is it a lower bidiagonal matrix?</span>
1044 <span class="c">#</span>
1045 <span class="c"># A matrix is a lower bidiagonal matrix:</span>
1046 <span class="c">#   o It&#39;s a square matrix</span>
1047 <span class="c">#   o All its main diagonal and lower diagonal elements are non-zeros and all its</span>
1048 <span class="c">#     other elements are zeros</span>
1049 <span class="c">#</span>
<a name="IsLowerBiDiagonal-"></a>1050 <span class="k">sub </span><span class="m">IsLowerBiDiagonal</span> <span class="s">{</span>
1051   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1052 
1053   <span class="c"># Is is a square matrix?</span>
1054   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;IsSquare</span><span class="s">(</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1055     <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1056   <span class="s">}</span>
1057 
1058   <span class="c"># Check matrix values...</span>
1059   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span><span class="sc">;</span>
1060   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1061 
1062   <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1063     <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1064       <span class="i">$Value</span> = <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>]<span class="sc">;</span>
1065       <span class="k">if</span> <span class="s">(</span><span class="i">$RowIndex</span> == <span class="i">$ColIndex</span><span class="s">)</span> <span class="s">{</span>
1066         <span class="c"># Main diagonal...</span>
1067         <span class="k">if</span> <span class="s">(</span><span class="i">$Value</span> == <span class="n">0.0</span><span class="s">)</span> <span class="s">{</span>
1068           <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1069         <span class="s">}</span>
1070       <span class="s">}</span>
1071       <span class="k">elsif</span> <span class="s">(</span><span class="i">$RowIndex</span> == <span class="s">(</span><span class="i">$ColIndex</span> + <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1072         <span class="c"># Lower diagonal...</span>
1073         <span class="k">if</span> <span class="s">(</span><span class="i">$Value</span> == <span class="n">0.0</span><span class="s">)</span> <span class="s">{</span>
1074           <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1075         <span class="s">}</span>
1076       <span class="s">}</span>
1077       <span class="k">else</span> <span class="s">{</span>
1078         <span class="c"># Other elements...</span>
1079         <span class="k">if</span> <span class="s">(</span><span class="i">$Value</span> != <span class="n">0.0</span><span class="s">)</span> <span class="s">{</span>
1080           <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1081         <span class="s">}</span>
1082       <span class="s">}</span>
1083     <span class="s">}</span>
1084   <span class="s">}</span>
1085   <span class="k">return</span> <span class="n">1</span><span class="sc">;</span>
1086 <span class="s">}</span>
1087 
1088 <span class="c"># Is it an upper bidiagonal matrix?</span>
1089 <span class="c">#</span>
1090 <span class="c"># A matrix is an upper bidiagonal matrix:</span>
1091 <span class="c">#   o It&#39;s a square matrix</span>
1092 <span class="c">#   o All its main diagonal and upper diagonal elements are non-zeros and all its</span>
1093 <span class="c">#     other elements are zeros</span>
1094 <span class="c">#</span>
<a name="IsUpperBiDiagonal-"></a>1095 <span class="k">sub </span><span class="m">IsUpperBiDiagonal</span> <span class="s">{</span>
1096   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1097 
1098   <span class="c"># Is is a square matrix?</span>
1099   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;IsSquare</span><span class="s">(</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1100     <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1101   <span class="s">}</span>
1102   <span class="c"># Check matrix values...</span>
1103   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span><span class="sc">;</span>
1104   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1105 
1106   <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1107     <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1108       <span class="i">$Value</span> = <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>]<span class="sc">;</span>
1109       <span class="k">if</span> <span class="s">(</span><span class="i">$RowIndex</span> == <span class="i">$ColIndex</span><span class="s">)</span> <span class="s">{</span>
1110         <span class="c"># Main diagonal...</span>
1111         <span class="k">if</span> <span class="s">(</span><span class="i">$Value</span> == <span class="n">0.0</span><span class="s">)</span> <span class="s">{</span>
1112           <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1113         <span class="s">}</span>
1114       <span class="s">}</span>
1115       <span class="k">elsif</span> <span class="s">(</span><span class="i">$RowIndex</span> == <span class="s">(</span><span class="i">$ColIndex</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1116         <span class="c"># Upper diagonal...</span>
1117         <span class="k">if</span> <span class="s">(</span><span class="i">$Value</span> == <span class="n">0.0</span><span class="s">)</span> <span class="s">{</span>
1118           <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1119         <span class="s">}</span>
1120       <span class="s">}</span>
1121       <span class="k">else</span> <span class="s">{</span>
1122         <span class="c"># Other elements...</span>
1123         <span class="k">if</span> <span class="s">(</span><span class="i">$Value</span> != <span class="n">0.0</span><span class="s">)</span> <span class="s">{</span>
1124           <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1125         <span class="s">}</span>
1126       <span class="s">}</span>
1127     <span class="s">}</span>
1128   <span class="s">}</span>
1129   <span class="k">return</span> <span class="n">1</span><span class="sc">;</span>
1130 <span class="s">}</span>
1131 
1132 <span class="c"># Is it a bidiagonal matrix?</span>
1133 <span class="c">#</span>
1134 <span class="c"># A matrix is a bidiagonal matrix:</span>
1135 <span class="c">#</span>
<a name="IsBiDiagonal-"></a>1136 <span class="k">sub </span><span class="m">IsBiDiagonal</span> <span class="s">{</span>
1137   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1138 
1139   <span class="k">return</span> <span class="s">(</span><span class="i">$This</span><span class="i">-&gt;IsUpperBiDiagonal</span><span class="s">(</span><span class="s">)</span> || <span class="i">$This</span><span class="i">-&gt;IsLowerBiDiagonal</span><span class="s">(</span><span class="s">)</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
1140 <span class="s">}</span>
1141 
1142 <span class="c"># Is it a tridiagonal matrix?</span>
1143 <span class="c">#</span>
1144 <span class="c"># A matrix is a  tribidiagonal matrix:</span>
1145 <span class="c">#   o It&#39;s a square matrix</span>
1146 <span class="c">#   o All its main diagonal, upper diagonal, and lower diagonal elements are non-zeros and all its</span>
1147 <span class="c">#     other elements are zeros</span>
1148 <span class="c">#</span>
1149 <span class="c">#</span>
<a name="IsTriDiagonal-"></a>1150 <span class="k">sub </span><span class="m">IsTriDiagonal</span> <span class="s">{</span>
1151   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1152 
1153   <span class="c"># Is is a square matrix?</span>
1154   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;IsSquare</span><span class="s">(</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1155     <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1156   <span class="s">}</span>
1157 
1158   <span class="c"># Check matrix values...</span>
1159   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span><span class="sc">;</span>
1160   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1161 
1162   <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1163     <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1164       <span class="i">$Value</span> = <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>]<span class="sc">;</span>
1165       <span class="k">if</span> <span class="s">(</span><span class="i">$RowIndex</span> == <span class="i">$ColIndex</span><span class="s">)</span> <span class="s">{</span>
1166         <span class="c"># Main diagonal...</span>
1167         <span class="k">if</span> <span class="s">(</span><span class="i">$Value</span> == <span class="n">0.0</span><span class="s">)</span> <span class="s">{</span>
1168           <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1169         <span class="s">}</span>
1170       <span class="s">}</span>
1171       <span class="k">elsif</span> <span class="s">(</span><span class="i">$RowIndex</span> == <span class="s">(</span><span class="i">$ColIndex</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1172         <span class="c"># Upper diagonal...</span>
1173         <span class="k">if</span> <span class="s">(</span><span class="i">$Value</span> == <span class="n">0.0</span><span class="s">)</span> <span class="s">{</span>
1174           <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1175         <span class="s">}</span>
1176       <span class="s">}</span>
1177       <span class="k">elsif</span> <span class="s">(</span><span class="i">$RowIndex</span> == <span class="s">(</span><span class="i">$ColIndex</span> + <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1178         <span class="c"># Lower diagonal...</span>
1179         <span class="k">if</span> <span class="s">(</span><span class="i">$Value</span> == <span class="n">0.0</span><span class="s">)</span> <span class="s">{</span>
1180           <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1181         <span class="s">}</span>
1182       <span class="s">}</span>
1183       <span class="k">else</span> <span class="s">{</span>
1184         <span class="c"># Other elements...</span>
1185         <span class="k">if</span> <span class="s">(</span><span class="i">$Value</span> != <span class="n">0.0</span><span class="s">)</span> <span class="s">{</span>
1186           <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1187         <span class="s">}</span>
1188       <span class="s">}</span>
1189     <span class="s">}</span>
1190   <span class="s">}</span>
1191   <span class="k">return</span> <span class="n">1</span><span class="sc">;</span>
1192 <span class="s">}</span>
1193 
1194 <span class="c"># Is it a lower triangular matrix?</span>
1195 <span class="c">#</span>
1196 <span class="c"># A matrix is a lower triangular matrix:</span>
1197 <span class="c">#   o It&#39;s a square matrix</span>
1198 <span class="c">#   o All its entries above the main diagonal are zero</span>
1199 <span class="c">#</span>
<a name="IsLowerTriangular-"></a>1200 <span class="k">sub </span><span class="m">IsLowerTriangular</span> <span class="s">{</span>
1201   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1202 
1203   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_IsLowerTriangularMatrix</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1204 <span class="s">}</span>
1205 
1206 <span class="c"># Is it a left triangular matrix?</span>
1207 <span class="c">#</span>
1208 <span class="c"># A matrix is a left triangular matrix:</span>
1209 <span class="c">#   o It&#39;s a square matrix</span>
1210 <span class="c">#   o All its entries above the main diagonal are zero</span>
1211 <span class="c">#</span>
<a name="IsLeftTriangular-"></a>1212 <span class="k">sub </span><span class="m">IsLeftTriangular</span> <span class="s">{</span>
1213   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1214 
1215   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;IsLowerTriangular</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1216 <span class="s">}</span>
1217 
1218 <span class="c"># Is it a strictly lower triangular matrix?</span>
1219 <span class="c">#</span>
1220 <span class="c"># A matrix is a strictly lower triangular matrix:</span>
1221 <span class="c">#   o It&#39;s a square matrix</span>
1222 <span class="c">#   o All its entries on and above the main diagonal are zero</span>
1223 <span class="c">#</span>
<a name="IsStrictlyLowerTriangular-"></a>1224 <span class="k">sub </span><span class="m">IsStrictlyLowerTriangular</span> <span class="s">{</span>
1225   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1226   <span class="k">my</span><span class="s">(</span><span class="i">$DiagonalValue</span><span class="s">)</span><span class="sc">;</span>
1227 
1228   <span class="i">$DiagonalValue</span> = <span class="n">0</span><span class="sc">;</span>
1229 
1230   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_IsLowerTriangularMatrix</span><span class="s">(</span><span class="i">$DiagonalValue</span><span class="s">)</span><span class="sc">;</span>
1231 <span class="s">}</span>
1232 
1233 <span class="c"># Is it an unit lower triangular matrix?</span>
1234 <span class="c">#</span>
1235 <span class="c"># A matrix is an unit lower triangular matrix:</span>
1236 <span class="c">#   o It&#39;s a square matrix</span>
1237 <span class="c">#   o All its entries main diagonal are one</span>
1238 <span class="c">#   o All its entries above the main diagonal are zero</span>
1239 <span class="c">#</span>
<a name="IsUnitLowerTriangular-"></a>1240 <span class="k">sub </span><span class="m">IsUnitLowerTriangular</span> <span class="s">{</span>
1241   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1242   <span class="k">my</span><span class="s">(</span><span class="i">$DiagonalValue</span><span class="s">)</span><span class="sc">;</span>
1243 
1244   <span class="i">$DiagonalValue</span> = <span class="n">1</span><span class="sc">;</span>
1245 
1246   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_IsLowerTriangularMatrix</span><span class="s">(</span><span class="i">$DiagonalValue</span><span class="s">)</span><span class="sc">;</span>
1247 <span class="s">}</span>
1248 
1249 <span class="c"># Is it a lower unitriangular matrix?</span>
1250 <span class="c">#</span>
<a name="IsLowerUniTriangular-"></a>1251 <span class="k">sub </span><span class="m">IsLowerUniTriangular</span> <span class="s">{</span>
1252   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1253 
1254   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;IsUnitLowerTriangular</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1255 <span class="s">}</span>
1256 
1257 <span class="c"># Is it a lower triangular, strictly lower triangular, or unit lower triangular matrix?</span>
1258 <span class="c">#</span>
<a name="_IsLowerTriangularMatrix-"></a>1259 <span class="k">sub </span><span class="m">_IsLowerTriangularMatrix</span> <span class="s">{</span>
1260   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$DiagonalValue</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1261 
1262   <span class="c"># Is is a square matrix?</span>
1263   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;IsSquare</span><span class="s">(</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1264     <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1265   <span class="s">}</span>
1266   <span class="c"># Check matrix values...</span>
1267   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="cm">,</span> <span class="i">$CheckDiagonalValues</span><span class="s">)</span><span class="sc">;</span>
1268 
1269   <span class="i">$CheckDiagonalValues</span> = <span class="k">defined</span><span class="s">(</span><span class="i">$DiagonalValue</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
1270   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1271 
1272   <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1273     <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1274       <span class="k">if</span> <span class="s">(</span><span class="i">$CheckDiagonalValues</span> &amp;&amp; <span class="i">$RowIndex</span> == <span class="i">$ColIndex</span><span class="s">)</span> <span class="s">{</span>
1275         <span class="c"># Main diagonal...</span>
1276         <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] != <span class="i">$DiagonalValue</span><span class="s">)</span> <span class="s">{</span>
1277           <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1278         <span class="s">}</span>
1279       <span class="s">}</span>
1280       <span class="k">elsif</span> <span class="s">(</span><span class="i">$RowIndex</span> &lt; <span class="i">$ColIndex</span><span class="s">)</span> <span class="s">{</span>
1281         <span class="c"># Elemens above the main diagonal...</span>
1282         <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] != <span class="n">0.0</span><span class="s">)</span> <span class="s">{</span>
1283           <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1284         <span class="s">}</span>
1285       <span class="s">}</span>
1286     <span class="s">}</span>
1287   <span class="s">}</span>
1288   <span class="k">return</span> <span class="n">1</span><span class="sc">;</span>
1289 <span class="s">}</span>
1290 
1291 <span class="c"># Is it an upper triangular matrix?</span>
1292 <span class="c">#</span>
1293 <span class="c"># A matrix is an upper triangular matrix:</span>
1294 <span class="c">#   o It&#39;s a square matrix</span>
1295 <span class="c">#   o All its entries below the main diagonal are zero</span>
1296 <span class="c">#</span>
<a name="IsUpperTriangular-"></a>1297 <span class="k">sub </span><span class="m">IsUpperTriangular</span> <span class="s">{</span>
1298   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1299 
1300   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_IsUpperTriangularMatrix</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1301 <span class="s">}</span>
1302 
1303 <span class="c"># Is it a right triangular matrix?</span>
1304 <span class="c">#</span>
1305 <span class="c"># A matrix is a right triangular matrix:</span>
1306 <span class="c">#   o It&#39;s a square matrix</span>
1307 <span class="c">#   o All its entries below the main diagonal are zero</span>
1308 <span class="c">#</span>
<a name="IsRightTriangular-"></a>1309 <span class="k">sub </span><span class="m">IsRightTriangular</span> <span class="s">{</span>
1310   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1311 
1312   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;IsUpperTriangular</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1313 <span class="s">}</span>
1314 
1315 <span class="c"># Is it a strictly upper triangular matrix?</span>
1316 <span class="c">#</span>
1317 <span class="c"># A matrix is a strictly upper triangular matrix:</span>
1318 <span class="c">#   o It&#39;s a square matrix</span>
1319 <span class="c">#   o All its entries on and below the main diagonal are zero</span>
1320 <span class="c">#</span>
<a name="IsStrictlyUpperTriangular-"></a>1321 <span class="k">sub </span><span class="m">IsStrictlyUpperTriangular</span> <span class="s">{</span>
1322   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1323   <span class="k">my</span><span class="s">(</span><span class="i">$DiagonalValue</span><span class="s">)</span><span class="sc">;</span>
1324 
1325   <span class="i">$DiagonalValue</span> = <span class="n">0</span><span class="sc">;</span>
1326 
1327   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_IsUpperTriangularMatrix</span><span class="s">(</span><span class="i">$DiagonalValue</span><span class="s">)</span><span class="sc">;</span>
1328 <span class="s">}</span>
1329 
1330 <span class="c"># Is it a unit upper triangular matrix?</span>
1331 <span class="c">#</span>
1332 <span class="c"># A matrix is an unit upper triangular matrix:</span>
1333 <span class="c">#   o It&#39;s a square matrix</span>
1334 <span class="c">#   o All its entries main diagonal are one</span>
1335 <span class="c">#   o All its entries below the main diagonal are zero</span>
1336 <span class="c">#</span>
<a name="IsUnitUpperTriangular-"></a>1337 <span class="k">sub </span><span class="m">IsUnitUpperTriangular</span> <span class="s">{</span>
1338   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1339   <span class="k">my</span><span class="s">(</span><span class="i">$DiagonalValue</span><span class="s">)</span><span class="sc">;</span>
1340 
1341   <span class="i">$DiagonalValue</span> = <span class="n">1</span><span class="sc">;</span>
1342 
1343   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_IsUpperTriangularMatrix</span><span class="s">(</span><span class="i">$DiagonalValue</span><span class="s">)</span><span class="sc">;</span>
1344 <span class="s">}</span>
1345 
1346 <span class="c"># Is it a upper unitriangular matrix?</span>
1347 <span class="c">#</span>
<a name="IsUpperUniTriangular-"></a>1348 <span class="k">sub </span><span class="m">IsUpperUniTriangular</span> <span class="s">{</span>
1349   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1350 
1351   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;IsUnitUpperTriangular</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1352 <span class="s">}</span>
1353 
1354 <span class="c"># Is it an upper triangular, strictly upper triangular, or unit upper triangular matrix?</span>
1355 <span class="c">#</span>
<a name="_IsUpperTriangularMatrix-"></a>1356 <span class="k">sub </span><span class="m">_IsUpperTriangularMatrix</span> <span class="s">{</span>
1357   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$DiagonalValue</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1358 
1359   <span class="c"># Is is a square matrix?</span>
1360   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;IsSquare</span><span class="s">(</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1361     <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1362   <span class="s">}</span>
1363   <span class="c"># Check matrix values...</span>
1364   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="cm">,</span> <span class="i">$CheckDiagonalValues</span><span class="s">)</span><span class="sc">;</span>
1365 
1366   <span class="i">$CheckDiagonalValues</span> = <span class="k">defined</span><span class="s">(</span><span class="i">$DiagonalValue</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
1367   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1368 
1369   <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1370     <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1371       <span class="k">if</span> <span class="s">(</span><span class="i">$CheckDiagonalValues</span> &amp;&amp; <span class="i">$RowIndex</span> == <span class="i">$ColIndex</span><span class="s">)</span> <span class="s">{</span>
1372         <span class="c"># Main diagonal...</span>
1373         <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] != <span class="i">$DiagonalValue</span><span class="s">)</span> <span class="s">{</span>
1374           <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1375         <span class="s">}</span>
1376       <span class="s">}</span>
1377       <span class="k">elsif</span> <span class="s">(</span><span class="i">$RowIndex</span> &gt; <span class="i">$ColIndex</span><span class="s">)</span> <span class="s">{</span>
1378         <span class="c"># Elemens below the main diagonal...</span>
1379         <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] != <span class="n">0.0</span><span class="s">)</span> <span class="s">{</span>
1380           <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1381         <span class="s">}</span>
1382       <span class="s">}</span>
1383     <span class="s">}</span>
1384   <span class="s">}</span>
1385   <span class="k">return</span> <span class="n">1</span><span class="sc">;</span>
1386 <span class="s">}</span>
1387 
1388 <span class="c"># Is it a symmetrix matrix?</span>
1389 <span class="c">#</span>
1390 <span class="c"># A matrix is a symmetric matrix:</span>
1391 <span class="c">#   o It&#39;s a square matrix</span>
1392 <span class="c">#   o Its elements are symmetric with respect to main diagonal. In other words,</span>
1393 <span class="c">#     elements below the main diagonal are equal to the elements above the main</span>
1394 <span class="c">#     diagonal.</span>
1395 <span class="c">#</span>
1396 <span class="c"># Transpose of a symmetric matrix equals the matrix itself.</span>
1397 <span class="c">#</span>
<a name="IsSymmetric-"></a>1398 <span class="k">sub </span><span class="m">IsSymmetric</span> <span class="s">{</span>
1399   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1400 
1401   <span class="c"># Is is a square matrix?</span>
1402   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;IsSquare</span><span class="s">(</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1403     <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1404   <span class="s">}</span>
1405 
1406   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
1407   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1408 
1409   <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1410     <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$RowIndex</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1411       <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] != <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$ColIndex</span>][<span class="i">$RowIndex</span>]<span class="s">)</span> <span class="s">{</span>
1412         <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1413       <span class="s">}</span>
1414     <span class="s">}</span>
1415   <span class="s">}</span>
1416   <span class="k">return</span> <span class="n">1</span><span class="sc">;</span>
1417 <span class="s">}</span>
1418 
1419 <span class="c"># Is it a anti symmetrix matrix?</span>
1420 <span class="c">#</span>
1421 <span class="c"># A matrix is an anti symmetric matrix:</span>
1422 <span class="c">#   o It&#39;s a square matrix</span>
1423 <span class="c">#   o Its elements are asymmetric with respect to main diagonal. In other words,</span>
1424 <span class="c">#     elements below the main diagonal are equal to the negative of elements above</span>
1425 <span class="c">#     the main diagonal.</span>
1426 <span class="c">#</span>
1427 <span class="c"># Transpose of a anti symmetric matrix equals the negative of the matrix.</span>
1428 <span class="c">#</span>
<a name="IsAntiSymmetric-"></a>1429 <span class="k">sub </span><span class="m">IsAntiSymmetric</span> <span class="s">{</span>
1430   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1431 
1432   <span class="c"># Is is a square matrix?</span>
1433   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;IsSquare</span><span class="s">(</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1434     <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1435   <span class="s">}</span>
1436 
1437   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
1438   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1439 
1440   <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1441     <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$RowIndex</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1442       <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] != -<span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$ColIndex</span>][<span class="i">$RowIndex</span>]<span class="s">)</span> <span class="s">{</span>
1443         <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1444       <span class="s">}</span>
1445     <span class="s">}</span>
1446   <span class="s">}</span>
1447   <span class="k">return</span> <span class="n">1</span><span class="sc">;</span>
1448 <span class="s">}</span>
1449 
1450 <span class="c"># Is it a skew symmetrix matrix?</span>
1451 <span class="c">#</span>
1452 <span class="c"># It&#39;s another name for AnitSymmetricMatrix.</span>
1453 <span class="c">#</span>
<a name="IsSkewSymmetric-"></a>1454 <span class="k">sub </span><span class="m">IsSkewSymmetric</span> <span class="s">{</span>
1455   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1456 
1457   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;IsAntiSymmetric</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1458 <span class="s">}</span>
1459 
1460 <span class="c"># Is it a positive matrix with all its values &gt;= zero?</span>
1461 <span class="c">#</span>
<a name="IsPositive-"></a>1462 <span class="k">sub </span><span class="m">IsPositive</span> <span class="s">{</span>
1463   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1464 
1465   <span class="c"># Check matrix values...</span>
1466   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
1467   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1468 
1469   <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1470     <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1471       <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] &lt; <span class="n">0.0</span><span class="s">)</span> <span class="s">{</span>
1472         <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1473       <span class="s">}</span>
1474     <span class="s">}</span>
1475   <span class="s">}</span>
1476   <span class="k">return</span> <span class="n">1</span><span class="sc">;</span>
1477 <span class="s">}</span>
1478 
1479 <span class="c"># Is it a positive matrix with all its values &lt;= zero?</span>
1480 <span class="c">#</span>
<a name="IsNegative-"></a>1481 <span class="k">sub </span><span class="m">IsNegative</span> <span class="s">{</span>
1482   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1483 
1484   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;IsPositive</span><span class="s">(</span><span class="s">)</span> ? <span class="n">0</span> <span class="co">:</span> <span class="n">1</span><span class="sc">;</span>
1485 <span class="s">}</span>
1486 
1487 <span class="c"># Transpose the matrix by swaping rows with columns...</span>
1488 <span class="c">#</span>
<a name="Transpose-"></a>1489 <span class="k">sub </span><span class="m">Transpose</span> <span class="s">{</span>
1490   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1491   <span class="k">my</span><span class="s">(</span><span class="i">$Matrix</span><span class="cm">,</span> <span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
1492 
1493   <span class="c"># Create the transpose matrix of size $NumOfCols x $NumOfRows</span>
1494   <span class="c">#</span>
1495   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1496   <span class="i">$Matrix</span> = <span class="i">new</span> <span class="i">Matrix</span><span class="s">(</span><span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$NumOfRows</span><span class="s">)</span><span class="sc">;</span>
1497 
1498   <span class="c"># Swap rows and columns...</span>
1499   <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1500     <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1501       <span class="i">$Matrix</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] = <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$ColIndex</span>][<span class="i">$RowIndex</span>]<span class="sc">;</span>
1502     <span class="s">}</span>
1503   <span class="s">}</span>
1504   <span class="k">return</span> <span class="i">$Matrix</span><span class="sc">;</span>
1505 <span class="s">}</span>
1506 
1507 <span class="c"># Is it a matrix object?</span>
<a name="IsMatrix-"></a>1508 <span class="k">sub </span><span class="m">IsMatrix ($)</span> <span class="s">{</span>
1509   <span class="k">my</span><span class="s">(</span><span class="i">$Object</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1510 
1511   <span class="k">return</span> <span class="i">_IsMatrix</span><span class="s">(</span><span class="i">$Object</span><span class="s">)</span><span class="sc">;</span>
1512 <span class="s">}</span>
1513 
1514 <span class="c"># Set value print format for an individual object or the whole class during StringifyMatrix operation...</span>
<a name="SetValuePrintFormat-"></a>1515 <span class="k">sub </span><span class="m">SetValuePrintFormat ($;$)</span> <span class="s">{</span>
1516   <span class="k">my</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1517 
1518   <span class="k">if</span> <span class="s">(</span><span class="s">(</span><span class="i">@_</span> == <span class="n">2</span><span class="s">)</span> &amp;&amp; <span class="s">(</span><span class="i">_IsMatrix</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="s">)</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1519     <span class="c"># Set value print format for the specific object...</span>
1520     <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$ValuePrintFormat</span><span class="s">)</span> = <span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="s">)</span><span class="sc">;</span>
1521 
1522     <span class="i">$This</span>-&gt;{<span class="w">ValueFormat</span>} = <span class="i">$ValuePrintFormat</span><span class="sc">;</span>
1523   <span class="s">}</span>
1524   <span class="k">else</span> <span class="s">{</span>
1525     <span class="c"># Set value print format for the class...</span>
1526     <span class="k">my</span><span class="s">(</span><span class="i">$ValuePrintFormat</span><span class="s">)</span> = <span class="s">(</span><span class="i">$FirstParameter</span><span class="s">)</span><span class="sc">;</span>
1527 
1528     <span class="i">$ValueFormat</span> = <span class="i">$ValuePrintFormat</span><span class="sc">;</span>
1529   <span class="s">}</span>
1530 <span class="s">}</span>
1531 
1532 <span class="c"># Set print style for matrix rows for an individual object or the whole class during StringifyMatrix</span>
1533 <span class="c"># operation.</span>
1534 <span class="c">#</span>
1535 <span class="c"># Possible values: AllRowsInOneLine, OneRowPerLine. Default: AllRowsInOneLine</span>
1536 <span class="c">#</span>
<a name="SetMatrixPrintStyle-"></a>1537 <span class="k">sub </span><span class="m">SetMatrixPrintStyle ($;$)</span> <span class="s">{</span>
1538   <span class="k">my</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1539 
1540   <span class="k">if</span> <span class="s">(</span><span class="s">(</span><span class="i">@_</span> == <span class="n">2</span><span class="s">)</span> &amp;&amp; <span class="s">(</span><span class="i">_IsMatrix</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="s">)</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1541     <span class="c"># Set value print format for the specific object...</span>
1542     <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$MatrixPrintStyleValue</span><span class="s">)</span> = <span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="s">)</span><span class="sc">;</span>
1543 
1544     <span class="k">if</span> <span class="s">(</span><span class="i">$MatrixPrintStyleValue</span> !~ <span class="q">/^(AllRowsInOneLine|OneRowPerLine)$/i</span><span class="s">)</span> <span class="s">{</span>
1545       <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;SetMatrixPrintStyle: Specified MatrixPrintStyle, $MatrixPrintStyleValue, is not valid. Supported values: AllRowsInOneLine, OneRowPerLine...&quot;</span><span class="sc">;</span>
1546     <span class="s">}</span>
1547 
1548     <span class="i">$This</span>-&gt;{<span class="w">MatrixPrintStyle</span>} = <span class="i">$MatrixPrintStyleValue</span><span class="sc">;</span>
1549   <span class="s">}</span>
1550   <span class="k">else</span> <span class="s">{</span>
1551     <span class="c"># Set value print format for the class...</span>
1552     <span class="k">my</span><span class="s">(</span><span class="i">$MatrixPrintStyleValue</span><span class="s">)</span> = <span class="s">(</span><span class="i">$FirstParameter</span><span class="s">)</span><span class="sc">;</span>
1553 
1554     <span class="k">if</span> <span class="s">(</span><span class="i">$MatrixPrintStyleValue</span> !~ <span class="q">/^(AllRowsInOneLine|OneRowPerLine)$/i</span><span class="s">)</span> <span class="s">{</span>
1555       <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}::SetMatrixPrintStyle: Specified MatrixPrintStyle, $MatrixPrintStyleValue, is not valid. Supported values: AllRowsInOneLine, OneRowPerLine...&quot;</span><span class="sc">;</span>
1556     <span class="s">}</span>
1557 
1558     <span class="i">$MatrixPrintStyle</span> = <span class="i">$MatrixPrintStyleValue</span><span class="sc">;</span>
1559   <span class="s">}</span>
1560 <span class="s">}</span>
1561 
1562 <span class="c"># Is it a matrix object?</span>
1563 <span class="c">#</span>
<a name="_IsMatrix-"></a>1564 <span class="k">sub </span><span class="m">_IsMatrix</span> <span class="s">{</span>
1565   <span class="k">my</span><span class="s">(</span><span class="i">$Object</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1566 
1567   <span class="k">return</span> <span class="s">(</span><span class="i">Scalar::Util::blessed</span><span class="s">(</span><span class="i">$Object</span><span class="s">)</span> &amp;&amp; <span class="i">$Object</span><span class="i">-&gt;isa</span><span class="s">(</span><span class="i">$ClassName</span><span class="s">)</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
1568 <span class="s">}</span>
1569 
1570 <span class="c"># Make sure it&#39;s a matrix reference...</span>
1571 <span class="c">#</span>
<a name="_ValidateMatrix-"></a>1572 <span class="k">sub </span><span class="m">_ValidateMatrix</span> <span class="s">{</span>
1573   <span class="k">my</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">$Matrix</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1574 
1575   <span class="k">if</span> <span class="s">(</span>!<span class="i">_IsMatrix</span><span class="s">(</span><span class="i">$Matrix</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1576     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;${ErrorMsg}: Object must be a matrix...&quot;</span><span class="sc">;</span>
1577   <span class="s">}</span>
1578 <span class="s">}</span>
1579 
1580 <span class="c"># Make sure both row and column indicies are valid...</span>
1581 <span class="c">#</span>
<a name="_ValidateRowAndColumnIndicies-"></a>1582 <span class="k">sub </span><span class="m">_ValidateRowAndColumnIndicies</span> <span class="s">{</span>
1583   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$ErrorMsgPrefix</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColumnIndex</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1584 
1585   <span class="i">$This</span><span class="i">-&gt;_ValidateRowIndex</span><span class="s">(</span><span class="i">$ErrorMsgPrefix</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="s">)</span><span class="sc">;</span>
1586   <span class="i">$This</span><span class="i">-&gt;_ValidateColumnIndex</span><span class="s">(</span><span class="i">$ErrorMsgPrefix</span><span class="cm">,</span> <span class="i">$ColumnIndex</span><span class="s">)</span><span class="sc">;</span>
1587 
1588   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
1589 <span class="s">}</span>
1590 
1591 <span class="c"># Make sure it&#39;s a valid row index...</span>
1592 <span class="c">#</span>
<a name="_ValidateRowIndex-"></a>1593 <span class="k">sub </span><span class="m">_ValidateRowIndex</span> <span class="s">{</span>
1594   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$ErrorMsgPrefix</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1595   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="s">)</span><span class="sc">;</span>
1596 
1597   <span class="k">if</span> <span class="s">(</span>!<span class="k">defined</span> <span class="i">$RowIndex</span><span class="s">)</span> <span class="s">{</span>
1598     <span class="w">croak</span> <span class="q">&quot;$ErrorMsgPrefix: RowIndex must be defined...&quot;</span><span class="sc">;</span>
1599   <span class="s">}</span>
1600   <span class="i">$NumOfRows</span> = <span class="i">$This</span><span class="i">-&gt;GetNumOfRows</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1601   <span class="k">if</span> <span class="s">(</span><span class="i">$RowIndex</span> &lt; <span class="n">0</span> || <span class="i">$RowIndex</span> &gt;= <span class="i">$NumOfRows</span><span class="s">)</span> <span class="s">{</span>
1602     <span class="w">croak</span> <span class="q">&quot;$ErrorMsgPrefix: RowIndex value $RowIndex must be &gt;= 0 and &lt; $NumOfRows, NumOfRows, in matrix...&quot;</span><span class="sc">;</span>
1603   <span class="s">}</span>
1604   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
1605 <span class="s">}</span>
1606 
1607 <span class="c"># Make sure it&#39;s a valid column index...</span>
1608 <span class="c">#</span>
<a name="_ValidateColumnIndex-"></a>1609 <span class="k">sub </span><span class="m">_ValidateColumnIndex</span> <span class="s">{</span>
1610   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$ErrorMsgPrefix</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1611   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfCols</span><span class="s">)</span><span class="sc">;</span>
1612 
1613   <span class="k">if</span> <span class="s">(</span>!<span class="k">defined</span> <span class="i">$ColIndex</span><span class="s">)</span> <span class="s">{</span>
1614     <span class="w">croak</span> <span class="q">&quot;$ErrorMsgPrefix: ColIndex must be defined...&quot;</span><span class="sc">;</span>
1615   <span class="s">}</span>
1616   <span class="i">$NumOfCols</span> = <span class="i">$This</span><span class="i">-&gt;GetNumOfColumns</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1617   <span class="k">if</span> <span class="s">(</span><span class="i">$ColIndex</span> &lt; <span class="n">0</span> || <span class="i">$ColIndex</span> &gt;= <span class="i">$NumOfCols</span><span class="s">)</span> <span class="s">{</span>
1618     <span class="w">croak</span> <span class="q">&quot;$ErrorMsgPrefix: ColIndex value $ColIndex must be &gt;= 0 and &lt; $NumOfCols, NumOfCols, in matrix...&quot;</span><span class="sc">;</span>
1619   <span class="s">}</span>
1620   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
1621 <span class="s">}</span>
1622 
1623 <span class="c">#</span>
1624 <span class="c"># Matrix addition operator supports two addition modes:</span>
1625 <span class="c">#   . Addition of two matrices by adding corresponding matrix values</span>
1626 <span class="c">#   . Addition of a scalar value to matrix values ($Matrix + 1)</span>
1627 <span class="c">#</span>
1628 <span class="c"># Caveats:</span>
1629 <span class="c">#   . Addition of a matrix to scalar is not allowed (1 + $Matrix)</span>
1630 <span class="c">#</span>
<a name="_MatrixAdditionOperator-"></a>1631 <span class="k">sub </span><span class="m">_MatrixAdditionOperator</span> <span class="s">{</span>
1632   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="cm">,</span> <span class="i">$ErrorMsg</span><span class="s">)</span><span class="sc">;</span>
1633 
1634   <span class="i">$ErrorMsg</span> = <span class="q">&quot;_MatrixAdditionOperator: Matrix addition failed&quot;</span><span class="sc">;</span>
1635   <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="s">)</span> = <span class="i">_ProcessOverloadedOperatorParameters</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">@_</span><span class="s">)</span><span class="sc">;</span>
1636 
1637   <span class="k">my</span><span class="s">(</span><span class="i">$Matrix</span><span class="cm">,</span> <span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
1638 
1639   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1640   <span class="i">$Matrix</span> = <span class="i">new</span> <span class="i">Matrix</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span><span class="sc">;</span>
1641 
1642   <span class="k">if</span> <span class="s">(</span><span class="i">$OtherIsMatrix</span><span class="s">)</span> <span class="s">{</span>
1643     <span class="c"># $OrderFlipped is set to false for two matrices...</span>
1644     <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1645       <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1646         <span class="i">$Matrix</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] = <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] + <span class="i">$Other</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>]<span class="sc">;</span>
1647       <span class="s">}</span>
1648     <span class="s">}</span>
1649   <span class="s">}</span>
1650   <span class="k">else</span> <span class="s">{</span>
1651     <span class="c"># Scalar addition...</span>
1652     <span class="k">if</span> <span class="s">(</span><span class="i">$OrderFlipped</span><span class="s">)</span> <span class="s">{</span>
1653       <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;${ErrorMsg}: First object must be a matrix...&quot;</span><span class="sc">;</span>
1654     <span class="s">}</span>
1655     <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1656       <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1657         <span class="i">$Matrix</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] = <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] + <span class="i">$Other</span><span class="sc">;</span>
1658       <span class="s">}</span>
1659     <span class="s">}</span>
1660   <span class="s">}</span>
1661   <span class="k">return</span> <span class="i">$Matrix</span><span class="sc">;</span>
1662 <span class="s">}</span>
1663 
1664 <span class="c">#</span>
1665 <span class="c"># Matrix subtraction operator supports two subtraction modes:</span>
1666 <span class="c">#   . Subtraction of two matrices by subtracting corresponding matrix values</span>
1667 <span class="c">#   . Subtraction of a scalar value from matrix values ($Matrix - 1)</span>
1668 <span class="c">#</span>
1669 <span class="c"># Caveats:</span>
1670 <span class="c">#   . Subtraction of a matrix from scalar is not allowed (1 - $Matrix)</span>
1671 <span class="c">#</span>
<a name="_MatrixSubtractionOperator-"></a>1672 <span class="k">sub </span><span class="m">_MatrixSubtractionOperator</span> <span class="s">{</span>
1673   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="cm">,</span> <span class="i">$ErrorMsg</span><span class="s">)</span><span class="sc">;</span>
1674 
1675   <span class="i">$ErrorMsg</span> = <span class="q">&quot;_MatrixSubtractionOperator: Matrix subtraction failed&quot;</span><span class="sc">;</span>
1676   <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="s">)</span> = <span class="i">_ProcessOverloadedOperatorParameters</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">@_</span><span class="s">)</span><span class="sc">;</span>
1677 
1678   <span class="k">my</span><span class="s">(</span><span class="i">$Matrix</span><span class="cm">,</span> <span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
1679 
1680   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1681   <span class="i">$Matrix</span> = <span class="i">new</span> <span class="i">Matrix</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span><span class="sc">;</span>
1682 
1683   <span class="k">if</span> <span class="s">(</span><span class="i">$OtherIsMatrix</span><span class="s">)</span> <span class="s">{</span>
1684     <span class="c"># $OrderFlipped is set to false for two matrices...</span>
1685     <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1686       <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1687         <span class="i">$Matrix</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] = <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] - <span class="i">$Other</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>]<span class="sc">;</span>
1688       <span class="s">}</span>
1689     <span class="s">}</span>
1690   <span class="s">}</span>
1691   <span class="k">else</span> <span class="s">{</span>
1692     <span class="c"># Scalar subtraction...</span>
1693     <span class="k">if</span> <span class="s">(</span><span class="i">$OrderFlipped</span><span class="s">)</span> <span class="s">{</span>
1694       <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;${ErrorMsg}: First object must be a matrix...&quot;</span><span class="sc">;</span>
1695     <span class="s">}</span>
1696     <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1697       <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1698         <span class="i">$Matrix</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] = <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] - <span class="i">$Other</span><span class="sc">;</span>
1699       <span class="s">}</span>
1700     <span class="s">}</span>
1701   <span class="s">}</span>
1702   <span class="k">return</span> <span class="i">$Matrix</span><span class="sc">;</span>
1703 <span class="s">}</span>
1704 
1705 <span class="c">#</span>
1706 <span class="c"># Matrix multiplication operator supports two multiplication modes:</span>
1707 <span class="c">#   . Multiplication of two matrices</span>
1708 <span class="c">#   . Multiplication of matrix values by a scalar ($Matrix * 1)</span>
1709 <span class="c">#</span>
1710 <span class="c"># Caveats:</span>
1711 <span class="c">#   . Multiplication of a scalar by a is not allowed (1 * $Matrix)</span>
1712 <span class="c">#</span>
<a name="_MatrixMultiplicationOperator-"></a>1713 <span class="k">sub </span><span class="m">_MatrixMultiplicationOperator</span> <span class="s">{</span>
1714   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="cm">,</span> <span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">$CheckSizes</span><span class="s">)</span><span class="sc">;</span>
1715 
1716   <span class="i">$ErrorMsg</span> = <span class="q">&quot;_MatrixMultiplicationOperator: Matrix multiplication failed&quot;</span><span class="sc">;</span>
1717   <span class="i">$CheckSizes</span> = <span class="n">0</span><span class="sc">;</span>
1718   <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="s">)</span> = <span class="i">_ProcessOverloadedOperatorParameters</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">@_</span><span class="cm">,</span> <span class="i">$CheckSizes</span><span class="s">)</span><span class="sc">;</span>
1719 
1720   <span class="k">my</span><span class="s">(</span><span class="i">$Matrix</span><span class="s">)</span><span class="sc">;</span>
1721 
1722   <span class="k">if</span> <span class="s">(</span><span class="i">$OtherIsMatrix</span><span class="s">)</span> <span class="s">{</span>
1723     <span class="c"># $OrderFlipped is set to false for two matrices...</span>
1724     <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows1</span><span class="cm">,</span> <span class="i">$NumOfCols1</span><span class="cm">,</span> <span class="i">$RowIndex1</span><span class="cm">,</span> <span class="i">$ColIndex1</span><span class="cm">,</span> <span class="i">$NumOfRows2</span><span class="cm">,</span> <span class="i">$NumOfCols2</span><span class="cm">,</span> <span class="i">$ColIndex2</span><span class="cm">,</span> <span class="i">$Value</span><span class="cm">,</span> <span class="i">$RowColIndex</span><span class="s">)</span><span class="sc">;</span>
1725 
1726     <span class="s">(</span><span class="i">$NumOfRows1</span><span class="cm">,</span> <span class="i">$NumOfCols1</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1727     <span class="s">(</span><span class="i">$NumOfRows2</span><span class="cm">,</span> <span class="i">$NumOfCols2</span><span class="s">)</span> = <span class="i">$Other</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1728 
1729     <span class="k">if</span> <span class="s">(</span><span class="i">$NumOfCols1</span> != <span class="i">$NumOfRows2</span><span class="s">)</span> <span class="s">{</span>
1730       <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;${ErrorMsg}: NumOfCols in first matrix of size $NumOfRows1 x $NumOfCols1 must be equal to NumOfRows in second matrix of size $NumOfRows2 x $NumOfCols2...&quot;</span><span class="sc">;</span>
1731     <span class="s">}</span>
1732 
1733     <span class="i">$Matrix</span> = <span class="i">new</span> <span class="i">Matrix</span><span class="s">(</span><span class="i">$NumOfRows1</span><span class="cm">,</span> <span class="i">$NumOfCols2</span><span class="s">)</span><span class="sc">;</span>
1734 
1735     <span class="k">for</span> <span class="i">$RowIndex1</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows1</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1736       <span class="k">for</span> <span class="i">$ColIndex2</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols2</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1737         <span class="i">$Value</span> = <span class="n">0</span><span class="sc">;</span>
1738         <span class="k">for</span> <span class="i">$RowColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols1</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1739           <span class="i">$Value</span> += <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex1</span>][<span class="i">$RowColIndex</span>] * <span class="i">$Other</span>-&gt;[<span class="i">$RowColIndex</span>][<span class="i">$ColIndex2</span>]<span class="sc">;</span>
1740         <span class="s">}</span>
1741         <span class="i">$Matrix</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex1</span>][<span class="i">$ColIndex2</span>] = <span class="i">$Value</span><span class="sc">;</span>
1742       <span class="s">}</span>
1743     <span class="s">}</span>
1744   <span class="s">}</span>
1745   <span class="k">else</span> <span class="s">{</span>
1746     <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
1747 
1748     <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1749     <span class="i">$Matrix</span> = <span class="i">new</span> <span class="i">Matrix</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span><span class="sc">;</span>
1750     <span class="c"># Scalar subtraction...</span>
1751     <span class="k">if</span> <span class="s">(</span><span class="i">$OrderFlipped</span><span class="s">)</span> <span class="s">{</span>
1752       <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;${ErrorMsg}: First object must be a matrix...&quot;</span><span class="sc">;</span>
1753     <span class="s">}</span>
1754     <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1755       <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1756         <span class="i">$Matrix</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] = <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] * <span class="i">$Other</span><span class="sc">;</span>
1757       <span class="s">}</span>
1758     <span class="s">}</span>
1759   <span class="s">}</span>
1760   <span class="k">return</span> <span class="i">$Matrix</span><span class="sc">;</span>
1761 <span class="s">}</span>
1762 
1763 <span class="c">#</span>
1764 <span class="c"># Matrix division operator supports two division modes:</span>
1765 <span class="c">#   . Division of two matrices by dividing corresponding matrix values</span>
1766 <span class="c">#   . Division matrix values  by a scalar($Matrix/2)</span>
1767 <span class="c">#</span>
1768 <span class="c"># Caveats:</span>
1769 <span class="c">#   . Division of scalar value by a matrix is not allowed (2/$Matrix)</span>
1770 <span class="c">#</span>
<a name="_MatrixDivisionOperator-"></a>1771 <span class="k">sub </span><span class="m">_MatrixDivisionOperator</span> <span class="s">{</span>
1772   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="cm">,</span> <span class="i">$ErrorMsg</span><span class="s">)</span><span class="sc">;</span>
1773 
1774   <span class="i">$ErrorMsg</span> = <span class="q">&quot;_MatrixDivisionOperator: Matrix division failed&quot;</span><span class="sc">;</span>
1775   <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="s">)</span> = <span class="i">_ProcessOverloadedOperatorParameters</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">@_</span><span class="s">)</span><span class="sc">;</span>
1776 
1777   <span class="k">my</span><span class="s">(</span><span class="i">$Matrix</span><span class="cm">,</span> <span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
1778 
1779   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1780   <span class="i">$Matrix</span> = <span class="i">new</span> <span class="i">Matrix</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span><span class="sc">;</span>
1781 
1782   <span class="k">if</span> <span class="s">(</span><span class="i">$OtherIsMatrix</span><span class="s">)</span> <span class="s">{</span>
1783     <span class="c"># $OrderFlipped is set to false for two matrices...</span>
1784     <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1785       <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1786         <span class="i">$Matrix</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] = <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] / <span class="i">$Other</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>]<span class="sc">;</span>
1787       <span class="s">}</span>
1788     <span class="s">}</span>
1789   <span class="s">}</span>
1790   <span class="k">else</span> <span class="s">{</span>
1791     <span class="c"># Scalar subtraction...</span>
1792     <span class="k">if</span> <span class="s">(</span><span class="i">$OrderFlipped</span><span class="s">)</span> <span class="s">{</span>
1793       <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;${ErrorMsg}: First object must be a matrix...&quot;</span><span class="sc">;</span>
1794     <span class="s">}</span>
1795     <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1796       <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1797         <span class="i">$Matrix</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] = <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] / <span class="i">$Other</span><span class="sc">;</span>
1798       <span class="s">}</span>
1799     <span class="s">}</span>
1800   <span class="s">}</span>
1801   <span class="k">return</span> <span class="i">$Matrix</span><span class="sc">;</span>
1802 <span class="s">}</span>
1803 
1804 <span class="c">#</span>
1805 <span class="c"># Matrix exponentiation operator supports two division modes:</span>
1806 <span class="c">#   . Exponent of two matrices by exponentiation of corresponding matrix values</span>
1807 <span class="c">#   . Exponentiation matrix values  by a scalar ($Matrix ** 2)</span>
1808 <span class="c">#</span>
1809 <span class="c"># Caveats:</span>
1810 <span class="c">#   . Exponentiation of scalar value by a matrix is not allowed (2 ** $Matrix)</span>
1811 <span class="c">#</span>
<a name="_MatrixExponentiationOperator-"></a>1812 <span class="k">sub </span><span class="m">_MatrixExponentiationOperator</span> <span class="s">{</span>
1813   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="cm">,</span> <span class="i">$ErrorMsg</span><span class="s">)</span><span class="sc">;</span>
1814 
1815   <span class="i">$ErrorMsg</span> = <span class="q">&quot;_MatrixExponentiationOperator: Matrix exponentiation failed&quot;</span><span class="sc">;</span>
1816   <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="s">)</span> = <span class="i">_ProcessOverloadedOperatorParameters</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">@_</span><span class="s">)</span><span class="sc">;</span>
1817 
1818   <span class="k">my</span><span class="s">(</span><span class="i">$Matrix</span><span class="cm">,</span> <span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
1819 
1820   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1821   <span class="i">$Matrix</span> = <span class="i">new</span> <span class="i">Matrix</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span><span class="sc">;</span>
1822 
1823   <span class="k">if</span> <span class="s">(</span><span class="i">$OtherIsMatrix</span><span class="s">)</span> <span class="s">{</span>
1824     <span class="c"># $OrderFlipped is set to false for two matrices...</span>
1825     <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1826       <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1827         <span class="i">$Matrix</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] = <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] ** <span class="i">$Other</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>]<span class="sc">;</span>
1828       <span class="s">}</span>
1829     <span class="s">}</span>
1830   <span class="s">}</span>
1831   <span class="k">else</span> <span class="s">{</span>
1832     <span class="c"># Scalar subtraction...</span>
1833     <span class="k">if</span> <span class="s">(</span><span class="i">$OrderFlipped</span><span class="s">)</span> <span class="s">{</span>
1834       <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;${ErrorMsg}: First object must be a matrix...&quot;</span><span class="sc">;</span>
1835     <span class="s">}</span>
1836     <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1837       <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1838         <span class="i">$Matrix</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] = <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] ** <span class="i">$Other</span><span class="sc">;</span>
1839       <span class="s">}</span>
1840     <span class="s">}</span>
1841   <span class="s">}</span>
1842   <span class="k">return</span> <span class="i">$Matrix</span><span class="sc">;</span>
1843 <span class="s">}</span>
1844 
1845 <span class="c">#</span>
1846 <span class="c"># Matrix modulus operator supports two division modes:</span>
1847 <span class="c">#   . Modulus of two matrices by taking modulus between corresponding matrix values</span>
1848 <span class="c">#   . Modulus of matrix values  by a scalar ($Matrix % 2)</span>
1849 <span class="c">#</span>
1850 <span class="c"># Caveats:</span>
1851 <span class="c">#   . Modulus of scalar value by a matrix is not allowed (2 % $Matrix)</span>
1852 <span class="c">#</span>
<a name="_MatrixModulusOperator-"></a>1853 <span class="k">sub </span><span class="m">_MatrixModulusOperator</span> <span class="s">{</span>
1854   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="cm">,</span> <span class="i">$ErrorMsg</span><span class="s">)</span><span class="sc">;</span>
1855 
1856   <span class="i">$ErrorMsg</span> = <span class="q">&quot;_MatrixModulusOperator: Matrix modulus failed&quot;</span><span class="sc">;</span>
1857   <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="s">)</span> = <span class="i">_ProcessOverloadedOperatorParameters</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">@_</span><span class="s">)</span><span class="sc">;</span>
1858 
1859   <span class="k">my</span><span class="s">(</span><span class="i">$Matrix</span><span class="cm">,</span> <span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
1860 
1861   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1862   <span class="i">$Matrix</span> = <span class="i">new</span> <span class="i">Matrix</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span><span class="sc">;</span>
1863 
1864   <span class="k">if</span> <span class="s">(</span><span class="i">$OtherIsMatrix</span><span class="s">)</span> <span class="s">{</span>
1865     <span class="c"># $OrderFlipped is set to false for two matrices...</span>
1866     <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1867       <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1868         <span class="i">$Matrix</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] = <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] % <span class="i">$Other</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>]<span class="sc">;</span>
1869       <span class="s">}</span>
1870     <span class="s">}</span>
1871   <span class="s">}</span>
1872   <span class="k">else</span> <span class="s">{</span>
1873     <span class="c"># Scalar subtraction...</span>
1874     <span class="k">if</span> <span class="s">(</span><span class="i">$OrderFlipped</span><span class="s">)</span> <span class="s">{</span>
1875       <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;${ErrorMsg}: First object must be a matrix...&quot;</span><span class="sc">;</span>
1876     <span class="s">}</span>
1877     <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1878       <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1879         <span class="i">$Matrix</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] = <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] % <span class="i">$Other</span><span class="sc">;</span>
1880       <span class="s">}</span>
1881     <span class="s">}</span>
1882   <span class="s">}</span>
1883   <span class="k">return</span> <span class="i">$Matrix</span><span class="sc">;</span>
1884 <span class="s">}</span>
1885 
1886 <span class="c">#</span>
1887 <span class="c"># Matrix booelan operator checks whether a matrix contains at least one non-zero</span>
1888 <span class="c"># value...</span>
1889 <span class="c">#</span>
<a name="_MatrixBooleanOperator-"></a>1890 <span class="k">sub </span><span class="m">_MatrixBooleanOperator</span> <span class="s">{</span>
1891   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="cm">,</span> <span class="i">$ErrorMsg</span><span class="s">)</span><span class="sc">;</span>
1892 
1893   <span class="i">$ErrorMsg</span> = <span class="q">&quot;_MatrixBooleanOperator: Matrix boolean operation failed&quot;</span><span class="sc">;</span>
1894   <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="s">)</span> = <span class="i">_ProcessOverloadedOperatorParameters</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">@_</span><span class="s">)</span><span class="sc">;</span>
1895 
1896   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
1897 
1898   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1899   <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1900     <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1901       <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] != <span class="n">0.0</span><span class="s">)</span> <span class="s">{</span>
1902         <span class="k">return</span> <span class="n">1</span><span class="sc">;</span>
1903       <span class="s">}</span>
1904     <span class="s">}</span>
1905   <span class="s">}</span>
1906   <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1907 <span class="s">}</span>
1908 
1909 <span class="c">#</span>
1910 <span class="c"># Matrix not booelan operator checks whether a matrix contains only zero values...</span>
1911 <span class="c"># value...</span>
1912 <span class="c">#</span>
<a name="_MatrixNotBooleanOperator-"></a>1913 <span class="k">sub </span><span class="m">_MatrixNotBooleanOperator</span> <span class="s">{</span>
1914   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="cm">,</span> <span class="i">$ErrorMsg</span><span class="s">)</span><span class="sc">;</span>
1915 
1916   <span class="i">$ErrorMsg</span> = <span class="q">&quot;_MatrixNotBooleanOperator: Matrix not boolean operation failed&quot;</span><span class="sc">;</span>
1917   <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="s">)</span> = <span class="i">_ProcessOverloadedOperatorParameters</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">@_</span><span class="s">)</span><span class="sc">;</span>
1918 
1919   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
1920 
1921   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1922   <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1923     <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1924       <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] != <span class="n">0.0</span><span class="s">)</span> <span class="s">{</span>
1925         <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1926       <span class="s">}</span>
1927     <span class="s">}</span>
1928   <span class="s">}</span>
1929   <span class="k">return</span> <span class="n">1</span><span class="sc">;</span>
1930 <span class="s">}</span>
1931 
1932 <span class="c">#</span>
1933 <span class="c"># Matrix equal operator supports two modes:</span>
1934 <span class="c">#   . Comparison of corresponding values in two matrices</span>
1935 <span class="c">#   . Comparing matrix values to a scalar ($Matrix == 2)</span>
1936 <span class="c">#</span>
1937 <span class="c"># Caveats:</span>
1938 <span class="c">#   . Comparison of a scalar to matrix values is not allowed (2 == $Matrix)</span>
1939 <span class="c">#</span>
<a name="_MatrixEqualOperator-"></a>1940 <span class="k">sub </span><span class="m">_MatrixEqualOperator</span> <span class="s">{</span>
1941   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="cm">,</span> <span class="i">$CheckMatrixSizes</span><span class="cm">,</span> <span class="i">$ErrorMsg</span><span class="s">)</span><span class="sc">;</span>
1942 
1943   <span class="i">$ErrorMsg</span> = <span class="q">&quot;_MatrixEqualOperator: Matrix equal failed&quot;</span><span class="sc">;</span>
1944   <span class="i">$CheckMatrixSizes</span> = <span class="n">0</span><span class="sc">;</span>
1945   <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="s">)</span> = <span class="i">_ProcessOverloadedOperatorParameters</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">@_</span><span class="cm">,</span> <span class="i">$CheckMatrixSizes</span><span class="s">)</span><span class="sc">;</span>
1946 
1947   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
1948 
1949   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1950 
1951   <span class="k">if</span> <span class="s">(</span><span class="i">$OtherIsMatrix</span><span class="s">)</span> <span class="s">{</span>
1952     <span class="c"># $OrderFlipped is set to false for two matrices...</span>
1953     <span class="k">my</span><span class="s">(</span><span class="i">$OtherNumOfRows</span><span class="cm">,</span> <span class="i">$OtherNumOfCols</span><span class="s">)</span><span class="sc">;</span>
1954 
1955     <span class="c"># Check sizes...</span>
1956     <span class="s">(</span><span class="i">$OtherNumOfRows</span><span class="cm">,</span> <span class="i">$OtherNumOfCols</span><span class="s">)</span> = <span class="i">$Other</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1957     <span class="k">if</span> <span class="s">(</span>!<span class="s">(</span><span class="i">$NumOfRows</span> == <span class="i">$OtherNumOfRows</span> &amp;&amp; <span class="i">$NumOfCols</span> == <span class="i">$OtherNumOfCols</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1958       <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1959     <span class="s">}</span>
1960 
1961     <span class="c"># Check values...</span>
1962     <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1963       <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1964         <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] != <span class="i">$Other</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>]<span class="s">)</span> <span class="s">{</span>
1965           <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1966         <span class="s">}</span>
1967       <span class="s">}</span>
1968     <span class="s">}</span>
1969   <span class="s">}</span>
1970   <span class="k">else</span> <span class="s">{</span>
1971     <span class="c"># Scalar comparison...</span>
1972     <span class="k">if</span> <span class="s">(</span><span class="i">$OrderFlipped</span><span class="s">)</span> <span class="s">{</span>
1973       <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;${ErrorMsg}: First object must be a matrix...&quot;</span><span class="sc">;</span>
1974     <span class="s">}</span>
1975     <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1976       <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1977         <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] != <span class="i">$Other</span><span class="s">)</span> <span class="s">{</span>
1978           <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1979         <span class="s">}</span>
1980       <span class="s">}</span>
1981     <span class="s">}</span>
1982   <span class="s">}</span>
1983   <span class="k">return</span> <span class="n">1</span><span class="sc">;</span>
1984 <span class="s">}</span>
1985 
1986 <span class="c">#</span>
1987 <span class="c"># Matrix not equal operator supports two modes:</span>
1988 <span class="c">#   . Comparison of corresponding values in two matrices</span>
1989 <span class="c">#   . Comparing matrix values to a scalar ($Matrix != 2)</span>
1990 <span class="c">#</span>
1991 <span class="c"># Caveats:</span>
1992 <span class="c">#   . Comparison of a scalar to matrix values is not allowed (2 != $Matrix)</span>
1993 <span class="c">#</span>
<a name="_MatrixNotEqualOperator-"></a>1994 <span class="k">sub </span><span class="m">_MatrixNotEqualOperator</span> <span class="s">{</span>
1995   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="cm">,</span> <span class="i">$CheckMatrixSizes</span><span class="cm">,</span> <span class="i">$ErrorMsg</span><span class="s">)</span><span class="sc">;</span>
1996 
1997   <span class="i">$ErrorMsg</span> = <span class="q">&quot;_MatrixNotEqualOperator: Matrix not equal failed&quot;</span><span class="sc">;</span>
1998   <span class="i">$CheckMatrixSizes</span> = <span class="n">0</span><span class="sc">;</span>
1999   <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="s">)</span> = <span class="i">_ProcessOverloadedOperatorParameters</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">@_</span><span class="cm">,</span> <span class="i">$CheckMatrixSizes</span><span class="s">)</span><span class="sc">;</span>
2000 
2001   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
2002 
2003   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
2004 
2005   <span class="k">if</span> <span class="s">(</span><span class="i">$OtherIsMatrix</span><span class="s">)</span> <span class="s">{</span>
2006     <span class="c"># $OrderFlipped is set to false for two matrices...</span>
2007     <span class="k">my</span><span class="s">(</span><span class="i">$OtherNumOfRows</span><span class="cm">,</span> <span class="i">$OtherNumOfCols</span><span class="s">)</span><span class="sc">;</span>
2008 
2009     <span class="c"># Check sizes...</span>
2010     <span class="s">(</span><span class="i">$OtherNumOfRows</span><span class="cm">,</span> <span class="i">$OtherNumOfCols</span><span class="s">)</span> = <span class="i">$Other</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
2011     <span class="k">if</span> <span class="s">(</span>!<span class="s">(</span><span class="i">$NumOfRows</span> == <span class="i">$OtherNumOfRows</span> &amp;&amp; <span class="i">$NumOfCols</span> == <span class="i">$OtherNumOfCols</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2012       <span class="k">return</span> <span class="n">1</span><span class="sc">;</span>
2013     <span class="s">}</span>
2014 
2015     <span class="c"># Check values...</span>
2016     <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2017       <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2018         <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] == <span class="i">$Other</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>]<span class="s">)</span> <span class="s">{</span>
2019           <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
2020         <span class="s">}</span>
2021       <span class="s">}</span>
2022     <span class="s">}</span>
2023   <span class="s">}</span>
2024   <span class="k">else</span> <span class="s">{</span>
2025     <span class="c"># Scalar comparison...</span>
2026     <span class="k">if</span> <span class="s">(</span><span class="i">$OrderFlipped</span><span class="s">)</span> <span class="s">{</span>
2027       <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;${ErrorMsg}: First object must be a matrix...&quot;</span><span class="sc">;</span>
2028     <span class="s">}</span>
2029     <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2030       <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2031         <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] == <span class="i">$Other</span><span class="s">)</span> <span class="s">{</span>
2032           <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
2033         <span class="s">}</span>
2034       <span class="s">}</span>
2035     <span class="s">}</span>
2036   <span class="s">}</span>
2037   <span class="k">return</span> <span class="n">1</span><span class="sc">;</span>
2038 <span class="s">}</span>
2039 
2040 <span class="c">#</span>
2041 <span class="c"># Matrix less than operator supports two modes:</span>
2042 <span class="c">#   . Comparison of corresponding values in two matrices</span>
2043 <span class="c">#   . Comparing matrix values to a scalar ($Matrix &lt; 2)</span>
2044 <span class="c">#</span>
2045 <span class="c"># Caveats:</span>
2046 <span class="c">#   . Comparison of a scalar to matrix values is not allowed (2 &lt; $Matrix)</span>
2047 <span class="c">#</span>
<a name="_MatrixLessThanOperator-"></a>2048 <span class="k">sub </span><span class="m">_MatrixLessThanOperator</span> <span class="s">{</span>
2049   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="cm">,</span> <span class="i">$CheckMatrixSizes</span><span class="cm">,</span> <span class="i">$ErrorMsg</span><span class="s">)</span><span class="sc">;</span>
2050 
2051   <span class="i">$ErrorMsg</span> = <span class="q">&quot;_MatrixLessThanOperator: Matrix less than failed&quot;</span><span class="sc">;</span>
2052   <span class="i">$CheckMatrixSizes</span> = <span class="n">0</span><span class="sc">;</span>
2053   <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="s">)</span> = <span class="i">_ProcessOverloadedOperatorParameters</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">@_</span><span class="cm">,</span> <span class="i">$CheckMatrixSizes</span><span class="s">)</span><span class="sc">;</span>
2054 
2055   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
2056 
2057   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
2058 
2059   <span class="k">if</span> <span class="s">(</span><span class="i">$OtherIsMatrix</span><span class="s">)</span> <span class="s">{</span>
2060     <span class="c"># $OrderFlipped is set to false for two matrices...</span>
2061     <span class="k">my</span><span class="s">(</span><span class="i">$OtherNumOfRows</span><span class="cm">,</span> <span class="i">$OtherNumOfCols</span><span class="s">)</span><span class="sc">;</span>
2062 
2063     <span class="c"># Check sizes...</span>
2064     <span class="s">(</span><span class="i">$OtherNumOfRows</span><span class="cm">,</span> <span class="i">$OtherNumOfCols</span><span class="s">)</span> = <span class="i">$Other</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
2065     <span class="k">if</span> <span class="s">(</span>!<span class="s">(</span><span class="i">$NumOfRows</span> == <span class="i">$OtherNumOfRows</span> &amp;&amp; <span class="i">$NumOfCols</span> == <span class="i">$OtherNumOfCols</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2066       <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
2067     <span class="s">}</span>
2068 
2069     <span class="c"># Check values...</span>
2070     <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2071       <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2072         <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] &gt;= <span class="i">$Other</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>]<span class="s">)</span> <span class="s">{</span>
2073           <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
2074         <span class="s">}</span>
2075       <span class="s">}</span>
2076     <span class="s">}</span>
2077   <span class="s">}</span>
2078   <span class="k">else</span> <span class="s">{</span>
2079     <span class="c"># Scalar comparison...</span>
2080     <span class="k">if</span> <span class="s">(</span><span class="i">$OrderFlipped</span><span class="s">)</span> <span class="s">{</span>
2081       <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;${ErrorMsg}: First object must be a matrix...&quot;</span><span class="sc">;</span>
2082     <span class="s">}</span>
2083     <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2084       <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2085         <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] &gt;= <span class="i">$Other</span><span class="s">)</span> <span class="s">{</span>
2086           <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
2087         <span class="s">}</span>
2088       <span class="s">}</span>
2089     <span class="s">}</span>
2090   <span class="s">}</span>
2091   <span class="k">return</span> <span class="n">1</span><span class="sc">;</span>
2092 <span class="s">}</span>
2093 
2094 <span class="c">#</span>
2095 <span class="c"># Matrix less than equal operator supports two modes:</span>
2096 <span class="c">#   . Comparion of corresponding values in two matrices</span>
2097 <span class="c">#   . Comparing matrix values to a scalar ($Matrix &lt;= 2)</span>
2098 <span class="c">#</span>
2099 <span class="c"># Caveats:</span>
2100 <span class="c">#   . Comparison of a scalar to matrix values is not allowed (2 &lt;= $Matrix)</span>
2101 <span class="c">#</span>
<a name="_MatrixLessThanEqualOperator-"></a>2102 <span class="k">sub </span><span class="m">_MatrixLessThanEqualOperator</span> <span class="s">{</span>
2103   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="cm">,</span> <span class="i">$CheckMatrixSizes</span><span class="cm">,</span> <span class="i">$ErrorMsg</span><span class="s">)</span><span class="sc">;</span>
2104 
2105   <span class="i">$ErrorMsg</span> = <span class="q">&quot;_MatrixLessThanEqualOperator: Matrix less than equal failed&quot;</span><span class="sc">;</span>
2106   <span class="i">$CheckMatrixSizes</span> = <span class="n">0</span><span class="sc">;</span>
2107   <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="s">)</span> = <span class="i">_ProcessOverloadedOperatorParameters</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">@_</span><span class="cm">,</span> <span class="i">$CheckMatrixSizes</span><span class="s">)</span><span class="sc">;</span>
2108 
2109   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
2110 
2111   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
2112 
2113   <span class="k">if</span> <span class="s">(</span><span class="i">$OtherIsMatrix</span><span class="s">)</span> <span class="s">{</span>
2114     <span class="c"># $OrderFlipped is set to false for two matrices...</span>
2115     <span class="k">my</span><span class="s">(</span><span class="i">$OtherNumOfRows</span><span class="cm">,</span> <span class="i">$OtherNumOfCols</span><span class="s">)</span><span class="sc">;</span>
2116 
2117     <span class="c"># Check sizes...</span>
2118     <span class="s">(</span><span class="i">$OtherNumOfRows</span><span class="cm">,</span> <span class="i">$OtherNumOfCols</span><span class="s">)</span> = <span class="i">$Other</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
2119     <span class="k">if</span> <span class="s">(</span>!<span class="s">(</span><span class="i">$NumOfRows</span> == <span class="i">$OtherNumOfRows</span> &amp;&amp; <span class="i">$NumOfCols</span> == <span class="i">$OtherNumOfCols</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2120       <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
2121     <span class="s">}</span>
2122 
2123     <span class="c"># Check values...</span>
2124     <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2125       <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2126         <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] &gt; <span class="i">$Other</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>]<span class="s">)</span> <span class="s">{</span>
2127           <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
2128         <span class="s">}</span>
2129       <span class="s">}</span>
2130     <span class="s">}</span>
2131   <span class="s">}</span>
2132   <span class="k">else</span> <span class="s">{</span>
2133     <span class="c"># Scalar comparison...</span>
2134     <span class="k">if</span> <span class="s">(</span><span class="i">$OrderFlipped</span><span class="s">)</span> <span class="s">{</span>
2135       <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;${ErrorMsg}: First object must be a matrix...&quot;</span><span class="sc">;</span>
2136     <span class="s">}</span>
2137     <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2138       <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2139         <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] &gt; <span class="i">$Other</span><span class="s">)</span> <span class="s">{</span>
2140           <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
2141         <span class="s">}</span>
2142       <span class="s">}</span>
2143     <span class="s">}</span>
2144   <span class="s">}</span>
2145   <span class="k">return</span> <span class="n">1</span><span class="sc">;</span>
2146 <span class="s">}</span>
2147 
2148 <span class="c">#</span>
2149 <span class="c"># Matrix greatar than operator supports two modes:</span>
2150 <span class="c">#   . Comparison of corresponding values in two matrices</span>
2151 <span class="c">#   . Comparing matrix values to a scalar ($Matrix &gt; 2)</span>
2152 <span class="c">#</span>
2153 <span class="c"># Caveats:</span>
2154 <span class="c">#   . Comparison of a scalar to matrix values is not allowed (2 &gt; $Matrix)</span>
2155 <span class="c">#</span>
<a name="_MatrixGreatarThanOperator-"></a>2156 <span class="k">sub </span><span class="m">_MatrixGreatarThanOperator</span> <span class="s">{</span>
2157   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="cm">,</span> <span class="i">$CheckMatrixSizes</span><span class="cm">,</span> <span class="i">$ErrorMsg</span><span class="s">)</span><span class="sc">;</span>
2158 
2159   <span class="i">$ErrorMsg</span> = <span class="q">&quot;_MatrixGreatarThanOperator: Matrix greatar than failed&quot;</span><span class="sc">;</span>
2160   <span class="i">$CheckMatrixSizes</span> = <span class="n">0</span><span class="sc">;</span>
2161   <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="s">)</span> = <span class="i">_ProcessOverloadedOperatorParameters</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">@_</span><span class="cm">,</span> <span class="i">$CheckMatrixSizes</span><span class="s">)</span><span class="sc">;</span>
2162 
2163   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
2164 
2165   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
2166 
2167   <span class="k">if</span> <span class="s">(</span><span class="i">$OtherIsMatrix</span><span class="s">)</span> <span class="s">{</span>
2168     <span class="c"># $OrderFlipped is set to false for two matrices...</span>
2169     <span class="k">my</span><span class="s">(</span><span class="i">$OtherNumOfRows</span><span class="cm">,</span> <span class="i">$OtherNumOfCols</span><span class="s">)</span><span class="sc">;</span>
2170 
2171     <span class="c"># Check sizes...</span>
2172     <span class="s">(</span><span class="i">$OtherNumOfRows</span><span class="cm">,</span> <span class="i">$OtherNumOfCols</span><span class="s">)</span> = <span class="i">$Other</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
2173     <span class="k">if</span> <span class="s">(</span>!<span class="s">(</span><span class="i">$NumOfRows</span> == <span class="i">$OtherNumOfRows</span> &amp;&amp; <span class="i">$NumOfCols</span> == <span class="i">$OtherNumOfCols</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2174       <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
2175     <span class="s">}</span>
2176 
2177     <span class="c"># Check values...</span>
2178     <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2179       <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2180         <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] &lt;= <span class="i">$Other</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>]<span class="s">)</span> <span class="s">{</span>
2181           <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
2182         <span class="s">}</span>
2183       <span class="s">}</span>
2184     <span class="s">}</span>
2185   <span class="s">}</span>
2186   <span class="k">else</span> <span class="s">{</span>
2187     <span class="c"># Scalar comparison...</span>
2188     <span class="k">if</span> <span class="s">(</span><span class="i">$OrderFlipped</span><span class="s">)</span> <span class="s">{</span>
2189       <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;${ErrorMsg}: First object must be a matrix...&quot;</span><span class="sc">;</span>
2190     <span class="s">}</span>
2191     <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2192       <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2193         <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] &lt;= <span class="i">$Other</span><span class="s">)</span> <span class="s">{</span>
2194           <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
2195         <span class="s">}</span>
2196       <span class="s">}</span>
2197     <span class="s">}</span>
2198   <span class="s">}</span>
2199   <span class="k">return</span> <span class="n">1</span><span class="sc">;</span>
2200 <span class="s">}</span>
2201 
2202 <span class="c">#</span>
2203 <span class="c"># Matrix greatar than equal operator supports two modes:</span>
2204 <span class="c">#   . Comparison of corresponding values in two matrices</span>
2205 <span class="c">#   . Comparing matrix values to a scalar ($Matrix &gt;= 2)</span>
2206 <span class="c">#</span>
2207 <span class="c"># Caveats:</span>
2208 <span class="c">#   . Comparison of a scalar to matrix values is not allowed (2 &gt;= $Matrix)</span>
2209 <span class="c">#</span>
<a name="_MatrixGreatarThanEqualOperator-"></a>2210 <span class="k">sub </span><span class="m">_MatrixGreatarThanEqualOperator</span> <span class="s">{</span>
2211   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="cm">,</span> <span class="i">$CheckMatrixSizes</span><span class="cm">,</span> <span class="i">$ErrorMsg</span><span class="s">)</span><span class="sc">;</span>
2212 
2213   <span class="i">$ErrorMsg</span> = <span class="q">&quot;_MatrixGreatarThanEqualOperator: Matrix greatar than equal failed&quot;</span><span class="sc">;</span>
2214   <span class="i">$CheckMatrixSizes</span> = <span class="n">0</span><span class="sc">;</span>
2215   <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="s">)</span> = <span class="i">_ProcessOverloadedOperatorParameters</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">@_</span><span class="cm">,</span> <span class="i">$CheckMatrixSizes</span><span class="s">)</span><span class="sc">;</span>
2216 
2217   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
2218 
2219   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
2220 
2221   <span class="k">if</span> <span class="s">(</span><span class="i">$OtherIsMatrix</span><span class="s">)</span> <span class="s">{</span>
2222     <span class="c"># $OrderFlipped is set to false for two matrices...</span>
2223     <span class="k">my</span><span class="s">(</span><span class="i">$OtherNumOfRows</span><span class="cm">,</span> <span class="i">$OtherNumOfCols</span><span class="s">)</span><span class="sc">;</span>
2224 
2225     <span class="c"># Check sizes...</span>
2226     <span class="s">(</span><span class="i">$OtherNumOfRows</span><span class="cm">,</span> <span class="i">$OtherNumOfCols</span><span class="s">)</span> = <span class="i">$Other</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
2227     <span class="k">if</span> <span class="s">(</span>!<span class="s">(</span><span class="i">$NumOfRows</span> == <span class="i">$OtherNumOfRows</span> &amp;&amp; <span class="i">$NumOfCols</span> == <span class="i">$OtherNumOfCols</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2228       <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
2229     <span class="s">}</span>
2230 
2231     <span class="c"># Check values...</span>
2232     <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2233       <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2234         <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] &lt; <span class="i">$Other</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>]<span class="s">)</span> <span class="s">{</span>
2235           <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
2236         <span class="s">}</span>
2237       <span class="s">}</span>
2238     <span class="s">}</span>
2239   <span class="s">}</span>
2240   <span class="k">else</span> <span class="s">{</span>
2241     <span class="c"># Scalar comparison...</span>
2242     <span class="k">if</span> <span class="s">(</span><span class="i">$OrderFlipped</span><span class="s">)</span> <span class="s">{</span>
2243       <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;${ErrorMsg}: First object must be a matrix...&quot;</span><span class="sc">;</span>
2244     <span class="s">}</span>
2245     <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2246       <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2247         <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] &lt; <span class="i">$Other</span><span class="s">)</span> <span class="s">{</span>
2248           <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
2249         <span class="s">}</span>
2250       <span class="s">}</span>
2251     <span class="s">}</span>
2252   <span class="s">}</span>
2253   <span class="k">return</span> <span class="n">1</span><span class="sc">;</span>
2254 <span class="s">}</span>
2255 
2256 <span class="c">#</span>
2257 <span class="c"># Matrix negative value operator returns a matrix with values corresponding to</span>
2258 <span class="c"># negative values of a matrix</span>
2259 <span class="c">#</span>
<a name="_MatrixNegativeValueOperator-"></a>2260 <span class="k">sub </span><span class="m">_MatrixNegativeValueOperator</span> <span class="s">{</span>
2261   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="cm">,</span> <span class="i">$ErrorMsg</span><span class="s">)</span><span class="sc">;</span>
2262 
2263   <span class="i">$ErrorMsg</span> = <span class="q">&quot;_MatrixNegativeValueOperator: Matrix negative value operation failed&quot;</span><span class="sc">;</span>
2264   <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="s">)</span> = <span class="i">_ProcessOverloadedOperatorParameters</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">@_</span><span class="s">)</span><span class="sc">;</span>
2265 
2266   <span class="k">my</span><span class="s">(</span><span class="i">$Matrix</span><span class="cm">,</span> <span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
2267 
2268   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
2269   <span class="i">$Matrix</span> = <span class="i">new</span> <span class="i">Matrix</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span><span class="sc">;</span>
2270 
2271   <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2272     <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2273       <span class="i">$Matrix</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] = - <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>]<span class="sc">;</span>
2274     <span class="s">}</span>
2275   <span class="s">}</span>
2276   <span class="k">return</span> <span class="i">$Matrix</span><span class="sc">;</span>
2277 <span class="s">}</span>
2278 
2279 <span class="c">#</span>
2280 <span class="c"># Matrix absolute value operator returns a matrix with values corresponding to</span>
2281 <span class="c"># absolute values of a matrix</span>
2282 <span class="c">#</span>
<a name="_MatrixAbsoluteValueOperator-"></a>2283 <span class="k">sub </span><span class="m">_MatrixAbsoluteValueOperator</span> <span class="s">{</span>
2284   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="cm">,</span> <span class="i">$ErrorMsg</span><span class="s">)</span><span class="sc">;</span>
2285 
2286   <span class="i">$ErrorMsg</span> = <span class="q">&quot;_MatrixAbsoluteValueOperator: Matrix absolute value operation failed&quot;</span><span class="sc">;</span>
2287   <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="s">)</span> = <span class="i">_ProcessOverloadedOperatorParameters</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">@_</span><span class="s">)</span><span class="sc">;</span>
2288 
2289   <span class="k">my</span><span class="s">(</span><span class="i">$Matrix</span><span class="cm">,</span> <span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
2290 
2291   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
2292   <span class="i">$Matrix</span> = <span class="i">new</span> <span class="i">Matrix</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span><span class="sc">;</span>
2293 
2294   <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2295     <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2296       <span class="i">$Matrix</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] = <span class="k">abs</span> <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>]<span class="sc">;</span>
2297     <span class="s">}</span>
2298   <span class="s">}</span>
2299   <span class="k">return</span> <span class="i">$Matrix</span><span class="sc">;</span>
2300 <span class="s">}</span>
2301 
2302 <span class="c">#</span>
2303 <span class="c"># Matrix exp natural base operator returns a matrix with values corresponding to</span>
2304 <span class="c"># e raised to the power of values in a matrix</span>
2305 <span class="c">#</span>
<a name="_MatrixExpNaturalBaseOperator-"></a>2306 <span class="k">sub </span><span class="m">_MatrixExpNaturalBaseOperator</span> <span class="s">{</span>
2307   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="cm">,</span> <span class="i">$ErrorMsg</span><span class="s">)</span><span class="sc">;</span>
2308 
2309   <span class="i">$ErrorMsg</span> = <span class="q">&quot;_MatrixExpNaturalBaseOperator: Matrix exp operation failed&quot;</span><span class="sc">;</span>
2310   <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="s">)</span> = <span class="i">_ProcessOverloadedOperatorParameters</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">@_</span><span class="s">)</span><span class="sc">;</span>
2311 
2312   <span class="k">my</span><span class="s">(</span><span class="i">$Matrix</span><span class="cm">,</span> <span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
2313 
2314   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
2315   <span class="i">$Matrix</span> = <span class="i">new</span> <span class="i">Matrix</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span><span class="sc">;</span>
2316 
2317   <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2318     <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2319       <span class="i">$Matrix</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] = <span class="k">exp</span> <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>]<span class="sc">;</span>
2320     <span class="s">}</span>
2321   <span class="s">}</span>
2322   <span class="k">return</span> <span class="i">$Matrix</span><span class="sc">;</span>
2323 <span class="s">}</span>
2324 
2325 <span class="c">#</span>
2326 <span class="c"># Matrix log natural base operator returns a matrix with values corresponding to</span>
2327 <span class="c"># log of values in a matrix</span>
2328 <span class="c">#</span>
<a name="_MatrixLogNaturalBaseOperator-"></a>2329 <span class="k">sub </span><span class="m">_MatrixLogNaturalBaseOperator</span> <span class="s">{</span>
2330   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="cm">,</span> <span class="i">$ErrorMsg</span><span class="s">)</span><span class="sc">;</span>
2331 
2332   <span class="i">$ErrorMsg</span> = <span class="q">&quot;_MatrixLogNaturalBaseOperator: Matrix log operation failed&quot;</span><span class="sc">;</span>
2333   <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="s">)</span> = <span class="i">_ProcessOverloadedOperatorParameters</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">@_</span><span class="s">)</span><span class="sc">;</span>
2334 
2335   <span class="k">my</span><span class="s">(</span><span class="i">$Matrix</span><span class="cm">,</span> <span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
2336 
2337   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
2338   <span class="i">$Matrix</span> = <span class="i">new</span> <span class="i">Matrix</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span><span class="sc">;</span>
2339 
2340   <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2341     <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2342       <span class="i">$Matrix</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] = <span class="k">log</span> <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>]<span class="sc">;</span>
2343     <span class="s">}</span>
2344   <span class="s">}</span>
2345   <span class="k">return</span> <span class="i">$Matrix</span><span class="sc">;</span>
2346 <span class="s">}</span>
2347 
2348 <span class="c">#</span>
2349 <span class="c"># Matrix square root operator returns a matrix with values corresponding to</span>
2350 <span class="c"># sqrt of values in a matrix</span>
2351 <span class="c">#</span>
<a name="_MatrixSquareRootOperator-"></a>2352 <span class="k">sub </span><span class="m">_MatrixSquareRootOperator</span> <span class="s">{</span>
2353   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="cm">,</span> <span class="i">$ErrorMsg</span><span class="s">)</span><span class="sc">;</span>
2354 
2355   <span class="i">$ErrorMsg</span> = <span class="q">&quot;_MatrixSquareRootOperator: Matrix sqrt operation failed&quot;</span><span class="sc">;</span>
2356   <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="s">)</span> = <span class="i">_ProcessOverloadedOperatorParameters</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">@_</span><span class="s">)</span><span class="sc">;</span>
2357 
2358   <span class="k">my</span><span class="s">(</span><span class="i">$Matrix</span><span class="cm">,</span> <span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
2359 
2360   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
2361   <span class="i">$Matrix</span> = <span class="i">new</span> <span class="i">Matrix</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span><span class="sc">;</span>
2362 
2363   <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2364     <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2365       <span class="i">$Matrix</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] = <span class="k">sqrt</span> <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>]<span class="sc">;</span>
2366     <span class="s">}</span>
2367   <span class="s">}</span>
2368   <span class="k">return</span> <span class="i">$Matrix</span><span class="sc">;</span>
2369 <span class="s">}</span>
2370 
2371 <span class="c">#</span>
2372 <span class="c"># Matrix sine root operator returns a matrix with values corresponding to</span>
2373 <span class="c"># sin of values in a matrix</span>
2374 <span class="c">#</span>
<a name="_MatrixSineOperator-"></a>2375 <span class="k">sub </span><span class="m">_MatrixSineOperator</span> <span class="s">{</span>
2376   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="cm">,</span> <span class="i">$ErrorMsg</span><span class="s">)</span><span class="sc">;</span>
2377 
2378   <span class="i">$ErrorMsg</span> = <span class="q">&quot;_MatrixSineOperator: Matrix sin operation failed&quot;</span><span class="sc">;</span>
2379   <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="s">)</span> = <span class="i">_ProcessOverloadedOperatorParameters</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">@_</span><span class="s">)</span><span class="sc">;</span>
2380 
2381   <span class="k">my</span><span class="s">(</span><span class="i">$Matrix</span><span class="cm">,</span> <span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
2382 
2383   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
2384   <span class="i">$Matrix</span> = <span class="i">new</span> <span class="i">Matrix</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span><span class="sc">;</span>
2385 
2386   <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2387     <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2388       <span class="i">$Matrix</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] = <span class="k">sin</span> <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>]<span class="sc">;</span>
2389     <span class="s">}</span>
2390   <span class="s">}</span>
2391   <span class="k">return</span> <span class="i">$Matrix</span><span class="sc">;</span>
2392 <span class="s">}</span>
2393 
2394 <span class="c">#</span>
2395 <span class="c"># Matrix cosine root operator returns a matrix with values corresponding to</span>
2396 <span class="c"># cos of values in a matrix</span>
2397 <span class="c">#</span>
<a name="_MatrixCosineOperator-"></a>2398 <span class="k">sub </span><span class="m">_MatrixCosineOperator</span> <span class="s">{</span>
2399   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="cm">,</span> <span class="i">$ErrorMsg</span><span class="s">)</span><span class="sc">;</span>
2400 
2401   <span class="i">$ErrorMsg</span> = <span class="q">&quot;_MatrixCosineOperator: Matrix cos operation failed&quot;</span><span class="sc">;</span>
2402   <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="s">)</span> = <span class="i">_ProcessOverloadedOperatorParameters</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">@_</span><span class="s">)</span><span class="sc">;</span>
2403 
2404   <span class="k">my</span><span class="s">(</span><span class="i">$Matrix</span><span class="cm">,</span> <span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
2405 
2406   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
2407   <span class="i">$Matrix</span> = <span class="i">new</span> <span class="i">Matrix</span><span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span><span class="sc">;</span>
2408 
2409   <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2410     <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfCols</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2411       <span class="i">$Matrix</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>] = <span class="k">cos</span> <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>][<span class="i">$ColIndex</span>]<span class="sc">;</span>
2412     <span class="s">}</span>
2413   <span class="s">}</span>
2414   <span class="k">return</span> <span class="i">$Matrix</span><span class="sc">;</span>
2415 <span class="s">}</span>
2416 
2417 <span class="c"># Turn matrix into array for @{$Matrix} operation...</span>
2418 <span class="c">#</span>
<a name="_MatrixToArrayOperator-"></a>2419 <span class="k">sub </span><span class="m">_MatrixToArrayOperator</span> <span class="s">{</span>
2420   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
2421 
2422   <span class="k">return</span> \<span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">Values</span>}}<span class="sc">;</span>
2423 <span class="s">}</span>
2424 
2425 <span class="c"># Always return true in boolean context...</span>
2426 <span class="c">#</span>
<a name="_BoolifyMatrix-"></a>2427 <span class="k">sub </span><span class="m">_BoolifyMatrix</span> <span class="s">{</span>
2428   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
2429 
2430   <span class="k">return</span> <span class="n">1</span><span class="sc">;</span>
2431 <span class="s">}</span>
2432 
2433 <span class="c"># Process parameters passed to overloaded operators...</span>
2434 <span class="c">#</span>
2435 <span class="c"># For uninary operators, $SecondParameter is not defined.</span>
<a name="_ProcessOverloadedOperatorParameters-"></a>2436 <span class="k">sub </span><span class="m">_ProcessOverloadedOperatorParameters</span> <span class="s">{</span>
2437   <span class="k">my</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="cm">,</span> <span class="i">$ParametersOrderStatus</span><span class="cm">,</span> <span class="i">$CheckMatrixSizesStatus</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
2438   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="cm">,</span> <span class="i">$CheckMatrixSizes</span><span class="s">)</span><span class="sc">;</span>
2439 
2440   <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="s">)</span> =  <span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="s">)</span><span class="sc">;</span>
2441   <span class="i">$OrderFlipped</span> = <span class="s">(</span><span class="k">defined</span><span class="s">(</span><span class="i">$ParametersOrderStatus</span><span class="s">)</span> &amp;&amp; <span class="i">$ParametersOrderStatus</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
2442   <span class="i">$CheckMatrixSizes</span> = <span class="s">(</span><span class="k">defined</span> <span class="i">$CheckMatrixSizesStatus</span><span class="s">)</span> ? <span class="i">$CheckMatrixSizesStatus</span> <span class="co">:</span> <span class="n">1</span><span class="sc">;</span>
2443 
2444   <span class="i">_ValidateMatrix</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">$This</span><span class="s">)</span><span class="sc">;</span>
2445 
2446   <span class="i">$OtherIsMatrix</span> = <span class="n">0</span><span class="sc">;</span>
2447   <span class="k">if</span> <span class="s">(</span><span class="k">defined</span><span class="s">(</span><span class="i">$Other</span><span class="s">)</span> &amp;&amp; <span class="s">(</span><span class="k">ref</span> <span class="i">$Other</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2448     <span class="c"># Make sure $Other is a matrix...</span>
2449     <span class="i">_ValidateMatrix</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">$Other</span><span class="s">)</span><span class="sc">;</span>
2450     <span class="k">if</span> <span class="s">(</span><span class="i">$CheckMatrixSizes</span><span class="s">)</span> <span class="s">{</span>
2451       <span class="i">_ValidateMatrixSizesAreEqual</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="s">)</span><span class="sc">;</span>
2452     <span class="s">}</span>
2453     <span class="i">$OtherIsMatrix</span> = <span class="n">1</span><span class="sc">;</span>
2454   <span class="s">}</span>
2455   <span class="k">return</span> <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="cm">,</span> <span class="i">$OrderFlipped</span><span class="cm">,</span> <span class="i">$OtherIsMatrix</span><span class="s">)</span><span class="sc">;</span>
2456 <span class="s">}</span>
2457 
2458 <span class="c"># Make sure size of the two matrices contain the same number of values...</span>
<a name="_ValidateMatrixSizesAreEqual-"></a>2459 <span class="k">sub </span><span class="m">_ValidateMatrixSizesAreEqual</span> <span class="s">{</span>
2460   <span class="k">my</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">$Matrix1</span><span class="cm">,</span> <span class="i">$Matrix2</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
2461   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfRows1</span><span class="cm">,</span> <span class="i">$NumOfCols1</span><span class="cm">,</span> <span class="i">$NumOfRows2</span><span class="cm">,</span> <span class="i">$NumOfCols2</span><span class="s">)</span><span class="sc">;</span>
2462 
2463   <span class="s">(</span><span class="i">$NumOfRows1</span><span class="cm">,</span> <span class="i">$NumOfCols1</span><span class="s">)</span> = <span class="i">$Matrix1</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
2464   <span class="s">(</span><span class="i">$NumOfRows2</span><span class="cm">,</span> <span class="i">$NumOfCols2</span><span class="s">)</span> = <span class="i">$Matrix2</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
2465 
2466   <span class="k">if</span> <span class="s">(</span>!<span class="s">(</span><span class="i">$NumOfRows1</span> == <span class="i">$NumOfRows2</span> &amp;&amp; <span class="i">$NumOfCols1</span> == <span class="i">$NumOfCols2</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2467     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;${ErrorMsg}: Size of the matrices must be same...&quot;</span><span class="sc">;</span>
2468   <span class="s">}</span>
2469 <span class="s">}</span>
2470 
2471 <span class="c"># Return a string containing matrix values...</span>
2472 <span class="c">#</span>
<a name="StringifyMatrix-"></a>2473 <span class="k">sub </span><span class="m">StringifyMatrix</span> <span class="s">{</span>
2474   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
2475   <span class="k">my</span><span class="s">(</span><span class="i">$MatrixString</span><span class="cm">,</span> <span class="i">$MatrixPrintStyleValue</span><span class="cm">,</span> <span class="i">$PrintFormat</span><span class="cm">,</span> <span class="i">$AllRowsInOneLine</span><span class="cm">,</span> <span class="i">$FormatString</span><span class="cm">,</span> <span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="cm">,</span> <span class="i">$RowIndex</span><span class="cm">,</span> <span class="i">$RowNum</span><span class="cm">,</span> <span class="i">$RowString</span><span class="cm">,</span> <span class="i">@ValuesFormat</span><span class="s">)</span><span class="sc">;</span>
2476 
2477   <span class="s">(</span><span class="i">$NumOfRows</span><span class="cm">,</span> <span class="i">$NumOfCols</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
2478 
2479   <span class="i">$MatrixPrintStyleValue</span> = <span class="s">(</span><span class="k">exists</span> <span class="i">$This</span>-&gt;{<span class="w">MatrixPrintStyle</span>}<span class="s">)</span> ? <span class="i">$This</span>-&gt;{<span class="w">MatrixPrintStyle</span>} <span class="co">:</span> <span class="i">$MatrixPrintStyle</span><span class="sc">;</span>
2480   <span class="i">$AllRowsInOneLine</span> = <span class="s">(</span><span class="i">$MatrixPrintStyleValue</span> =~ <span class="q">/^AllRowsInOneLine$/i</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
2481 
2482   <span class="i">$PrintFormat</span> = <span class="s">(</span><span class="k">exists</span> <span class="i">$This</span>-&gt;{<span class="w">ValueFormat</span>}<span class="s">)</span> ? <span class="i">$This</span>-&gt;{<span class="w">ValueFormat</span>} <span class="co">:</span> <span class="i">$ValueFormat</span><span class="sc">;</span>
2483 
2484   <span class="i">@ValuesFormat</span> = <span class="s">(</span><span class="i">$PrintFormat</span><span class="s">)</span> x <span class="i">$NumOfCols</span><span class="sc">;</span>
2485   <span class="i">$FormatString</span> = <span class="k">join</span> <span class="q">&#39; &#39;</span><span class="cm">,</span> <span class="i">@ValuesFormat</span><span class="sc">;</span>
2486 
2487   <span class="i">$MatrixString</span> = <span class="k">sprintf</span> <span class="q">&quot;&lt;Size: $NumOfRows x $NumOfCols;&quot;</span><span class="sc">;</span>
2488   <span class="k">if</span> <span class="s">(</span><span class="i">$AllRowsInOneLine</span><span class="s">)</span> <span class="s">{</span>
2489     <span class="i">$MatrixString</span> .= <span class="k">sprintf</span> <span class="q">&quot; Values:&quot;</span><span class="sc">;</span>
2490   <span class="s">}</span>
2491   <span class="k">else</span> <span class="s">{</span>
2492     <span class="i">$MatrixString</span> .= <span class="k">sprintf</span> <span class="q">&quot; Values:\n&quot;</span><span class="sc">;</span>
2493   <span class="s">}</span>
2494 
2495   <span class="i">$RowNum</span> = <span class="n">0</span><span class="sc">;</span>
2496   <span class="k">for</span> <span class="i">$RowIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$NumOfRows</span> -<span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
2497     <span class="i">$RowNum</span>++<span class="sc">;</span>
2498     <span class="i">$RowString</span> = <span class="k">sprintf</span> <span class="q">&quot;Row${RowNum}:[$FormatString]&quot;</span><span class="cm">,</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$RowIndex</span>]}<span class="sc">;</span>
2499     <span class="k">if</span> <span class="s">(</span><span class="i">$AllRowsInOneLine</span><span class="s">)</span> <span class="s">{</span>
2500       <span class="i">$MatrixString</span> .= <span class="q">&quot; $RowString&quot;</span><span class="sc">;</span>
2501     <span class="s">}</span>
2502     <span class="k">else</span> <span class="s">{</span>
2503       <span class="i">$MatrixString</span> .= <span class="q">&quot;$RowString\n&quot;</span><span class="sc">;</span>
2504     <span class="s">}</span>
2505   <span class="s">}</span>
2506   <span class="i">$MatrixString</span> .= <span class="q">&quot;&gt;&quot;</span><span class="sc">;</span>
2507   <span class="k">return</span> <span class="i">$MatrixString</span><span class="sc">;</span>
2508 <span class="s">}</span>
2509 
<a name="EOF-"></a></pre>
<p>&nbsp;</p>
<br />
<center>
<img src="../../../images/h2o2.png">
</center>
</body>
</html>
