<html>
<head>
<title>MayaChemTools:Code:Fingerprints/FingerprintsVector.pm</title>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../../css/MayaChemToolsCode.css">
</head>
<body leftmargin="20" rightmargin="20" topmargin="10" bottommargin="10">
<br/>
<center>
<a href="http://www.mayachemtools.org" title="MayaChemTools Home"><img src="../../../images/MayaChemToolsLogo.gif" border="0" alt="MayaChemTools"></a>
</center>
<br/>
<pre>
<a name="package-Fingerprints::FingerprintsVector-"></a>   1 <span class="k">package </span><span class="i">Fingerprints::FingerprintsVector</span><span class="sc">;</span>
   2 <span class="c">#</span>
   3 <span class="c"># File: FingerprintsVector.pm</span>
   4 <span class="c"># Author: Manish Sud &lt;msud@san.rr.com&gt;</span>
   5 <span class="c">#</span>
   6 <span class="c"># Copyright (C) 2018 Manish Sud. All rights reserved.</span>
   7 <span class="c">#</span>
   8 <span class="c"># This file is part of MayaChemTools.</span>
   9 <span class="c">#</span>
  10 <span class="c"># MayaChemTools is free software; you can redistribute it and/or modify it under</span>
  11 <span class="c"># the terms of the GNU Lesser General Public License as published by the Free</span>
  12 <span class="c"># Software Foundation; either version 3 of the License, or (at your option) any</span>
  13 <span class="c"># later version.</span>
  14 <span class="c">#</span>
  15 <span class="c"># MayaChemTools is distributed in the hope that it will be useful, but without</span>
  16 <span class="c"># any warranty; without even the implied warranty of merchantability of fitness</span>
  17 <span class="c"># for a particular purpose.  See the GNU Lesser General Public License for more</span>
  18 <span class="c"># details.</span>
  19 <span class="c">#</span>
  20 <span class="c"># You should have received a copy of the GNU Lesser General Public License</span>
  21 <span class="c"># along with MayaChemTools; if not, see &lt;http://www.gnu.org/licenses/&gt; or</span>
  22 <span class="c"># write to the Free Software Foundation Inc., 59 Temple Place, Suite 330,</span>
  23 <span class="c"># Boston, MA, 02111-1307, USA.</span>
  24 <span class="c">#</span>
  25 
  26 <span class="k">use</span> <span class="w">strict</span><span class="sc">;</span>
  27 <span class="k">use</span> <span class="w">Carp</span><span class="sc">;</span>
  28 <span class="k">use</span> <span class="w">Exporter</span><span class="sc">;</span>
  29 <span class="k">use</span> <span class="w">Scalar::Util</span> <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  30 <span class="k">use</span> <span class="w">MathUtil</span> <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  31 <span class="k">use</span> <span class="w">TextUtil</span> <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  32 <span class="k">use</span> <span class="w">StatisticsUtil</span> <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  33 <span class="k">use</span> <span class="w">BitVector</span><span class="sc">;</span>
  34 <span class="k">use</span> <span class="w">Vector</span><span class="sc">;</span>
  35 
  36 <span class="k">use</span> <span class="w">vars</span> <span class="q">qw(@ISA @EXPORT @EXPORT_OK %EXPORT_TAGS)</span><span class="sc">;</span>
  37 
  38 <span class="i">@ISA</span> = <span class="q">qw(Exporter)</span><span class="sc">;</span>
  39 
  40 <span class="c"># Distance coefficients</span>
  41 <span class="k">my</span><span class="s">(</span><span class="i">@DistanceCoefficients</span><span class="s">)</span> = <span class="q">qw(CityBlockDistanceCoefficient EuclideanDistanceCoefficient HammingDistanceCoefficient ManhattanDistanceCoefficient SoergelDistanceCoefficient)</span><span class="sc">;</span>
  42 
  43 <span class="c"># Similarity coefficients...</span>
  44 <span class="k">my</span><span class="s">(</span><span class="i">@SimilarityCoefficients</span><span class="s">)</span> = <span class="q">qw(CosineSimilarityCoefficient CzekanowskiSimilarityCoefficient DiceSimilarityCoefficient OchiaiSimilarityCoefficient JaccardSimilarityCoefficient SorensonSimilarityCoefficient TanimotoSimilarityCoefficient)</span><span class="sc">;</span>
  45 
  46 <span class="c"># New from string...</span>
  47 <span class="k">my</span><span class="s">(</span><span class="i">@NewFromString</span><span class="s">)</span> = <span class="q">qw(NewFromValuesString NewFromValuesAndIDsString NewFromIDsAndValuesString NewFromValuesAndIDsPairsString NewFromIDsAndValuesPairsString)</span><span class="sc">;</span>
  48 
  49 <span class="i">@EXPORT</span> = <span class="q">qw(IsFingerprintsVector)</span><span class="sc">;</span>
  50 <span class="i">@EXPORT_OK</span> = <span class="q">qw(GetSupportedDistanceCoefficients GetSupportedSimilarityCoefficients GetSupportedDistanceAndSimilarityCoefficients @DistanceCoefficients @SimilarityCoefficients)</span><span class="sc">;</span>
  51 
  52 <span class="i">%EXPORT_TAGS</span> = <span class="s">(</span>
  53                 <span class="w">new</span> <span class="cm">=&gt;</span> <span class="s">[</span><span class="i">@NewFromString</span><span class="s">]</span><span class="cm">,</span>
  54                 <span class="w">distancecoefficients</span> <span class="cm">=&gt;</span> <span class="s">[</span><span class="i">@DistanceCoefficients</span><span class="s">]</span><span class="cm">,</span>
  55                 <span class="w">similaritycoefficients</span> <span class="cm">=&gt;</span> <span class="s">[</span><span class="i">@SimilarityCoefficients</span><span class="s">]</span><span class="cm">,</span>
  56                 <span class="w">all</span>  <span class="cm">=&gt;</span> <span class="s">[</span><span class="i">@EXPORT</span><span class="cm">,</span> <span class="i">@EXPORT_OK</span><span class="s">]</span>
  57                <span class="s">)</span><span class="sc">;</span>
  58 
  59 <span class="c"># Setup class variables...</span>
  60 <span class="k">my</span><span class="s">(</span><span class="i">$ClassName</span><span class="s">)</span><span class="sc">;</span>
  61 <span class="i">_InitializeClass</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  62 
  63 <span class="c"># Overload Perl functions...</span>
  64 <span class="k">use</span> <span class="w">overload</span> <span class="q">&#39;&quot;&quot;&#39;</span> <span class="cm">=&gt;</span> <span class="q">&#39;StringifyFingerprintsVector&#39;</span><span class="sc">;</span>
  65 
  66 <span class="c"># Class constructor...</span>
<a name="new-"></a>  67 <span class="k">sub </span><span class="m">new</span> <span class="s">{</span>
  68   <span class="k">my</span><span class="s">(</span><span class="i">$Class</span><span class="cm">,</span> <span class="i">%NamesAndValues</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
  69 
  70   <span class="c"># Initialize object...</span>
  71   <span class="k">my</span> <span class="i">$This</span> = <span class="s">{</span><span class="s">}</span><span class="sc">;</span>
  72   <span class="k">bless</span> <span class="i">$This</span><span class="cm">,</span> <span class="k">ref</span><span class="s">(</span><span class="i">$Class</span><span class="s">)</span> || <span class="i">$Class</span><span class="sc">;</span>
  73 
  74   <span class="i">$This</span><span class="i">-&gt;_InitializeFingerprintsVector</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  75 
  76   <span class="i">$This</span><span class="i">-&gt;_InitializeFingerprintsVectorProperties</span><span class="s">(</span><span class="i">%NamesAndValues</span><span class="s">)</span><span class="sc">;</span>
  77 
  78   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
  79 <span class="s">}</span>
  80 
  81 <span class="c"># Initialize object data...</span>
  82 <span class="c">#</span>
<a name="_InitializeFingerprintsVector-"></a>  83 <span class="k">sub </span><span class="m">_InitializeFingerprintsVector</span> <span class="s">{</span>
  84   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
  85 
  86   <span class="c"># Type of fingerprint vector...</span>
  87   <span class="i">$This</span>-&gt;{<span class="w">Type</span>} = <span class="q">&#39;&#39;</span><span class="sc">;</span>
  88 
  89   <span class="c"># Fingerprint vector values...</span>
  90   <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">Values</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  91 
  92   <span class="c"># Fingerprint vector value IDs...</span>
  93   <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">ValueIDs</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  94 
  95   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
  96 <span class="s">}</span>
  97 
  98 <span class="c"># Initialize class ...</span>
<a name="_InitializeClass-"></a>  99 <span class="k">sub </span><span class="m">_InitializeClass</span> <span class="s">{</span>
 100   <span class="c">#Class name...</span>
 101   <span class="i">$ClassName</span> = <span class="w">__PACKAGE__</span><span class="sc">;</span>
 102 <span class="s">}</span>
 103 
 104 <span class="c"># Initialize object properties....</span>
<a name="_InitializeFingerprintsVectorProperties-"></a> 105 <span class="k">sub </span><span class="m">_InitializeFingerprintsVectorProperties</span> <span class="s">{</span>
 106   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">%NamesAndValues</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 107 
 108   <span class="k">my</span><span class="s">(</span><span class="i">$Name</span><span class="cm">,</span> <span class="i">$Value</span><span class="cm">,</span> <span class="i">$MethodName</span><span class="s">)</span><span class="sc">;</span>
 109   <span class="k">while</span> <span class="s">(</span><span class="s">(</span><span class="i">$Name</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span> = <span class="k">each</span>  <span class="i">%NamesAndValues</span><span class="s">)</span> <span class="s">{</span>
 110     <span class="i">$MethodName</span> = <span class="q">&quot;Set${Name}&quot;</span><span class="sc">;</span>
 111     <span class="i">$This</span><span class="i">-&gt;$MethodName</span><span class="s">(</span><span class="i">$Value</span><span class="s">)</span><span class="sc">;</span>
 112   <span class="s">}</span>
 113 
 114   <span class="k">if</span> <span class="s">(</span>!<span class="k">exists</span> <span class="i">$NamesAndValues</span>{<span class="w">Type</span>}<span class="s">)</span> <span class="s">{</span>
 115     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;New: Object can&#39;t be instantiated without specifying type...&quot;</span><span class="sc">;</span>
 116   <span class="s">}</span>
 117   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 118 <span class="s">}</span>
 119 
 120 <span class="c"># Create a new fingerprints vector using space delimited values string. This functionality can be</span>
 121 <span class="c"># either invoked as a class function or an object method.</span>
 122 <span class="c">#</span>
<a name="NewFromValuesString-"></a> 123 <span class="k">sub </span><span class="m">NewFromValuesString ($$;$)</span> <span class="s">{</span>
 124   <span class="k">my</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="cm">,</span> <span class="i">$ThirdParamater</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 125   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Type</span><span class="cm">,</span> <span class="i">$ValuesString</span><span class="s">)</span><span class="sc">;</span>
 126 
 127   <span class="k">if</span> <span class="s">(</span><span class="i">@_</span> == <span class="n">3</span><span class="s">)</span> <span class="s">{</span>
 128     <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Type</span><span class="cm">,</span> <span class="i">$ValuesString</span><span class="s">)</span> = <span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="cm">,</span> <span class="i">$ThirdParamater</span><span class="s">)</span><span class="sc">;</span>
 129   <span class="s">}</span>
 130   <span class="k">else</span> <span class="s">{</span>
 131     <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Type</span><span class="cm">,</span> <span class="i">$ValuesString</span><span class="s">)</span> = <span class="s">(</span><span class="k">undef</span><span class="cm">,</span> <span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="s">)</span><span class="sc">;</span>
 132   <span class="s">}</span>
 133   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVector</span><span class="cm">,</span> <span class="i">@Values</span><span class="s">)</span><span class="sc">;</span>
 134 
 135   <span class="i">@Values</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 136   <span class="k">if</span> <span class="s">(</span><span class="k">defined</span><span class="s">(</span><span class="i">$ValuesString</span><span class="s">)</span> &amp;&amp; <span class="k">length</span><span class="s">(</span><span class="i">$ValuesString</span><span class="s">)</span> &amp;&amp; <span class="i">$ValuesString</span> !~ <span class="q">/^None$/i</span><span class="s">)</span> <span class="s">{</span>
 137     <span class="i">@Values</span> = <span class="k">split</span><span class="s">(</span><span class="q">&#39; &#39;</span><span class="cm">,</span> <span class="i">$ValuesString</span><span class="s">)</span><span class="sc">;</span>
 138   <span class="s">}</span>
 139 
 140   <span class="i">$FingerprintsVector</span> = <span class="i">new</span> <span class="i">Fingerprints::FingerprintsVector</span><span class="s">(</span><span class="q">&#39;Type&#39;</span> <span class="cm">=&gt;</span> <span class="i">$Type</span><span class="cm">,</span> <span class="q">&#39;Values&#39;</span> <span class="cm">=&gt;</span> \<span class="i">@Values</span><span class="s">)</span><span class="sc">;</span>
 141 
 142   <span class="k">return</span> <span class="i">$FingerprintsVector</span><span class="sc">;</span>
 143 <span class="s">}</span>
 144 
 145 <span class="c"># Create a new fingerprints vector using values and IDs string containing semicolon</span>
 146 <span class="c"># delimited value string and value IDs strings. The values within value and value IDs</span>
 147 <span class="c"># string are delimited by spaces.</span>
 148 <span class="c">#</span>
 149 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 150 <span class="c">#</span>
<a name="NewFromValuesAndIDsString-"></a> 151 <span class="k">sub </span><span class="m">NewFromValuesAndIDsString ($$;$)</span> <span class="s">{</span>
 152   <span class="k">my</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="cm">,</span> <span class="i">$ThirdParamater</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 153   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Type</span><span class="cm">,</span> <span class="i">$ValuesAndIDsString</span><span class="s">)</span><span class="sc">;</span>
 154 
 155   <span class="k">if</span> <span class="s">(</span><span class="i">@_</span> == <span class="n">3</span><span class="s">)</span> <span class="s">{</span>
 156     <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Type</span><span class="cm">,</span> <span class="i">$ValuesAndIDsString</span><span class="s">)</span> = <span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="cm">,</span> <span class="i">$ThirdParamater</span><span class="s">)</span><span class="sc">;</span>
 157   <span class="s">}</span>
 158   <span class="k">else</span> <span class="s">{</span>
 159     <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Type</span><span class="cm">,</span> <span class="i">$ValuesAndIDsString</span><span class="s">)</span> = <span class="s">(</span><span class="k">undef</span><span class="cm">,</span> <span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="s">)</span><span class="sc">;</span>
 160   <span class="s">}</span>
 161   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVector</span><span class="cm">,</span> <span class="i">$ValuesString</span><span class="cm">,</span> <span class="i">$ValueIDsString</span><span class="cm">,</span> <span class="i">@Values</span><span class="cm">,</span> <span class="i">@ValueIDs</span><span class="s">)</span><span class="sc">;</span>
 162 
 163   <span class="s">(</span><span class="i">$ValuesString</span><span class="cm">,</span> <span class="i">$ValueIDsString</span><span class="s">)</span> = <span class="k">split</span><span class="s">(</span><span class="q">&#39;;&#39;</span><span class="cm">,</span> <span class="i">$ValuesAndIDsString</span><span class="s">)</span><span class="sc">;</span>
 164 
 165   <span class="i">@Values</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 166   <span class="k">if</span> <span class="s">(</span><span class="k">defined</span><span class="s">(</span><span class="i">$ValuesString</span><span class="s">)</span> &amp;&amp; <span class="k">length</span><span class="s">(</span><span class="i">$ValuesString</span><span class="s">)</span> &amp;&amp; <span class="i">$ValuesString</span> !~ <span class="q">/^None$/i</span><span class="s">)</span> <span class="s">{</span>
 167     <span class="i">@Values</span> = <span class="k">split</span><span class="s">(</span><span class="q">&#39; &#39;</span><span class="cm">,</span> <span class="i">$ValuesString</span><span class="s">)</span><span class="sc">;</span>
 168   <span class="s">}</span>
 169   <span class="i">@ValueIDs</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 170   <span class="k">if</span> <span class="s">(</span><span class="k">defined</span><span class="s">(</span><span class="i">$ValueIDsString</span><span class="s">)</span> &amp;&amp; <span class="k">length</span><span class="s">(</span><span class="i">$ValueIDsString</span><span class="s">)</span> &amp;&amp; <span class="i">$ValueIDsString</span> !~ <span class="q">/^None$/i</span><span class="s">)</span> <span class="s">{</span>
 171     <span class="i">@ValueIDs</span> = <span class="k">split</span><span class="s">(</span><span class="q">&#39; &#39;</span><span class="cm">,</span> <span class="i">$ValueIDsString</span><span class="s">)</span><span class="sc">;</span>
 172   <span class="s">}</span>
 173 
 174   <span class="k">if</span> <span class="s">(</span><span class="i">@Values</span> != <span class="i">@ValueIDs</span> <span class="s">)</span> <span class="s">{</span>
 175     <span class="w">carp</span> <span class="q">&quot;Warning: ${ClassName}-&gt;NewFromValuesAndIDsString: Object can&#39;t be instantiated: Number specified values, &quot;</span> . <span class="k">scalar</span> <span class="i">@Values</span> . <span class="q">&quot;, must be equal to number of specified value IDs, &quot;</span> . <span class="k">scalar</span> <span class="i">@ValueIDs</span> .  <span class="q">&quot;...&quot;</span><span class="sc">;</span>
 176     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
 177   <span class="s">}</span>
 178 
 179   <span class="i">$FingerprintsVector</span> = <span class="i">new</span> <span class="i">Fingerprints::FingerprintsVector</span><span class="s">(</span><span class="q">&#39;Type&#39;</span> <span class="cm">=&gt;</span> <span class="i">$Type</span><span class="cm">,</span> <span class="q">&#39;Values&#39;</span> <span class="cm">=&gt;</span> \<span class="i">@Values</span><span class="cm">,</span> <span class="q">&#39;ValueIDs&#39;</span> <span class="cm">=&gt;</span> \<span class="i">@ValueIDs</span><span class="s">)</span><span class="sc">;</span>
 180 
 181   <span class="k">return</span> <span class="i">$FingerprintsVector</span><span class="sc">;</span>
 182 <span class="s">}</span>
 183 
 184 <span class="c"># Create a new fingerprints vector using IDs and values string containing semicolon</span>
 185 <span class="c"># delimited value IDs string and values strings. The values within value and value IDs</span>
 186 <span class="c"># string are delimited by spaces.</span>
 187 <span class="c">#</span>
 188 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 189 <span class="c">#</span>
<a name="NewFromIDsAndValuesString-"></a> 190 <span class="k">sub </span><span class="m">NewFromIDsAndValuesString ($$;$)</span> <span class="s">{</span>
 191   <span class="k">my</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="cm">,</span> <span class="i">$ThirdParamater</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 192   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Type</span><span class="cm">,</span> <span class="i">$IDsAndValuesString</span><span class="s">)</span><span class="sc">;</span>
 193 
 194   <span class="k">if</span> <span class="s">(</span><span class="i">@_</span> == <span class="n">3</span><span class="s">)</span> <span class="s">{</span>
 195     <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Type</span><span class="cm">,</span> <span class="i">$IDsAndValuesString</span><span class="s">)</span> = <span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="cm">,</span> <span class="i">$ThirdParamater</span><span class="s">)</span><span class="sc">;</span>
 196   <span class="s">}</span>
 197   <span class="k">else</span> <span class="s">{</span>
 198     <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Type</span><span class="cm">,</span> <span class="i">$IDsAndValuesString</span><span class="s">)</span> = <span class="s">(</span><span class="k">undef</span><span class="cm">,</span> <span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="s">)</span><span class="sc">;</span>
 199   <span class="s">}</span>
 200   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVector</span><span class="cm">,</span> <span class="i">$ValuesString</span><span class="cm">,</span> <span class="i">$ValueIDsString</span><span class="cm">,</span> <span class="i">@Values</span><span class="cm">,</span> <span class="i">@ValueIDs</span><span class="s">)</span><span class="sc">;</span>
 201 
 202   <span class="s">(</span><span class="i">$ValueIDsString</span><span class="cm">,</span> <span class="i">$ValuesString</span><span class="s">)</span> = <span class="k">split</span><span class="s">(</span><span class="q">&#39;;&#39;</span><span class="cm">,</span> <span class="i">$IDsAndValuesString</span><span class="s">)</span><span class="sc">;</span>
 203 
 204   <span class="i">@Values</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 205   <span class="k">if</span> <span class="s">(</span><span class="k">defined</span><span class="s">(</span><span class="i">$ValuesString</span><span class="s">)</span> &amp;&amp; <span class="k">length</span><span class="s">(</span><span class="i">$ValuesString</span><span class="s">)</span> &amp;&amp; <span class="i">$ValuesString</span> !~ <span class="q">/^None$/i</span><span class="s">)</span> <span class="s">{</span>
 206     <span class="i">@Values</span> = <span class="k">split</span><span class="s">(</span><span class="q">&#39; &#39;</span><span class="cm">,</span> <span class="i">$ValuesString</span><span class="s">)</span><span class="sc">;</span>
 207   <span class="s">}</span>
 208   <span class="i">@ValueIDs</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 209   <span class="k">if</span> <span class="s">(</span><span class="k">defined</span><span class="s">(</span><span class="i">$ValueIDsString</span><span class="s">)</span> &amp;&amp; <span class="k">length</span><span class="s">(</span><span class="i">$ValueIDsString</span><span class="s">)</span> &amp;&amp; <span class="i">$ValueIDsString</span> !~ <span class="q">/^None$/i</span><span class="s">)</span> <span class="s">{</span>
 210     <span class="i">@ValueIDs</span> = <span class="k">split</span><span class="s">(</span><span class="q">&#39; &#39;</span><span class="cm">,</span> <span class="i">$ValueIDsString</span><span class="s">)</span><span class="sc">;</span>
 211   <span class="s">}</span>
 212 
 213   <span class="k">if</span> <span class="s">(</span><span class="i">@Values</span> != <span class="i">@ValueIDs</span> <span class="s">)</span> <span class="s">{</span>
 214     <span class="w">carp</span> <span class="q">&quot;Warning: ${ClassName}-&gt;NewFromIDsAndValuesString: Object can&#39;t be instantiated: Number specified values, &quot;</span> . <span class="k">scalar</span> <span class="i">@Values</span> . <span class="q">&quot;, must be equal to number of specified value IDs, &quot;</span> . <span class="k">scalar</span> <span class="i">@ValueIDs</span> .  <span class="q">&quot;...&quot;</span><span class="sc">;</span>
 215     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
 216   <span class="s">}</span>
 217 
 218   <span class="i">$FingerprintsVector</span> = <span class="i">new</span> <span class="i">Fingerprints::FingerprintsVector</span><span class="s">(</span><span class="q">&#39;Type&#39;</span> <span class="cm">=&gt;</span> <span class="i">$Type</span><span class="cm">,</span> <span class="q">&#39;Values&#39;</span> <span class="cm">=&gt;</span> \<span class="i">@Values</span><span class="cm">,</span> <span class="q">&#39;ValueIDs&#39;</span> <span class="cm">=&gt;</span> \<span class="i">@ValueIDs</span><span class="s">)</span><span class="sc">;</span>
 219 
 220   <span class="k">return</span> <span class="i">$FingerprintsVector</span><span class="sc">;</span>
 221 <span class="s">}</span>
 222 
 223 <span class="c"># Create a new fingerprints vector using values and IDs pairs string containing space</span>
 224 <span class="c"># value and value IDs pairs.</span>
 225 <span class="c">#</span>
 226 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 227 <span class="c">#</span>
<a name="NewFromValuesAndIDsPairsString-"></a> 228 <span class="k">sub </span><span class="m">NewFromValuesAndIDsPairsString ($$;$)</span> <span class="s">{</span>
 229   <span class="k">my</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="cm">,</span> <span class="i">$ThirdParamater</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 230   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Type</span><span class="cm">,</span> <span class="i">$ValuesAndIDsPairsString</span><span class="s">)</span><span class="sc">;</span>
 231 
 232   <span class="k">if</span> <span class="s">(</span><span class="i">@_</span> == <span class="n">3</span><span class="s">)</span> <span class="s">{</span>
 233     <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Type</span><span class="cm">,</span> <span class="i">$ValuesAndIDsPairsString</span><span class="s">)</span> = <span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="cm">,</span> <span class="i">$ThirdParamater</span><span class="s">)</span><span class="sc">;</span>
 234   <span class="s">}</span>
 235   <span class="k">else</span> <span class="s">{</span>
 236     <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Type</span><span class="cm">,</span> <span class="i">$ValuesAndIDsPairsString</span><span class="s">)</span> = <span class="s">(</span><span class="k">undef</span><span class="cm">,</span> <span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="s">)</span><span class="sc">;</span>
 237   <span class="s">}</span>
 238   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVector</span><span class="cm">,</span> <span class="i">$Index</span><span class="cm">,</span> <span class="i">@Values</span><span class="cm">,</span> <span class="i">@ValueIDs</span><span class="cm">,</span> <span class="i">@ValuesAndIDsPairs</span><span class="s">)</span><span class="sc">;</span>
 239 
 240   <span class="i">@ValuesAndIDsPairs</span> = <span class="k">split</span><span class="s">(</span><span class="q">&#39; &#39;</span><span class="cm">,</span> <span class="i">$ValuesAndIDsPairsString</span><span class="s">)</span><span class="sc">;</span>
 241   <span class="k">if</span> <span class="s">(</span><span class="i">@ValuesAndIDsPairs</span> % <span class="n">2</span><span class="s">)</span> <span class="s">{</span>
 242     <span class="w">carp</span> <span class="q">&quot;Warning: ${ClassName}-&gt;NewFromValuesAndIDsPairsString: No fingerprint vector created: Invalid values and IDs pairs data: Input list must contain even number of values and IDs pairs...&quot;</span><span class="sc">;</span>
 243     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
 244   <span class="s">}</span>
 245 
 246   <span class="i">@Values</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span> <span class="i">@ValueIDs</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 247   <span class="k">if</span> <span class="s">(</span>!<span class="s">(</span><span class="i">@ValuesAndIDsPairs</span> == <span class="n">2</span> &amp;&amp; <span class="i">$ValuesAndIDsPairs</span>[<span class="n">0</span>] =~ <span class="q">/^None$/i</span> &amp;&amp; <span class="i">$ValuesAndIDsPairs</span>[<span class="n">1</span>] =~ <span class="q">/^None$/i</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 248     <span class="k">for</span> <span class="s">(</span><span class="i">$Index</span> = <span class="n">0</span><span class="sc">;</span> <span class="i">$Index</span> &lt; <span class="i">$#ValuesAndIDsPairs</span><span class="sc">;</span> <span class="i">$Index</span> += <span class="n">2</span><span class="s">)</span> <span class="s">{</span>
 249       <span class="k">push</span> <span class="i">@Values</span><span class="cm">,</span> <span class="i">$ValuesAndIDsPairs</span>[<span class="i">$Index</span>]<span class="sc">;</span>
 250       <span class="k">push</span> <span class="i">@ValueIDs</span><span class="cm">,</span> <span class="i">$ValuesAndIDsPairs</span>[<span class="i">$Index</span> + <span class="n">1</span>]<span class="sc">;</span>
 251     <span class="s">}</span>
 252   <span class="s">}</span>
 253   <span class="i">$FingerprintsVector</span> = <span class="i">new</span> <span class="i">Fingerprints::FingerprintsVector</span><span class="s">(</span><span class="q">&#39;Type&#39;</span> <span class="cm">=&gt;</span> <span class="i">$Type</span><span class="cm">,</span> <span class="q">&#39;Values&#39;</span> <span class="cm">=&gt;</span> \<span class="i">@Values</span><span class="cm">,</span> <span class="q">&#39;ValueIDs&#39;</span> <span class="cm">=&gt;</span> \<span class="i">@ValueIDs</span><span class="s">)</span><span class="sc">;</span>
 254 
 255   <span class="k">return</span> <span class="i">$FingerprintsVector</span><span class="sc">;</span>
 256 <span class="s">}</span>
 257 
 258 <span class="c"># Create a new fingerprints vector using IDs and values pairs string containing space</span>
 259 <span class="c"># value IDs and valus pairs.</span>
 260 <span class="c">#</span>
 261 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 262 <span class="c">#</span>
<a name="NewFromIDsAndValuesPairsString-"></a> 263 <span class="k">sub </span><span class="m">NewFromIDsAndValuesPairsString ($$;$)</span> <span class="s">{</span>
 264   <span class="k">my</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="cm">,</span> <span class="i">$ThirdParamater</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 265   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Type</span><span class="cm">,</span> <span class="i">$IDsAndValuesPairsString</span><span class="s">)</span><span class="sc">;</span>
 266 
 267   <span class="k">if</span> <span class="s">(</span><span class="i">@_</span> == <span class="n">3</span><span class="s">)</span> <span class="s">{</span>
 268     <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Type</span><span class="cm">,</span> <span class="i">$IDsAndValuesPairsString</span><span class="s">)</span> = <span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="cm">,</span> <span class="i">$ThirdParamater</span><span class="s">)</span><span class="sc">;</span>
 269   <span class="s">}</span>
 270   <span class="k">else</span> <span class="s">{</span>
 271     <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Type</span><span class="cm">,</span> <span class="i">$IDsAndValuesPairsString</span><span class="s">)</span> = <span class="s">(</span><span class="k">undef</span><span class="cm">,</span> <span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="s">)</span><span class="sc">;</span>
 272   <span class="s">}</span>
 273   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVector</span><span class="cm">,</span> <span class="i">$Index</span><span class="cm">,</span> <span class="i">@Values</span><span class="cm">,</span> <span class="i">@ValueIDs</span><span class="cm">,</span> <span class="i">@IDsAndValuesPairs</span><span class="s">)</span><span class="sc">;</span>
 274 
 275   <span class="i">@IDsAndValuesPairs</span> = <span class="k">split</span><span class="s">(</span><span class="q">&#39; &#39;</span><span class="cm">,</span> <span class="i">$IDsAndValuesPairsString</span><span class="s">)</span><span class="sc">;</span>
 276   <span class="k">if</span> <span class="s">(</span><span class="i">@IDsAndValuesPairs</span> % <span class="n">2</span><span class="s">)</span> <span class="s">{</span>
 277     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;NewFromIDsAndValuesPairsString: No fingerprint vector created: Invalid values and IDs pairs data: Input list must contain even number of values and IDs pairs...&quot;</span><span class="sc">;</span>
 278     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
 279   <span class="s">}</span>
 280 
 281   <span class="i">@Values</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span> <span class="i">@ValueIDs</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 282   <span class="k">if</span> <span class="s">(</span>!<span class="s">(</span><span class="i">@IDsAndValuesPairs</span> == <span class="n">2</span> &amp;&amp; <span class="i">$IDsAndValuesPairs</span>[<span class="n">0</span>] =~ <span class="q">/^None$/i</span> &amp;&amp; <span class="i">$IDsAndValuesPairs</span>[<span class="n">1</span>] =~ <span class="q">/^None$/i</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 283     <span class="k">for</span> <span class="s">(</span><span class="i">$Index</span> = <span class="n">0</span><span class="sc">;</span> <span class="i">$Index</span> &lt; <span class="i">$#IDsAndValuesPairs</span><span class="sc">;</span> <span class="i">$Index</span> += <span class="n">2</span><span class="s">)</span> <span class="s">{</span>
 284       <span class="k">push</span> <span class="i">@ValueIDs</span><span class="cm">,</span> <span class="i">$IDsAndValuesPairs</span>[<span class="i">$Index</span>]<span class="sc">;</span>
 285       <span class="k">push</span> <span class="i">@Values</span><span class="cm">,</span> <span class="i">$IDsAndValuesPairs</span>[<span class="i">$Index</span> + <span class="n">1</span>]<span class="sc">;</span>
 286     <span class="s">}</span>
 287   <span class="s">}</span>
 288   <span class="i">$FingerprintsVector</span> = <span class="i">new</span> <span class="i">Fingerprints::FingerprintsVector</span><span class="s">(</span><span class="q">&#39;Type&#39;</span> <span class="cm">=&gt;</span> <span class="i">$Type</span><span class="cm">,</span> <span class="q">&#39;Values&#39;</span> <span class="cm">=&gt;</span> \<span class="i">@Values</span><span class="cm">,</span> <span class="q">&#39;ValueIDs&#39;</span> <span class="cm">=&gt;</span> \<span class="i">@ValueIDs</span><span class="s">)</span><span class="sc">;</span>
 289 
 290   <span class="k">return</span> <span class="i">$FingerprintsVector</span><span class="sc">;</span>
 291 <span class="s">}</span>
 292 
 293 <span class="c"># Set type of fingerprint vector. Supported types are: OrderedNumericalValues, NumericalValues, and</span>
 294 <span class="c"># AlphaNumericalValues</span>
 295 <span class="c">#</span>
 296 <span class="c">#  .  For OrderedNumericalValues type, both vectors must be of the same size and contain similar</span>
 297 <span class="c">#     types of numerical values in the same order.</span>
 298 <span class="c">#</span>
 299 <span class="c">#  .  For NumericalValues type, vector value IDs for both vectors must be specified; however, their</span>
 300 <span class="c">#     size and order of IDs and numerical values may be different. For each vector, value IDs must</span>
 301 <span class="c">#     correspond to vector values.</span>
 302 <span class="c">#</span>
 303 <span class="c">#  .  For AlphaNumericalValues type, vectors may contain both numerical and alphanumerical values</span>
 304 <span class="c">#     and their sizes may be different.</span>
 305 <span class="c">#</span>
<a name="SetType-"></a> 306 <span class="k">sub </span><span class="m">SetType</span> <span class="s">{</span>
 307   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Type</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 308 
 309   <span class="k">if</span> <span class="s">(</span><span class="i">$Type</span> !~ <span class="q">/^(OrderedNumericalValues|NumericalValues|AlphaNumericalValues)$/i</span><span class="s">)</span> <span class="s">{</span>
 310     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;SetType: Specified value, $Type, for Type is not vaild. Supported types in current release of MayaChemTools: OrderedNumericalValues, NumericalValues or AlphaNumericalValues&quot;</span><span class="sc">;</span>
 311   <span class="s">}</span>
 312 
 313   <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Type</span>}<span class="s">)</span> <span class="s">{</span>
 314     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;SetType: Can&#39;t change intial fingerprints vector type:  It&#39;s already set...&quot;</span><span class="sc">;</span>
 315   <span class="s">}</span>
 316   <span class="i">$This</span>-&gt;{<span class="w">Type</span>} = <span class="i">$Type</span><span class="sc">;</span>
 317 
 318   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 319 <span class="s">}</span>
 320 
 321 <span class="c"># Get fingerpints vector type...</span>
 322 <span class="c">#</span>
<a name="GetType-"></a> 323 <span class="k">sub </span><span class="m">GetType</span> <span class="s">{</span>
 324   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 325 
 326   <span class="k">return</span> <span class="i">$This</span>-&gt;{<span class="w">Type</span>}<span class="sc">;</span>
 327 <span class="s">}</span>
 328 
 329 <span class="c"># Set ID...</span>
<a name="SetID-"></a> 330 <span class="k">sub </span><span class="m">SetID</span> <span class="s">{</span>
 331   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 332 
 333   <span class="i">$This</span>-&gt;{<span class="w">ID</span>} = <span class="i">$Value</span><span class="sc">;</span>
 334 
 335   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 336 <span class="s">}</span>
 337 
 338 <span class="c"># Get ID...</span>
<a name="GetID-"></a> 339 <span class="k">sub </span><span class="m">GetID</span> <span class="s">{</span>
 340   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 341 
 342   <span class="k">return</span> <span class="k">exists</span> <span class="i">$This</span>-&gt;{<span class="w">ID</span>} ? <span class="i">$This</span>-&gt;{<span class="w">ID</span>} <span class="co">:</span> <span class="q">&#39;None&#39;</span><span class="sc">;</span>
 343 <span class="s">}</span>
 344 
 345 <span class="c"># Set description...</span>
<a name="SetDescription-"></a> 346 <span class="k">sub </span><span class="m">SetDescription</span> <span class="s">{</span>
 347   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 348 
 349   <span class="i">$This</span>-&gt;{<span class="w">Description</span>} = <span class="i">$Value</span><span class="sc">;</span>
 350 
 351   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 352 <span class="s">}</span>
 353 
 354 <span class="c"># Get description...</span>
<a name="GetDescription-"></a> 355 <span class="k">sub </span><span class="m">GetDescription</span> <span class="s">{</span>
 356   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 357 
 358   <span class="k">return</span> <span class="k">exists</span> <span class="i">$This</span>-&gt;{<span class="w">Description</span>} ? <span class="i">$This</span>-&gt;{<span class="w">Description</span>} <span class="co">:</span> <span class="q">&#39;No description available&#39;</span><span class="sc">;</span>
 359 <span class="s">}</span>
 360 
 361 <span class="c"># Set vector type...</span>
<a name="SetVectorType-"></a> 362 <span class="k">sub </span><span class="m">SetVectorType</span> <span class="s">{</span>
 363   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 364 
 365   <span class="i">$This</span>-&gt;{<span class="w">VectorType</span>} = <span class="i">$Value</span><span class="sc">;</span>
 366 
 367   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 368 <span class="s">}</span>
 369 
 370 <span class="c"># Get vector type...</span>
<a name="GetVectorType-"></a> 371 <span class="k">sub </span><span class="m">GetVectorType</span> <span class="s">{</span>
 372   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 373 
 374   <span class="k">return</span> <span class="k">exists</span> <span class="i">$This</span>-&gt;{<span class="w">VectorType</span>} ? <span class="i">$This</span>-&gt;{<span class="w">VectorType</span>} <span class="co">:</span> <span class="q">&#39;FingerprintsVector&#39;</span><span class="sc">;</span>
 375 <span class="s">}</span>
 376 
 377 <span class="c"># Set values of a fingerprint vector using a vector, reference to an array or an array...</span>
 378 <span class="c">#</span>
<a name="SetValues-"></a> 379 <span class="k">sub </span><span class="m">SetValues</span> <span class="s">{</span>
 380   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">@Values</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 381 
 382   <span class="i">$This</span><span class="i">-&gt;_SetOrAddValuesOrValueIDs</span><span class="s">(</span><span class="q">&quot;SetValues&quot;</span><span class="cm">,</span> <span class="i">@Values</span><span class="s">)</span><span class="sc">;</span>
 383 
 384   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 385 <span class="s">}</span>
 386 
 387 <span class="c"># Set value IDs of a fingerprint vector using a vector, reference to an array or an array...</span>
 388 <span class="c">#</span>
<a name="SetValueIDs-"></a> 389 <span class="k">sub </span><span class="m">SetValueIDs</span> <span class="s">{</span>
 390   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">@Values</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 391 
 392   <span class="i">$This</span><span class="i">-&gt;_SetOrAddValuesOrValueIDs</span><span class="s">(</span><span class="q">&quot;SetValueIDs&quot;</span><span class="cm">,</span> <span class="i">@Values</span><span class="s">)</span><span class="sc">;</span>
 393 
 394   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 395 <span class="s">}</span>
 396 
 397 <span class="c"># Add values to a fingerprint vector using a vector, reference to an array or an array...</span>
 398 <span class="c">#</span>
<a name="AddValues-"></a> 399 <span class="k">sub </span><span class="m">AddValues</span> <span class="s">{</span>
 400   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">@Values</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 401 
 402   <span class="i">$This</span><span class="i">-&gt;_SetOrAddValuesOrValueIDs</span><span class="s">(</span><span class="q">&quot;AddValues&quot;</span><span class="cm">,</span> <span class="i">@Values</span><span class="s">)</span><span class="sc">;</span>
 403 
 404   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 405 <span class="s">}</span>
 406 
 407 <span class="c"># Add value IDs to a fingerprint vector using a vector, reference to an array or an array...</span>
 408 <span class="c">#</span>
<a name="AddValueIDs-"></a> 409 <span class="k">sub </span><span class="m">AddValueIDs</span> <span class="s">{</span>
 410   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">@Values</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 411 
 412   <span class="i">$This</span><span class="i">-&gt;_SetOrAddValuesOrValueIDs</span><span class="s">(</span><span class="q">&quot;AddValueIDs&quot;</span><span class="cm">,</span> <span class="i">@Values</span><span class="s">)</span><span class="sc">;</span>
 413 
 414   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 415 <span class="s">}</span>
 416 
 417 <span class="c"># Set or add values or value IDs using:</span>
 418 <span class="c">#</span>
 419 <span class="c">#    o List of values or ValueIDs</span>
 420 <span class="c">#    o Reference to an list of values or ValuesIDs</span>
 421 <span class="c">#    o A vector containing values or ValueIDs</span>
 422 <span class="c">#</span>
<a name="_SetOrAddValuesOrValueIDs-"></a> 423 <span class="k">sub </span><span class="m">_SetOrAddValuesOrValueIDs</span> <span class="s">{</span>
 424   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Mode</span><span class="cm">,</span> <span class="i">@Values</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 425 
 426   <span class="k">if</span> <span class="s">(</span>!<span class="i">@Values</span><span class="s">)</span> <span class="s">{</span>
 427     <span class="k">return</span><span class="sc">;</span>
 428   <span class="s">}</span>
 429 
 430   <span class="c"># Collect specified values or valueIDs...</span>
 431   <span class="k">my</span><span class="s">(</span><span class="i">$FirstValue</span><span class="cm">,</span> <span class="i">$TypeOfFirstValue</span><span class="cm">,</span> <span class="i">$ValuesRef</span><span class="s">)</span><span class="sc">;</span>
 432 
 433   <span class="i">$FirstValue</span> = <span class="i">$Values</span>[<span class="n">0</span>]<span class="sc">;</span>
 434   <span class="i">$TypeOfFirstValue</span> = <span class="k">ref</span> <span class="i">$FirstValue</span><span class="sc">;</span>
 435   <span class="k">if</span> <span class="s">(</span><span class="i">$TypeOfFirstValue</span> =~ <span class="q">/^(SCALAR|HASH|CODE|REF|GLOB)/</span><span class="s">)</span> <span class="s">{</span>
 436     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt; _SetOrAddValuesOrValueIDs: Trying to add values to vector object with a reference to unsupported value format...&quot;</span><span class="sc">;</span>
 437   <span class="s">}</span>
 438 
 439   <span class="k">if</span> <span class="s">(</span><span class="i">Vector::IsVector</span><span class="s">(</span><span class="i">$FirstValue</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 440     <span class="c"># It&#39;s a vector...</span>
 441     <span class="i">$ValuesRef</span> = <span class="i">$FirstValue</span><span class="i">-&gt;GetValues</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 442   <span class="s">}</span>
 443   <span class="k">elsif</span> <span class="s">(</span><span class="i">$TypeOfFirstValue</span> =~ <span class="q">/^ARRAY/</span><span class="s">)</span> <span class="s">{</span>
 444     <span class="c"># It&#39;s an array refernce...</span>
 445     <span class="i">$ValuesRef</span> = <span class="i">$FirstValue</span><span class="sc">;</span>
 446   <span class="s">}</span>
 447   <span class="k">else</span> <span class="s">{</span>
 448     <span class="c"># It&#39;s a list of values...</span>
 449     <span class="i">$ValuesRef</span> = \<span class="i">@Values</span><span class="sc">;</span>
 450   <span class="s">}</span>
 451 
 452   <span class="c"># Set or add values or value IDs...</span>
 453   <span class="j">MODE:</span> <span class="s">{</span>
 454     <span class="k">if</span> <span class="s">(</span><span class="i">$Mode</span> =~ <span class="q">/^SetValues$/i</span><span class="s">)</span> <span class="s">{</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">Values</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span> <span class="k">push</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">Values</span>}}<span class="cm">,</span> <span class="i">@</span>{<span class="i">$ValuesRef</span>}<span class="sc">;</span> <span class="k">last</span> <span class="j">MODE</span><span class="sc">;</span> <span class="s">}</span>
 455     <span class="k">if</span> <span class="s">(</span><span class="i">$Mode</span> =~ <span class="q">/^SetValueIDs$/i</span><span class="s">)</span> <span class="s">{</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">ValueIDs</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span> <span class="k">push</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">ValueIDs</span>}}<span class="cm">,</span> <span class="i">@</span>{<span class="i">$ValuesRef</span>}<span class="sc">;</span> <span class="k">last</span> <span class="j">MODE</span><span class="sc">;</span> <span class="s">}</span>
 456     <span class="k">if</span> <span class="s">(</span><span class="i">$Mode</span> =~ <span class="q">/^AddValues$/i</span><span class="s">)</span> <span class="s">{</span> <span class="k">push</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">Values</span>}}<span class="cm">,</span> <span class="i">@</span>{<span class="i">$ValuesRef</span>}<span class="sc">;</span> <span class="k">last</span> <span class="j">MODE</span><span class="sc">;</span> <span class="s">}</span>
 457     <span class="k">if</span> <span class="s">(</span><span class="i">$Mode</span> =~ <span class="q">/^AddValueIDs$/i</span><span class="s">)</span> <span class="s">{</span> <span class="k">push</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">ValueIDs</span>}}<span class="cm">,</span> <span class="i">@</span>{<span class="i">$ValuesRef</span>}<span class="sc">;</span> <span class="k">last</span> <span class="j">MODE</span><span class="sc">;</span> <span class="s">}</span>
 458     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt; _SetOrAddValuesOrValueIDs: Unknown mode $Mode...&quot;</span><span class="sc">;</span>
 459   <span class="s">}</span>
 460   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 461 <span class="s">}</span>
 462 
 463 <span class="c"># Set a specific value in fingerprint vector with indicies starting from 0..</span>
 464 <span class="c">#</span>
<a name="SetValue-"></a> 465 <span class="k">sub </span><span class="m">SetValue</span> <span class="s">{</span>
 466   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Index</span><span class="cm">,</span> <span class="i">$Value</span><span class="cm">,</span> <span class="i">$SkipCheck</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 467 
 468   <span class="c"># Just set it...</span>
 469   <span class="k">if</span> <span class="s">(</span><span class="i">$SkipCheck</span><span class="s">)</span> <span class="s">{</span>
 470     <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_SetValue</span><span class="s">(</span><span class="i">$Index</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span><span class="sc">;</span>
 471   <span class="s">}</span>
 472 
 473   <span class="c"># Check and set...</span>
 474   <span class="k">if</span> <span class="s">(</span><span class="i">$Index</span> &lt; <span class="n">0</span><span class="s">)</span> <span class="s">{</span>
 475     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;SetValue: Index value must be a positive number...&quot;</span><span class="sc">;</span>
 476   <span class="s">}</span>
 477   <span class="k">if</span> <span class="s">(</span><span class="i">$Index</span> &gt;= <span class="i">$This</span><span class="i">-&gt;GetNumOfValues</span><span class="s">(</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 478     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;SetValue: Index vaue must be less than number of values...&quot;</span><span class="sc">;</span>
 479   <span class="s">}</span>
 480 
 481   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_SetValue</span><span class="s">(</span><span class="i">$Index</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span><span class="sc">;</span>
 482 <span class="s">}</span>
 483 
 484 <span class="c"># Set a fingerprint vector value...</span>
 485 <span class="c">#</span>
<a name="_SetValue-"></a> 486 <span class="k">sub </span><span class="m">_SetValue</span> <span class="s">{</span>
 487   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Index</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 488 
 489   <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$Index</span>] = <span class="i">$Value</span><span class="sc">;</span>
 490 
 491   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 492 <span class="s">}</span>
 493 
 494 <span class="c"># Get a specific value from fingerprint vector with indicies starting from 0...</span>
 495 <span class="c">#</span>
<a name="GetValue-"></a> 496 <span class="k">sub </span><span class="m">GetValue</span> <span class="s">{</span>
 497   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Index</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 498 
 499   <span class="k">if</span> <span class="s">(</span><span class="i">$Index</span> &lt; <span class="n">0</span><span class="s">)</span> <span class="s">{</span>
 500     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;GetValue: Index value must be a positive number...&quot;</span><span class="sc">;</span>
 501   <span class="s">}</span>
 502   <span class="k">if</span> <span class="s">(</span><span class="i">$Index</span> &gt;= <span class="i">$This</span><span class="i">-&gt;GetNumOfValues</span><span class="s">(</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 503     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;GetValue: Index value must be less than number of values...&quot;</span><span class="sc">;</span>
 504   <span class="s">}</span>
 505   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_GetValue</span><span class="s">(</span><span class="i">$Index</span><span class="s">)</span><span class="sc">;</span>
 506 <span class="s">}</span>
 507 
 508 <span class="c"># Get a fingerprint vector value...</span>
<a name="_GetValue-"></a> 509 <span class="k">sub </span><span class="m">_GetValue</span> <span class="s">{</span>
 510   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Index</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 511 
 512   <span class="k">return</span> <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$Index</span>]<span class="sc">;</span>
 513 <span class="s">}</span>
 514 
 515 <span class="c"># Return vector values as an array or reference to an array...</span>
 516 <span class="c">#</span>
<a name="GetValues-"></a> 517 <span class="k">sub </span><span class="m">GetValues</span> <span class="s">{</span>
 518   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 519 
 520   <span class="k">return</span> <span class="k">wantarray</span> ? <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">Values</span>}} <span class="co">:</span> \<span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">Values</span>}}<span class="sc">;</span>
 521 <span class="s">}</span>
 522 
 523 <span class="c"># Set a specific value ID in fingerprint vector with indicies starting from 0..</span>
 524 <span class="c">#</span>
<a name="SetValueID-"></a> 525 <span class="k">sub </span><span class="m">SetValueID</span> <span class="s">{</span>
 526   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Index</span><span class="cm">,</span> <span class="i">$Value</span><span class="cm">,</span> <span class="i">$SkipCheck</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 527 
 528   <span class="c"># Just set it...</span>
 529   <span class="k">if</span> <span class="s">(</span><span class="i">$SkipCheck</span><span class="s">)</span> <span class="s">{</span>
 530     <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_SetValueID</span><span class="s">(</span><span class="i">$Index</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span><span class="sc">;</span>
 531   <span class="s">}</span>
 532 
 533   <span class="c"># Check and set...</span>
 534   <span class="k">if</span> <span class="s">(</span><span class="i">$Index</span> &lt; <span class="n">0</span><span class="s">)</span> <span class="s">{</span>
 535     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;SetValueID: Index value must be a positive number...&quot;</span><span class="sc">;</span>
 536   <span class="s">}</span>
 537   <span class="k">if</span> <span class="s">(</span><span class="i">$Index</span> &gt;= <span class="i">$This</span><span class="i">-&gt;GetNumOfValueIDs</span><span class="s">(</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 538     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;SetValueID: Index vaue must be less than number of value IDs...&quot;</span><span class="sc">;</span>
 539   <span class="s">}</span>
 540 
 541   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_SetValueID</span><span class="s">(</span><span class="i">$Index</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span><span class="sc">;</span>
 542 <span class="s">}</span>
 543 
 544 <span class="c"># Set a fingerprint vector value ID...</span>
 545 <span class="c">#</span>
<a name="_SetValueID-"></a> 546 <span class="k">sub </span><span class="m">_SetValueID</span> <span class="s">{</span>
 547   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Index</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 548 
 549   <span class="i">$This</span>-&gt;{<span class="w">ValueIDs</span>}[<span class="i">$Index</span>] = <span class="i">$Value</span><span class="sc">;</span>
 550 
 551   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 552 <span class="s">}</span>
 553 
 554 <span class="c"># Get a specific value ID from fingerprint vector with indicies starting from 0...</span>
 555 <span class="c">#</span>
<a name="GetValueID-"></a> 556 <span class="k">sub </span><span class="m">GetValueID</span> <span class="s">{</span>
 557   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Index</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 558 
 559   <span class="k">if</span> <span class="s">(</span><span class="i">$Index</span> &lt; <span class="n">0</span><span class="s">)</span> <span class="s">{</span>
 560     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;GetValueID: Index value must be a positive number...&quot;</span><span class="sc">;</span>
 561   <span class="s">}</span>
 562   <span class="k">if</span> <span class="s">(</span><span class="i">$Index</span> &gt;= <span class="i">$This</span><span class="i">-&gt;GetNumOfValueIDs</span><span class="s">(</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 563     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;GetValueID: Index value must be less than number of value IDs...&quot;</span><span class="sc">;</span>
 564   <span class="s">}</span>
 565   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_GetValueID</span><span class="s">(</span><span class="i">$Index</span><span class="s">)</span><span class="sc">;</span>
 566 <span class="s">}</span>
 567 
 568 <span class="c"># Get a fingerprint vector value ID...</span>
 569 <span class="c">#</span>
<a name="_GetValueID-"></a> 570 <span class="k">sub </span><span class="m">_GetValueID</span> <span class="s">{</span>
 571   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Index</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 572 
 573   <span class="k">return</span> <span class="i">$This</span>-&gt;{<span class="w">ValueIDs</span>}[<span class="i">$Index</span>]<span class="sc">;</span>
 574 <span class="s">}</span>
 575 
 576 <span class="c"># Return vector value IDs as an array or reference to an array...</span>
 577 <span class="c">#</span>
<a name="GetValueIDs-"></a> 578 <span class="k">sub </span><span class="m">GetValueIDs</span> <span class="s">{</span>
 579   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 580 
 581   <span class="k">return</span> <span class="k">wantarray</span> ? <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">ValueIDs</span>}} <span class="co">:</span> \<span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">ValueIDs</span>}}<span class="sc">;</span>
 582 <span class="s">}</span>
 583 
 584 <span class="c"># Get fingerprints vector string containing values and/or IDs string in a specifed format...</span>
 585 <span class="c">#</span>
<a name="GetFingerprintsVectorString-"></a> 586 <span class="k">sub </span><span class="m">GetFingerprintsVectorString</span> <span class="s">{</span>
 587   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Format</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 588 
 589   <span class="j">FORMAT :</span> <span class="s">{</span>
 590     <span class="k">if</span> <span class="s">(</span><span class="i">$Format</span> =~ <span class="q">/^(IDsAndValuesString|IDsAndValues)$/i</span><span class="s">)</span> <span class="s">{</span> <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;GetIDsAndValuesString</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span> <span class="k">last</span> <span class="j">FORMAT</span><span class="sc">;</span> <span class="s">}</span>
 591     <span class="k">if</span> <span class="s">(</span><span class="i">$Format</span> =~ <span class="q">/^(IDsAndValuesPairsString|IDsAndValuesPairs)$/i</span><span class="s">)</span> <span class="s">{</span> <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;GetIDsAndValuesPairsString</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span> <span class="k">last</span> <span class="j">FORMAT</span><span class="sc">;</span> <span class="s">}</span>
 592     <span class="k">if</span> <span class="s">(</span><span class="i">$Format</span> =~ <span class="q">/^(ValuesAndIDsString|ValuesAndIDs)$/i</span><span class="s">)</span> <span class="s">{</span> <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;GetValuesAndIDsString</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span> <span class="k">last</span> <span class="j">FORMAT</span><span class="sc">;</span> <span class="s">}</span>
 593     <span class="k">if</span> <span class="s">(</span><span class="i">$Format</span> =~ <span class="q">/^(ValuesAndIDsPairsString|ValuesAndIDsPairs)$/i</span><span class="s">)</span> <span class="s">{</span> <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;GetValuesAndIDsPairsString</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span> <span class="k">last</span> <span class="j">FORMAT</span><span class="sc">;</span><span class="s">}</span>
 594     <span class="k">if</span> <span class="s">(</span><span class="i">$Format</span> =~ <span class="q">/^(ValueIDsString|ValueIDs)$/i</span><span class="s">)</span> <span class="s">{</span> <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;GetValueIDsString</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span> <span class="k">last</span> <span class="j">FORMAT</span><span class="sc">;</span> <span class="s">}</span>
 595     <span class="k">if</span> <span class="s">(</span><span class="i">$Format</span> =~ <span class="q">/^(ValuesString|Values)$/i</span><span class="s">)</span> <span class="s">{</span> <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;GetValuesString</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span> <span class="k">last</span> <span class="j">FORMAT</span><span class="sc">;</span> <span class="s">}</span>
 596     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;GetFingerprintsVectorString: Specified vector string format, $Format, is not supported. Value values: IDsAndValuesString, IDsAndValues, IDsAndValuesPairsString, IDsAndValuesPairs, ValuesAndIDsString, ValuesAndIDs, ValuesAndIDsPairsString, ValuesAndIDsPairs, ValueIDsString, ValueIDs, ValuesString, Values...&quot;</span><span class="sc">;</span>
 597   <span class="s">}</span>
 598   <span class="k">return</span> <span class="q">&#39;&#39;</span><span class="sc">;</span>
 599 <span class="s">}</span>
 600 <span class="c"># Get vector value IDs and values string as space delimited ASCII string separated</span>
 601 <span class="c"># by semicolon...</span>
 602 <span class="c">#</span>
<a name="GetIDsAndValuesString-"></a> 603 <span class="k">sub </span><span class="m">GetIDsAndValuesString</span> <span class="s">{</span>
 604   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 605 
 606   <span class="k">if</span> <span class="s">(</span><span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">ValueIDs</span>}} &amp;&amp; <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">Values</span>}}<span class="s">)</span> <span class="s">{</span>
 607     <span class="c"># Both IDs and values are available...</span>
 608     <span class="k">return</span> <span class="k">join</span><span class="s">(</span><span class="q">&#39; &#39;</span><span class="cm">,</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">ValueIDs</span>}}<span class="s">)</span> . <span class="q">&quot;;&quot;</span> . <span class="k">join</span><span class="s">(</span><span class="q">&#39; &#39;</span><span class="cm">,</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">Values</span>}}<span class="s">)</span><span class="sc">;</span>
 609   <span class="s">}</span>
 610   <span class="k">elsif</span> <span class="s">(</span><span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">Values</span>}}<span class="s">)</span> <span class="s">{</span>
 611     <span class="c"># Only values are available...</span>
 612     <span class="k">return</span> <span class="q">&quot;None;&quot;</span> . <span class="k">join</span><span class="s">(</span><span class="q">&#39; &#39;</span><span class="cm">,</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">Values</span>}}<span class="s">)</span><span class="sc">;</span>
 613   <span class="s">}</span>
 614   <span class="k">else</span> <span class="s">{</span>
 615     <span class="c"># Values are not available...</span>
 616     <span class="k">return</span> <span class="q">&quot;None;None&quot;</span><span class="sc">;</span>
 617   <span class="s">}</span>
 618 <span class="s">}</span>
 619 
 620 <span class="c"># Get vector value IDs and value pairs string as space delimited ASCII string...</span>
 621 <span class="c">#</span>
<a name="GetIDsAndValuesPairsString-"></a> 622 <span class="k">sub </span><span class="m">GetIDsAndValuesPairsString</span> <span class="s">{</span>
 623   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 624   <span class="k">my</span><span class="s">(</span><span class="i">$Index</span><span class="cm">,</span> <span class="i">$ValueIDsPresent</span><span class="cm">,</span> <span class="i">@IDsAndValuesPairs</span><span class="s">)</span><span class="sc">;</span>
 625 
 626   <span class="k">if</span> <span class="s">(</span>!<span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">Values</span>}}<span class="s">)</span> <span class="s">{</span>
 627     <span class="c"># Values are unavailable...</span>
 628     <span class="k">return</span> <span class="q">&quot;None None&quot;</span><span class="sc">;</span>
 629   <span class="s">}</span>
 630 
 631   <span class="i">$ValueIDsPresent</span> = <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">ValueIDs</span>}} ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 632 
 633   <span class="i">@IDsAndValuesPairs</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 634   <span class="k">for</span> <span class="i">$Index</span> <span class="s">(</span><span class="n">0</span> .. <span class="i">$#</span>{<span class="i">$This</span>-&gt;{<span class="w">Values</span>}}<span class="s">)</span> <span class="s">{</span>
 635     <span class="k">if</span> <span class="s">(</span><span class="i">$ValueIDsPresent</span><span class="s">)</span> <span class="s">{</span>
 636       <span class="k">push</span> <span class="i">@IDsAndValuesPairs</span><span class="cm">,</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">ValueIDs</span>}-&gt;[<span class="i">$Index</span>]<span class="cm">,</span> <span class="i">$This</span>-&gt;{<span class="w">Values</span>}-&gt;[<span class="i">$Index</span>]<span class="s">)</span><span class="sc">;</span>
 637     <span class="s">}</span>
 638     <span class="k">else</span> <span class="s">{</span>
 639       <span class="k">push</span> <span class="i">@IDsAndValuesPairs</span><span class="cm">,</span> <span class="s">(</span><span class="q">&#39;None&#39;</span><span class="cm">,</span> <span class="i">$This</span>-&gt;{<span class="w">Values</span>}-&gt;[<span class="i">$Index</span>]<span class="s">)</span><span class="sc">;</span>
 640     <span class="s">}</span>
 641   <span class="s">}</span>
 642   <span class="k">return</span> <span class="k">join</span><span class="s">(</span><span class="q">&#39; &#39;</span><span class="cm">,</span> <span class="i">@IDsAndValuesPairs</span><span class="s">)</span><span class="sc">;</span>
 643 <span class="s">}</span>
 644 
 645 <span class="c"># Get vector value and value IDs string as space delimited ASCII string separated</span>
 646 <span class="c"># by semicolon...</span>
 647 <span class="c">#</span>
<a name="GetValuesAndIDsString-"></a> 648 <span class="k">sub </span><span class="m">GetValuesAndIDsString</span> <span class="s">{</span>
 649   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 650 
 651   <span class="k">if</span> <span class="s">(</span><span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">ValueIDs</span>}} &amp;&amp; <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">Values</span>}}<span class="s">)</span> <span class="s">{</span>
 652     <span class="c"># Both IDs and values are available...</span>
 653     <span class="k">return</span> <span class="k">join</span><span class="s">(</span><span class="q">&#39; &#39;</span><span class="cm">,</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">Values</span>}}<span class="s">)</span> . <span class="q">&quot;;&quot;</span> . <span class="k">join</span><span class="s">(</span><span class="q">&#39; &#39;</span><span class="cm">,</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">ValueIDs</span>}}<span class="s">)</span><span class="sc">;</span>
 654   <span class="s">}</span>
 655   <span class="k">elsif</span> <span class="s">(</span><span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">Values</span>}}<span class="s">)</span> <span class="s">{</span>
 656     <span class="c"># Only values are available...</span>
 657     <span class="k">return</span> <span class="k">join</span><span class="s">(</span><span class="q">&#39; &#39;</span><span class="cm">,</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">Values</span>}}<span class="s">)</span> . <span class="q">&quot;;None&quot;</span><span class="sc">;</span>
 658   <span class="s">}</span>
 659   <span class="k">else</span> <span class="s">{</span>
 660     <span class="c"># Values are not available...</span>
 661     <span class="k">return</span> <span class="q">&quot;None;None&quot;</span><span class="sc">;</span>
 662   <span class="s">}</span>
 663 <span class="s">}</span>
 664 
 665 <span class="c"># Get vector value and value ID pairs string as space delimited ASCII string...</span>
 666 <span class="c">#</span>
<a name="GetValuesAndIDsPairsString-"></a> 667 <span class="k">sub </span><span class="m">GetValuesAndIDsPairsString</span> <span class="s">{</span>
 668   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 669   <span class="k">my</span><span class="s">(</span><span class="i">$Index</span><span class="cm">,</span> <span class="i">$ValueIDsPresent</span><span class="cm">,</span> <span class="i">@ValuesAndIDsPairs</span><span class="s">)</span><span class="sc">;</span>
 670 
 671   <span class="k">if</span> <span class="s">(</span>!<span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">Values</span>}}<span class="s">)</span> <span class="s">{</span>
 672     <span class="c"># Values are unavailable...</span>
 673     <span class="k">return</span> <span class="q">&quot;None None&quot;</span><span class="sc">;</span>
 674   <span class="s">}</span>
 675 
 676   <span class="i">$ValueIDsPresent</span> = <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">ValueIDs</span>}} ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 677 
 678   <span class="i">@ValuesAndIDsPairs</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 679   <span class="k">for</span> <span class="i">$Index</span> <span class="s">(</span><span class="n">0</span> .. <span class="i">$#</span>{<span class="i">$This</span>-&gt;{<span class="w">Values</span>}}<span class="s">)</span> <span class="s">{</span>
 680     <span class="k">if</span> <span class="s">(</span><span class="i">$ValueIDsPresent</span><span class="s">)</span> <span class="s">{</span>
 681       <span class="k">push</span> <span class="i">@ValuesAndIDsPairs</span><span class="cm">,</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Values</span>}-&gt;[<span class="i">$Index</span>]<span class="cm">,</span> <span class="i">$This</span>-&gt;{<span class="w">ValueIDs</span>}-&gt;[<span class="i">$Index</span>]<span class="s">)</span><span class="sc">;</span>
 682     <span class="s">}</span>
 683     <span class="k">else</span> <span class="s">{</span>
 684       <span class="k">push</span> <span class="i">@ValuesAndIDsPairs</span><span class="cm">,</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Values</span>}-&gt;[<span class="i">$Index</span>]<span class="cm">,</span> <span class="q">&#39;None&#39;</span><span class="s">)</span><span class="sc">;</span>
 685     <span class="s">}</span>
 686   <span class="s">}</span>
 687   <span class="k">return</span> <span class="k">join</span><span class="s">(</span><span class="q">&#39; &#39;</span><span class="cm">,</span> <span class="i">@ValuesAndIDsPairs</span><span class="s">)</span><span class="sc">;</span>
 688 <span class="s">}</span>
 689 
 690 <span class="c"># Get vector value IDs string as space delimited ASCII string...</span>
 691 <span class="c">#</span>
<a name="GetValueIDsString-"></a> 692 <span class="k">sub </span><span class="m">GetValueIDsString</span> <span class="s">{</span>
 693   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 694 
 695   <span class="k">return</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">ValueIDs</span>}} ? <span class="k">join</span><span class="s">(</span><span class="q">&#39; &#39;</span><span class="cm">,</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">ValueIDs</span>}}<span class="s">)</span> <span class="co">:</span> <span class="q">&#39;None&#39;</span><span class="sc">;</span>
 696 <span class="s">}</span>
 697 
 698 <span class="c"># Get vector value string as space delimited ASCII string...</span>
 699 <span class="c">#</span>
<a name="GetValuesString-"></a> 700 <span class="k">sub </span><span class="m">GetValuesString</span> <span class="s">{</span>
 701   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 702 
 703   <span class="k">return</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">Values</span>}} ? <span class="k">join</span><span class="s">(</span><span class="q">&#39; &#39;</span><span class="cm">,</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">Values</span>}}<span class="s">)</span> <span class="co">:</span> <span class="q">&#39;None&#39;</span><span class="sc">;</span>
 704 <span class="s">}</span>
 705 
 706 <span class="c"># Get number of values...</span>
<a name="GetNumOfValues-"></a> 707 <span class="k">sub </span><span class="m">GetNumOfValues</span> <span class="s">{</span>
 708   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 709 
 710   <span class="k">return</span> <span class="k">scalar</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">Values</span>}}<span class="sc">;</span>
 711 <span class="s">}</span>
 712 
 713 <span class="c"># Get number of non-zero values...</span>
<a name="GetNumOfNonZeroValues-"></a> 714 <span class="k">sub </span><span class="m">GetNumOfNonZeroValues</span> <span class="s">{</span>
 715   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 716   <span class="k">my</span><span class="s">(</span><span class="i">$Count</span><span class="cm">,</span> <span class="i">$Index</span><span class="cm">,</span> <span class="i">$Size</span><span class="s">)</span><span class="sc">;</span>
 717 
 718   <span class="i">$Count</span> = <span class="n">0</span><span class="sc">;</span>
 719   <span class="i">$Size</span> = <span class="i">$This</span><span class="i">-&gt;GetNumOfValues</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 720 
 721   <span class="k">for</span> <span class="i">$Index</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$Size</span> -<span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 722     <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$Index</span>] != <span class="n">0</span><span class="s">)</span> <span class="s">{</span>
 723       <span class="i">$Count</span>++<span class="sc">;</span>
 724     <span class="s">}</span>
 725   <span class="s">}</span>
 726   <span class="k">return</span> <span class="i">$Count</span><span class="sc">;</span>
 727 <span class="s">}</span>
 728 
 729 <span class="c"># Get number of value IDs...</span>
<a name="GetNumOfValueIDs-"></a> 730 <span class="k">sub </span><span class="m">GetNumOfValueIDs</span> <span class="s">{</span>
 731   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 732 
 733   <span class="k">return</span> <span class="k">scalar</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">ValueIDs</span>}}<span class="sc">;</span>
 734 <span class="s">}</span>
 735 
 736 <span class="c"># FinegerprintsVectors class provides methods to calculate similarity between vectors</span>
 737 <span class="c"># containing three different types of values:</span>
 738 <span class="c">#</span>
 739 <span class="c"># Type I: OrderedNumericalValues</span>
 740 <span class="c">#</span>
 741 <span class="c">#   . Size of two vectors are same</span>
 742 <span class="c">#   . Vectors contain real values in a specific order. For example: MACCS keys count, Topological</span>
 743 <span class="c">#     pharnacophore atom pairs and so on.</span>
 744 <span class="c">#   . Option to calculate similarity value using continious values or binary values</span>
 745 <span class="c">#</span>
 746 <span class="c"># Type II: UnorderedNumericalValues</span>
 747 <span class="c">#</span>
 748 <span class="c">#   . Size of two vectors might not be same</span>
 749 <span class="c">#   . Vectors contain unordered real value identified by value IDs. For example: Toplogical atom pairs,</span>
 750 <span class="c">#     Topological atom torsions and so on</span>
 751 <span class="c">#   . Option to calculate similarity value using continous values or binary values</span>
 752 <span class="c">#</span>
 753 <span class="c"># Type III: AlphaNumericalValues</span>
 754 <span class="c">#</span>
 755 <span class="c">#   . Size of two vectors might not be same</span>
 756 <span class="c">#   . Vectors contain unordered alphanumerical values. For example: Extended connectivity fingerprints,</span>
 757 <span class="c">#     atom neighbothood fingerpritns.</span>
 758 <span class="c">#   . The vector values are treated as keys or bit indices and similarity value is calculated accordingly.</span>
 759 <span class="c">#</span>
 760 <span class="c"># Before performing similarity or distance calculations between vectors containing UnorderedNumericalValues</span>
 761 <span class="c"># or AlphaNumericalValues, the vectors are tranformed into vectors containing unique OrderedNumericalValues</span>
 762 <span class="c"># using value IDs for UnorderedNumericalValues and values itself for AlphaNumericalValues.</span>
 763 <span class="c">#</span>
 764 <span class="c"># Three forms similarity or distance calculation between two vectors: AlgebraicForm, BinaryForm or</span>
 765 <span class="c"># SetTheoreticForm.</span>
 766 <span class="c">#</span>
 767 <span class="c"># The value of an extra paramter, CalculationMode, passed to each similarity or distance function</span>
 768 <span class="c"># controls the calculation. Supported values for CalculationMode: AlgebraicForm, BinaryForm and</span>
 769 <span class="c"># SetTheoreticForm. Default: AlgebraicForm.</span>
 770 <span class="c">#</span>
 771 <span class="c"># For BinaryForm CalculationMode, the ordered list of processed final vector values containing the value or</span>
 772 <span class="c"># count of each unique value type is simply converted into a binary vector containing 1s and 0s</span>
 773 <span class="c"># corresponding to presence or absence of values before calculating similarity or distance between</span>
 774 <span class="c"># two vectors.</span>
 775 <span class="c">#</span>
 776 <span class="c"># For two fingerprint vectors A and B of same size containing OrderedNumericalValues, let:</span>
 777 <span class="c">#</span>
 778 <span class="c">#  N = Number values in A or B</span>
 779 <span class="c">#</span>
 780 <span class="c">#  Xa = Values of vector A</span>
 781 <span class="c">#  Xb = Values of vector B</span>
 782 <span class="c">#</span>
 783 <span class="c">#  Xai = Value of ith element in A</span>
 784 <span class="c">#  Xbi = Value of ith element in B</span>
 785 <span class="c">#</span>
 786 <span class="c">#  SUM = Sum of i over N values</span>
 787 <span class="c">#</span>
 788 <span class="c"># For SetTheoreticForm of calculation between two vectors, let:</span>
 789 <span class="c">#</span>
 790 <span class="c">#  SetIntersectionXaXb = SUM ( MIN ( Xai, Xbi ) )</span>
 791 <span class="c">#  SetDifferenceXaXb = SUM ( Xai ) + SUM ( Xbi ) - SUM ( MIN ( Xai, Xbi ) )</span>
 792 <span class="c">#</span>
 793 <span class="c"># For BinaryForm of calculation between two vectors, let:</span>
 794 <span class="c">#</span>
 795 <span class="c">#  Na = Number of bits set to &quot;1&quot; in A = SUM ( Xai )</span>
 796 <span class="c">#  Nb = Number of bits set to &quot;1&quot; in B = SUM ( Xbi )</span>
 797 <span class="c">#  Nc = Number of bits set to &quot;1&quot; in both A and B = SUM ( Xai * Xbi )</span>
 798 <span class="c">#  Nd = Number of bits set to &quot;0&quot; in both A and B = SUM ( 1 - Xai - Xbi + Xai * Xbi)</span>
 799 <span class="c">#</span>
 800 <span class="c">#  N = Number of bits set to &quot;1&quot; or &quot;0&quot; in A or B = Size of A or B = Na + Nb - Nc + Nd</span>
 801 <span class="c">#</span>
 802 <span class="c"># Additionally, for BinaryForm various values also correspond to:</span>
 803 <span class="c">#</span>
 804 <span class="c">#  Na = | Xa |</span>
 805 <span class="c">#  Nb = | Xb |</span>
 806 <span class="c">#  Nc = | SetIntersectionXaXb |</span>
 807 <span class="c">#  Nd = N - | SetDifferenceXaXb |</span>
 808 <span class="c">#</span>
 809 <span class="c">#  | SetDifferenceXaXb | = N - Nd = Na + Nb - Nc + Nd - Nd = Na + Nb - Nc</span>
 810 <span class="c">#                        =  | Xa | + | Xb | - | SetIntersectionXaXb |</span>
 811 <span class="c">#</span>
 812 <span class="c"># Various distance coefficients and similarity coefficients [ Ref 40, Ref 62, Ref 64 ] for a pair vectors A and B</span>
 813 <span class="c"># in AlgebraicForm and BinaryForm are defined as follows:</span>
 814 <span class="c">#</span>
 815 <span class="c"># . CityBlockDistanceCoefficient: ( same as HammingDistanceCoefficient and ManhattanDistanceCoefficient)</span>
 816 <span class="c">#</span>
 817 <span class="c">#     . AlgebraicForm: SUM ( ABS ( Xai - Xbi ) )</span>
 818 <span class="c">#</span>
 819 <span class="c">#     . BinaryForm: ( Na - Nc ) + ( Nb - Nc ) = Na + Nb - 2 * Nc</span>
 820 <span class="c">#</span>
 821 <span class="c">#     . SetTheoreticForm: | SetDifferenceXaXb | - | SetIntersectionXaXb |</span>
 822 <span class="c">#                        = SUM ( Xai ) + SUM ( Xbi ) - 2 * ( SUM ( MIN ( Xai, Xbi ) ) )</span>
 823 <span class="c">#</span>
 824 <span class="c"># . CosineSimilarityCoefficient:  ( same as OchiaiSimilarityCoefficient)</span>
 825 <span class="c">#</span>
 826 <span class="c">#     . AlgebraicForm: SUM ( Xai * Xbi ) / SQRT ( SUM ( Xai ** 2) * SUM ( Xbi ** 2) )</span>
 827 <span class="c">#</span>
 828 <span class="c">#     . BinaryForm: Nc / SQRT ( Na * Nb)</span>
 829 <span class="c">#</span>
 830 <span class="c">#     . SetTheoreticForm: | SetIntersectionXaXb | / SQRT ( |Xa| * |Xb| )</span>
 831 <span class="c">#                        = SUM ( MIN ( Xai, Xbi ) ) / SQRT ( SUM ( Xai ) * SUM ( Xbi ) )</span>
 832 <span class="c">#</span>
 833 <span class="c"># . CzekanowskiSimilarityCoefficient: ( same as DiceSimilarityCoefficient and SorensonSimilarityCoefficient)</span>
 834 <span class="c">#</span>
 835 <span class="c">#     . AlgebraicForm: ( 2 * ( SUM ( Xai * Xbi ) )  ) / ( SUM ( Xai ** 2) + SUM ( Xbi **2 ) )</span>
 836 <span class="c">#</span>
 837 <span class="c">#     . BinaryForm: 2 * Nc / ( Na + Nb )</span>
 838 <span class="c">#</span>
 839 <span class="c">#     . SetTheoreticForm: 2 * | SetIntersectionXaXb | / ( |Xa| + |Xb| )</span>
 840 <span class="c">#                        = 2 * ( SUM ( MIN ( Xai, Xbi ) ) ) / ( SUM ( Xai ) + SUM ( Xbi ) )</span>
 841 <span class="c">#</span>
 842 <span class="c"># . DiceSimilarityCoefficient: ( same as CzekanowskiSimilarityCoefficient and SorensonSimilarityCoefficient)</span>
 843 <span class="c">#</span>
 844 <span class="c">#     . AlgebraicForm: ( 2 * ( SUM ( Xai * Xbi ) )  ) / ( SUM ( Xai ** 2) + SUM ( Xbi **2 ) )</span>
 845 <span class="c">#</span>
 846 <span class="c">#     . BinaryForm: 2 * Nc / ( Na + Nb )</span>
 847 <span class="c">#</span>
 848 <span class="c">#     . SetTheoreticForm: 2 * | SetIntersectionXaXb | / ( |Xa| + |Xb| )</span>
 849 <span class="c">#                        = 2 * ( SUM ( MIN ( Xai, Xbi ) ) ) / ( SUM ( Xai ) + SUM ( Xbi ) )</span>
 850 <span class="c">#</span>
 851 <span class="c"># . EuclideanDistanceCoefficient:</span>
 852 <span class="c">#</span>
 853 <span class="c">#     . AlgebraicForm: SQRT ( SUM ( ( ( Xai - Xbi ) ** 2 ) ) )</span>
 854 <span class="c">#</span>
 855 <span class="c">#     . BinaryForm: SQRT ( ( Na - Nc ) + ( Nb - Nc ) ) = SQRT ( Na + Nb - 2 * Nc )</span>
 856 <span class="c">#</span>
 857 <span class="c">#     . SetTheoreticForm: SQRT ( | SetDifferenceXaXb | - | SetIntersectionXaXb | )</span>
 858 <span class="c">#                        = SQRT (  SUM ( Xai ) + SUM ( Xbi ) - 2 * ( SUM ( MIN ( Xai, Xbi ) ) ) )</span>
 859 <span class="c">#</span>
 860 <span class="c"># . HammingDistanceCoefficient:  ( same as CityBlockDistanceCoefficient and ManhattanDistanceCoefficient)</span>
 861 <span class="c">#</span>
 862 <span class="c">#     . AlgebraicForm: SUM ( ABS ( Xai - Xbi ) )</span>
 863 <span class="c">#</span>
 864 <span class="c">#     . BinaryForm: ( Na - Nc ) + ( Nb - Nc ) = Na + Nb - 2 * Nc</span>
 865 <span class="c">#</span>
 866 <span class="c">#     . SetTheoreticForm: | SetDifferenceXaXb | - | SetIntersectionXaXb |</span>
 867 <span class="c">#                        = SUM ( Xai ) + SUM ( Xbi ) - 2 * ( SUM ( MIN ( Xai, Xbi ) ) )</span>
 868 <span class="c">#</span>
 869 <span class="c"># . JaccardSimilarityCoefficient: ( same as TanimotoSimilarityCoefficient)</span>
 870 <span class="c">#</span>
 871 <span class="c">#     . AlgebraicForm:  SUM ( Xai * Xbi ) / ( SUM ( Xai ** 2 ) + SUM ( Xbi ** 2 ) - SUM ( Xai * Xbi ) )</span>
 872 <span class="c">#</span>
 873 <span class="c">#     . BinaryForm:  Nc / ( ( Na - Nc ) + ( Nb - Nc ) + Nc ) = Nc / ( Na + Nb - Nc )</span>
 874 <span class="c">#</span>
 875 <span class="c">#     . SetTheoreticForm: | SetIntersectionXaXb | / | SetDifferenceXaXb |</span>
 876 <span class="c">#                        = SUM ( MIN ( Xai, Xbi ) ) / (  SUM ( Xai ) + SUM ( Xbi ) - SUM ( MIN ( Xai, Xbi ) ) )</span>
 877 <span class="c">#</span>
 878 <span class="c"># . ManhattanDistanceCoefficient:  ( same as CityBlockDistanceCoefficient and HammingDistanceCoefficient)</span>
 879 <span class="c">#</span>
 880 <span class="c">#     . AlgebraicForm: SUM ( ABS ( Xai - Xbi ) )</span>
 881 <span class="c">#</span>
 882 <span class="c">#     . BinaryForm: ( Na - Nc ) + ( Nb - Nc ) = Na + Nb - 2 * Nc</span>
 883 <span class="c">#</span>
 884 <span class="c">#     . SetTheoreticForm: | SetDifferenceXaXb | - | SetIntersectionXaXb |</span>
 885 <span class="c">#                        = SUM ( Xai ) + SUM ( Xbi ) - 2 * ( SUM ( MIN ( Xai, Xbi ) ) )</span>
 886 <span class="c">#</span>
 887 <span class="c"># . OchiaiSimilarityCoefficient:  ( same as CosineSimilarityCoefficient)</span>
 888 <span class="c">#</span>
 889 <span class="c">#     . AlgebraicForm: SUM ( Xai * Xbi ) / SQRT ( SUM ( Xai ** 2) * SUM ( Xbi ** 2) )</span>
 890 <span class="c">#</span>
 891 <span class="c">#     . BinaryForm: Nc / SQRT ( Na * Nb)</span>
 892 <span class="c">#</span>
 893 <span class="c">#     . SetTheoreticForm: | SetIntersectionXaXb | / SQRT ( |Xa| * |Xb| )</span>
 894 <span class="c">#                        = SUM ( MIN ( Xai, Xbi ) ) / SQRT ( SUM ( Xai ) * SUM ( Xbi ) )</span>
 895 <span class="c">#</span>
 896 <span class="c"># . SorensonSimilarityCoefficient: ( same as CzekanowskiSimilarityCoefficient and DiceSimilarityCoefficient)</span>
 897 <span class="c">#</span>
 898 <span class="c">#     . AlgebraicForm: ( 2 * ( SUM ( Xai * Xbi ) )  ) / ( SUM ( Xai ** 2) + SUM ( Xbi **2 ) )</span>
 899 <span class="c">#</span>
 900 <span class="c">#     . BinaryForm: 2 * Nc / ( Na + Nb )</span>
 901 <span class="c">#</span>
 902 <span class="c">#     . SetTheoreticForm: 2 * | SetIntersectionXaXb | / ( |Xa| + |Xb| )</span>
 903 <span class="c">#                        = 2 * ( SUM ( MIN ( Xai, Xbi ) ) ) / ( SUM ( Xai ) + SUM ( Xbi ) )</span>
 904 <span class="c">#</span>
 905 <span class="c"># . SoergelDistanceCoefficient:</span>
 906 <span class="c">#</span>
 907 <span class="c">#     . AlgebraicForm:  SUM ( ABS ( Xai - Xbi ) ) / SUM ( MAX ( Xai, Xbi ) )</span>
 908 <span class="c">#</span>
 909 <span class="c">#     . BinaryForm: 1 - Nc / ( Na + Nb - Nc ) = ( Na + Nb - 2 * Nc ) / ( Na + Nb - Nc )</span>
 910 <span class="c">#</span>
 911 <span class="c">#     . SetTheoreticForm: ( | SetDifferenceXaXb | - | SetIntersectionXaXb | ) / | SetDifferenceXaXb |</span>
 912 <span class="c">#                        = ( SUM ( Xai ) + SUM ( Xbi ) - 2 * ( SUM ( MIN ( Xai, Xbi ) ) ) ) / ( SUM ( Xai ) + SUM ( Xbi ) - SUM ( MIN ( Xai, Xbi ) ) )</span>
 913 <span class="c">#</span>
 914 <span class="c"># . TanimotoSimilarityCoefficient:  ( same as JaccardSimilarityCoefficient)</span>
 915 <span class="c">#</span>
 916 <span class="c">#     . AlgebraicForm:  SUM ( Xai * Xbi ) / ( SUM ( Xai ** 2 ) + SUM ( Xbi ** 2 ) - SUM ( Xai * Xbi ) )</span>
 917 <span class="c">#</span>
 918 <span class="c">#     . BinaryForm:  Nc / ( ( Na - Nc ) + ( Nb - Nc ) + Nc ) = Nc / ( Na + Nb - Nc )</span>
 919 <span class="c">#</span>
 920 <span class="c">#     . SetTheoreticForm: | SetIntersectionXaXb | / | SetDifferenceXaXb |</span>
 921 <span class="c">#                        = SUM ( MIN ( Xai, Xbi ) ) / (  SUM ( Xai ) + SUM ( Xbi ) - SUM ( MIN ( Xai, Xbi ) ) )</span>
 922 <span class="c">#</span>
 923 <span class="c">#</span>
 924 
 925 <span class="c"># Calculate Hamming distance coefficient between two fingerprint vectors.</span>
 926 <span class="c">#</span>
 927 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 928 <span class="c">#</span>
<a name="HammingDistanceCoefficient-"></a> 929 <span class="k">sub </span><span class="m">HammingDistanceCoefficient ($$;$$)</span> <span class="s">{</span>
 930   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="cm">,</span> <span class="i">$CalculationMode</span><span class="cm">,</span> <span class="i">$SkipValuesCheck</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 931 
 932   <span class="k">return</span> <span class="i">CityBlockDistanceCoefficient</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="cm">,</span> <span class="i">$CalculationMode</span><span class="cm">,</span> <span class="i">$SkipValuesCheck</span><span class="s">)</span><span class="sc">;</span>
 933 <span class="s">}</span>
 934 
 935 <span class="c"># Calculate Hamming distance coefficient between two fingerprint vectors.</span>
 936 <span class="c">#</span>
 937 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 938 <span class="c">#</span>
<a name="ManhattanDistanceCoefficient-"></a> 939 <span class="k">sub </span><span class="m">ManhattanDistanceCoefficient ($$;$$)</span> <span class="s">{</span>
 940   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="cm">,</span> <span class="i">$CalculationMode</span><span class="cm">,</span> <span class="i">$SkipValuesCheck</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 941 
 942   <span class="k">return</span> <span class="i">CityBlockDistanceCoefficient</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="cm">,</span> <span class="i">$CalculationMode</span><span class="cm">,</span> <span class="i">$SkipValuesCheck</span><span class="s">)</span><span class="sc">;</span>
 943 <span class="s">}</span>
 944 
 945 <span class="c"># Calculate CityBlock distance coefficient between two fingerprint vectors.</span>
 946 <span class="c">#</span>
 947 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 948 <span class="c">#</span>
<a name="CityBlockDistanceCoefficient-"></a> 949 <span class="k">sub </span><span class="m">CityBlockDistanceCoefficient ($$;$$)</span> <span class="s">{</span>
 950   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="cm">,</span> <span class="i">$CalculationMode</span><span class="cm">,</span> <span class="i">$SkipValuesCheck</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 951 
 952   <span class="i">$CalculationMode</span> = <span class="k">defined</span> <span class="i">$CalculationMode</span> ? <span class="i">$CalculationMode</span> <span class="co">:</span> <span class="q">&#39;AlgebraicForm&#39;</span><span class="sc">;</span>
 953   <span class="i">$SkipValuesCheck</span> = <span class="k">defined</span> <span class="i">$SkipValuesCheck</span> ? <span class="i">$SkipValuesCheck</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 954 
 955   <span class="c"># Validate and process fingerprints vectors for similarity calculations...</span>
 956   <span class="c">#</span>
 957   <span class="i">_ValidateAndProcessFingerprintsVectorsForSimilarityCalculation</span><span class="s">(</span><span class="q">&quot;CityBlockDistanceCoefficient: Calculation failed&quot;</span><span class="cm">,</span> <span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="cm">,</span> <span class="i">$CalculationMode</span><span class="cm">,</span> <span class="i">$SkipValuesCheck</span><span class="s">)</span><span class="sc">;</span>
 958 
 959   <span class="c"># Perform the calculation...</span>
 960   <span class="k">if</span> <span class="s">(</span><span class="i">$CalculationMode</span> =~ <span class="q">/^AlgebraicForm$/i</span><span class="s">)</span> <span class="s">{</span>
 961     <span class="k">return</span> <span class="i">_CityBlockDistanceCoefficientUsingAlgebraicForm</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
 962   <span class="s">}</span>
 963   <span class="k">elsif</span> <span class="s">(</span><span class="i">$CalculationMode</span> =~ <span class="q">/^BinaryForm$/i</span><span class="s">)</span> <span class="s">{</span>
 964     <span class="k">return</span> <span class="i">_CityBlockDistanceCoefficientUsingBinaryForm</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
 965   <span class="s">}</span>
 966   <span class="k">elsif</span> <span class="s">(</span><span class="i">$CalculationMode</span> =~ <span class="q">/^SetTheoreticForm$/i</span><span class="s">)</span> <span class="s">{</span>
 967     <span class="k">return</span> <span class="i">_CityBlockDistanceCoefficientUsingSetTheoreticForm</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
 968   <span class="s">}</span>
 969   <span class="k">else</span> <span class="s">{</span>
 970     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
 971   <span class="s">}</span>
 972 <span class="s">}</span>
 973 
 974 <span class="c"># Calculate CityBlock distance coefficient using algebraic form...</span>
 975 <span class="c">#</span>
<a name="_CityBlockDistanceCoefficientUsingAlgebraicForm-"></a> 976 <span class="k">sub </span><span class="m">_CityBlockDistanceCoefficientUsingAlgebraicForm</span> <span class="s">{</span>
 977   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 978   <span class="k">my</span><span class="s">(</span><span class="i">$SumAbsSubtractionXaiXbi</span><span class="s">)</span><span class="sc">;</span>
 979 
 980   <span class="i">$SumAbsSubtractionXaiXbi</span> = <span class="i">_GetSumOfAbsoluteValueOfSubtractionOfFingerprintsOrderedValues</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
 981 
 982   <span class="k">return</span> <span class="i">$SumAbsSubtractionXaiXbi</span><span class="sc">;</span>
 983 <span class="s">}</span>
 984 
 985 <span class="c"># Calculate CityBlock distance coefficient using binary form...</span>
 986 <span class="c">#</span>
<a name="_CityBlockDistanceCoefficientUsingBinaryForm-"></a> 987 <span class="k">sub </span><span class="m">_CityBlockDistanceCoefficientUsingBinaryForm</span> <span class="s">{</span>
 988   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 989   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span><span class="sc">;</span>
 990 
 991   <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span> = <span class="i">_GetNumOfIndividualAndCommonSetBits</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
 992 
 993   <span class="k">return</span>  <span class="s">(</span><span class="i">$Na</span> + <span class="i">$Nb</span> - <span class="n">2</span> * <span class="i">$Nc</span><span class="s">)</span><span class="sc">;</span>
 994 <span class="s">}</span>
 995 
 996 <span class="c"># Calculate  CityBlock distance coefficient using set theoretic form...</span>
 997 <span class="c">#</span>
<a name="_CityBlockDistanceCoefficientUsingSetTheoreticForm-"></a> 998 <span class="k">sub </span><span class="m">_CityBlockDistanceCoefficientUsingSetTheoreticForm</span> <span class="s">{</span>
 999   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1000   <span class="k">my</span><span class="s">(</span><span class="i">$SumMinXaiXbi</span><span class="cm">,</span> <span class="i">$SumXai</span><span class="cm">,</span> <span class="i">$SumXbi</span><span class="s">)</span><span class="sc">;</span>
1001 
1002   <span class="i">$SumXai</span> = <span class="i">_GetSumOfFingerprintsOrderedValues</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="s">)</span><span class="sc">;</span>
1003   <span class="i">$SumXbi</span> = <span class="i">_GetSumOfFingerprintsOrderedValues</span><span class="s">(</span><span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1004   <span class="i">$SumMinXaiXbi</span> = <span class="i">_GetSumOfMinimumOfFingerprintsOrderdedValues</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1005 
1006   <span class="k">return</span>  <span class="s">(</span><span class="i">$SumXai</span> + <span class="i">$SumXbi</span> - <span class="n">2</span> * <span class="i">$SumMinXaiXbi</span><span class="s">)</span><span class="sc">;</span>
1007 <span class="s">}</span>
1008 
1009 <span class="c"># Calculate Ochiai similarity cofficient between two fingerprint vectors.</span>
1010 <span class="c">#</span>
1011 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
1012 <span class="c">#</span>
<a name="OchiaiSimilarityCoefficient-"></a>1013 <span class="k">sub </span><span class="m">OchiaiSimilarityCoefficient ($$;$$)</span> <span class="s">{</span>
1014   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="cm">,</span> <span class="i">$CalculationMode</span><span class="cm">,</span> <span class="i">$SkipValuesCheck</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1015 
1016   <span class="k">return</span> <span class="i">CosineSimilarityCoefficient</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="cm">,</span> <span class="i">$CalculationMode</span><span class="cm">,</span> <span class="i">$SkipValuesCheck</span><span class="s">)</span><span class="sc">;</span>
1017 <span class="s">}</span>
1018 
1019 <span class="c"># Calculate Cosine similarity cofficient between two fingerprint vectors.</span>
1020 <span class="c">#</span>
1021 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
1022 <span class="c">#</span>
<a name="CosineSimilarityCoefficient-"></a>1023 <span class="k">sub </span><span class="m">CosineSimilarityCoefficient ($$;$$)</span> <span class="s">{</span>
1024   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="cm">,</span> <span class="i">$CalculationMode</span><span class="cm">,</span> <span class="i">$SkipValuesCheck</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1025 
1026   <span class="i">$CalculationMode</span> = <span class="k">defined</span> <span class="i">$CalculationMode</span> ? <span class="i">$CalculationMode</span> <span class="co">:</span> <span class="q">&#39;AlgebraicForm&#39;</span><span class="sc">;</span>
1027   <span class="i">$SkipValuesCheck</span> = <span class="k">defined</span> <span class="i">$SkipValuesCheck</span> ? <span class="i">$SkipValuesCheck</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
1028 
1029   <span class="c"># Validate and process fingerprints vectors for similarity calculations...</span>
1030   <span class="c">#</span>
1031   <span class="i">_ValidateAndProcessFingerprintsVectorsForSimilarityCalculation</span><span class="s">(</span><span class="q">&quot;CosineSimilarityCoefficient: Calculation failed&quot;</span><span class="cm">,</span> <span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="cm">,</span> <span class="i">$CalculationMode</span><span class="cm">,</span> <span class="i">$SkipValuesCheck</span><span class="s">)</span><span class="sc">;</span>
1032 
1033   <span class="c"># Perform the calculation...</span>
1034   <span class="k">if</span> <span class="s">(</span><span class="i">$CalculationMode</span> =~ <span class="q">/^AlgebraicForm$/i</span><span class="s">)</span> <span class="s">{</span>
1035     <span class="k">return</span> <span class="i">_CosineSimilarityCoefficientUsingAlgebraicForm</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1036   <span class="s">}</span>
1037   <span class="k">elsif</span> <span class="s">(</span><span class="i">$CalculationMode</span> =~ <span class="q">/^BinaryForm$/i</span><span class="s">)</span> <span class="s">{</span>
1038     <span class="k">return</span> <span class="i">_CosineSimilarityCoefficientUsingBinaryForm</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1039   <span class="s">}</span>
1040   <span class="k">elsif</span> <span class="s">(</span><span class="i">$CalculationMode</span> =~ <span class="q">/^SetTheoreticForm$/i</span><span class="s">)</span> <span class="s">{</span>
1041     <span class="k">return</span> <span class="i">_CosineSimilarityCoefficientUsingSetTheoreticForm</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1042   <span class="s">}</span>
1043   <span class="k">else</span> <span class="s">{</span>
1044     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
1045   <span class="s">}</span>
1046 <span class="s">}</span>
1047 
1048 <span class="c"># Calculate Cosine similarity coefficient using algebraic form...</span>
1049 <span class="c">#</span>
<a name="_CosineSimilarityCoefficientUsingAlgebraicForm-"></a>1050 <span class="k">sub </span><span class="m">_CosineSimilarityCoefficientUsingAlgebraicForm</span> <span class="s">{</span>
1051   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1052   <span class="k">my</span><span class="s">(</span><span class="i">$SumProductXaiXbi</span><span class="cm">,</span> <span class="i">$SumXai2</span><span class="cm">,</span> <span class="i">$SumXbi2</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
1053 
1054   <span class="i">$SumXai2</span> = <span class="i">_GetSumOfSquaresOfFingerprintsOrderedValues</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="s">)</span><span class="sc">;</span>
1055   <span class="i">$SumXbi2</span> = <span class="i">_GetSumOfSquaresOfFingerprintsOrderedValues</span><span class="s">(</span><span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1056   <span class="i">$SumProductXaiXbi</span> = <span class="i">_GetSumOfProductOfFingerprintsOrderedValues</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1057 
1058   <span class="i">$Numerator</span> = <span class="i">$SumProductXaiXbi</span><span class="sc">;</span>
1059   <span class="i">$Denominator</span> = <span class="k">sqrt</span><span class="s">(</span><span class="i">$SumXai2</span> * <span class="i">$SumXbi2</span><span class="s">)</span><span class="sc">;</span>
1060 
1061   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
1062 <span class="s">}</span>
1063 
1064 <span class="c"># CalculateCosine similarity coefficient using binary form...</span>
1065 <span class="c">#</span>
<a name="_CosineSimilarityCoefficientUsingBinaryForm-"></a>1066 <span class="k">sub </span><span class="m">_CosineSimilarityCoefficientUsingBinaryForm</span> <span class="s">{</span>
1067   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1068   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
1069 
1070   <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span> = <span class="i">_GetNumOfIndividualAndCommonSetBits</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1071 
1072   <span class="i">$Numerator</span> = <span class="i">$Nc</span><span class="sc">;</span>
1073   <span class="i">$Denominator</span> = <span class="k">sqrt</span><span class="s">(</span><span class="i">$Na</span> * <span class="i">$Nb</span><span class="s">)</span><span class="sc">;</span>
1074 
1075   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
1076 <span class="s">}</span>
1077 
1078 <span class="c"># Calculate Cosine similarity coefficient using set theoretic form...</span>
1079 <span class="c">#</span>
<a name="_CosineSimilarityCoefficientUsingSetTheoreticForm-"></a>1080 <span class="k">sub </span><span class="m">_CosineSimilarityCoefficientUsingSetTheoreticForm</span> <span class="s">{</span>
1081   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1082   <span class="k">my</span><span class="s">(</span><span class="i">$SumMinXaiXbi</span><span class="cm">,</span> <span class="i">$SumXai</span><span class="cm">,</span> <span class="i">$SumXbi</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
1083 
1084   <span class="i">$SumXai</span> = <span class="i">_GetSumOfFingerprintsOrderedValues</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="s">)</span><span class="sc">;</span>
1085   <span class="i">$SumXbi</span> = <span class="i">_GetSumOfFingerprintsOrderedValues</span><span class="s">(</span><span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1086   <span class="i">$SumMinXaiXbi</span> = <span class="i">_GetSumOfMinimumOfFingerprintsOrderdedValues</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1087 
1088   <span class="i">$Numerator</span> = <span class="i">$SumMinXaiXbi</span><span class="sc">;</span>
1089   <span class="i">$Denominator</span> = <span class="k">sqrt</span><span class="s">(</span><span class="i">$SumXai</span> * <span class="i">$SumXbi</span><span class="s">)</span><span class="sc">;</span>
1090 
1091   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
1092 <span class="s">}</span>
1093 
1094 <span class="c"># Calculate Czekanowski similarity cofficient between two fingerprint vectors.</span>
1095 <span class="c">#</span>
1096 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
1097 <span class="c">#</span>
<a name="CzekanowskiSimilarityCoefficient-"></a>1098 <span class="k">sub </span><span class="m">CzekanowskiSimilarityCoefficient ($$;$$)</span> <span class="s">{</span>
1099   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="cm">,</span> <span class="i">$CalculationMode</span><span class="cm">,</span> <span class="i">$SkipValuesCheck</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1100 
1101   <span class="k">return</span> <span class="i">DiceSimilarityCoefficient</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="cm">,</span> <span class="i">$CalculationMode</span><span class="cm">,</span> <span class="i">$SkipValuesCheck</span><span class="s">)</span><span class="sc">;</span>
1102 <span class="s">}</span>
1103 
1104 <span class="c"># Calculate Sorenson similarity cofficient between two fingerprint vectors.</span>
1105 <span class="c">#</span>
1106 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
1107 <span class="c">#</span>
<a name="SorensonSimilarityCoefficient-"></a>1108 <span class="k">sub </span><span class="m">SorensonSimilarityCoefficient ($$;$$)</span> <span class="s">{</span>
1109   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="cm">,</span> <span class="i">$CalculationMode</span><span class="cm">,</span> <span class="i">$SkipValuesCheck</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1110 
1111   <span class="k">return</span> <span class="i">DiceSimilarityCoefficient</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="cm">,</span> <span class="i">$CalculationMode</span><span class="cm">,</span> <span class="i">$SkipValuesCheck</span><span class="s">)</span><span class="sc">;</span>
1112 <span class="s">}</span>
1113 
1114 <span class="c"># Calculate Dice similarity cofficient between two fingerprint vectors.</span>
1115 <span class="c">#</span>
1116 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
1117 <span class="c">#</span>
<a name="DiceSimilarityCoefficient-"></a>1118 <span class="k">sub </span><span class="m">DiceSimilarityCoefficient ($$;$$)</span> <span class="s">{</span>
1119   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="cm">,</span> <span class="i">$CalculationMode</span><span class="cm">,</span> <span class="i">$SkipValuesCheck</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1120 
1121   <span class="i">$CalculationMode</span> = <span class="k">defined</span> <span class="i">$CalculationMode</span> ? <span class="i">$CalculationMode</span> <span class="co">:</span> <span class="q">&#39;AlgebraicForm&#39;</span><span class="sc">;</span>
1122   <span class="i">$SkipValuesCheck</span> = <span class="k">defined</span> <span class="i">$SkipValuesCheck</span> ? <span class="i">$SkipValuesCheck</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
1123 
1124   <span class="c"># Validate and process fingerprints vectors for similarity calculations...</span>
1125   <span class="c">#</span>
1126   <span class="i">_ValidateAndProcessFingerprintsVectorsForSimilarityCalculation</span><span class="s">(</span><span class="q">&quot;DiceSimilarityCoefficient: Calculation failed&quot;</span><span class="cm">,</span> <span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="cm">,</span> <span class="i">$CalculationMode</span><span class="cm">,</span> <span class="i">$SkipValuesCheck</span><span class="s">)</span><span class="sc">;</span>
1127 
1128   <span class="c"># Perform the calculation...</span>
1129   <span class="k">if</span> <span class="s">(</span><span class="i">$CalculationMode</span> =~ <span class="q">/^AlgebraicForm$/i</span><span class="s">)</span> <span class="s">{</span>
1130     <span class="k">return</span> <span class="i">_DiceSimilarityCoefficientUsingAlgebraicForm</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1131   <span class="s">}</span>
1132   <span class="k">elsif</span> <span class="s">(</span><span class="i">$CalculationMode</span> =~ <span class="q">/^BinaryForm$/i</span><span class="s">)</span> <span class="s">{</span>
1133     <span class="k">return</span> <span class="i">_DiceSimilarityCoefficientUsingBinaryForm</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1134   <span class="s">}</span>
1135   <span class="k">elsif</span> <span class="s">(</span><span class="i">$CalculationMode</span> =~ <span class="q">/^SetTheoreticForm$/i</span><span class="s">)</span> <span class="s">{</span>
1136     <span class="k">return</span> <span class="i">_DiceSimilarityCoefficientUsingSetTheoreticForm</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1137   <span class="s">}</span>
1138   <span class="k">else</span> <span class="s">{</span>
1139     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
1140   <span class="s">}</span>
1141 <span class="s">}</span>
1142 
1143 <span class="c"># Calculate Dice similarity coefficient using algebraic form...</span>
1144 <span class="c">#</span>
<a name="_DiceSimilarityCoefficientUsingAlgebraicForm-"></a>1145 <span class="k">sub </span><span class="m">_DiceSimilarityCoefficientUsingAlgebraicForm</span> <span class="s">{</span>
1146   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1147   <span class="k">my</span><span class="s">(</span><span class="i">$SumProductXaiXbi</span><span class="cm">,</span> <span class="i">$SumXai2</span><span class="cm">,</span> <span class="i">$SumXbi2</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
1148 
1149   <span class="i">$SumXai2</span> = <span class="i">_GetSumOfSquaresOfFingerprintsOrderedValues</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="s">)</span><span class="sc">;</span>
1150   <span class="i">$SumXbi2</span> = <span class="i">_GetSumOfSquaresOfFingerprintsOrderedValues</span><span class="s">(</span><span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1151   <span class="i">$SumProductXaiXbi</span> = <span class="i">_GetSumOfProductOfFingerprintsOrderedValues</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1152 
1153   <span class="i">$Numerator</span> = <span class="n">2</span> * <span class="i">$SumProductXaiXbi</span><span class="sc">;</span>
1154   <span class="i">$Denominator</span> = <span class="i">$SumXai2</span> + <span class="i">$SumXbi2</span><span class="sc">;</span>
1155 
1156   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
1157 <span class="s">}</span>
1158 
1159 <span class="c"># Calculate Dice similarity coefficient using binary form...</span>
1160 <span class="c">#</span>
<a name="_DiceSimilarityCoefficientUsingBinaryForm-"></a>1161 <span class="k">sub </span><span class="m">_DiceSimilarityCoefficientUsingBinaryForm</span> <span class="s">{</span>
1162   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1163   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
1164 
1165   <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span> = <span class="i">_GetNumOfIndividualAndCommonSetBits</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1166 
1167   <span class="i">$Numerator</span> = <span class="n">2</span> * <span class="i">$Nc</span><span class="sc">;</span>
1168   <span class="i">$Denominator</span> = <span class="i">$Na</span> + <span class="i">$Nb</span><span class="sc">;</span>
1169 
1170   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
1171 <span class="s">}</span>
1172 
1173 <span class="c"># Calculate Dice similarity coefficient using set theoretic form...</span>
1174 <span class="c">#</span>
<a name="_DiceSimilarityCoefficientUsingSetTheoreticForm-"></a>1175 <span class="k">sub </span><span class="m">_DiceSimilarityCoefficientUsingSetTheoreticForm</span> <span class="s">{</span>
1176   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1177   <span class="k">my</span><span class="s">(</span><span class="i">$SumMinXaiXbi</span><span class="cm">,</span> <span class="i">$SumXai</span><span class="cm">,</span> <span class="i">$SumXbi</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
1178 
1179   <span class="i">$SumXai</span> = <span class="i">_GetSumOfFingerprintsOrderedValues</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="s">)</span><span class="sc">;</span>
1180   <span class="i">$SumXbi</span> = <span class="i">_GetSumOfFingerprintsOrderedValues</span><span class="s">(</span><span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1181   <span class="i">$SumMinXaiXbi</span> = <span class="i">_GetSumOfMinimumOfFingerprintsOrderdedValues</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1182 
1183   <span class="i">$Numerator</span> = <span class="n">2</span> * <span class="i">$SumMinXaiXbi</span><span class="sc">;</span>
1184   <span class="i">$Denominator</span> = <span class="i">$SumXai</span> + <span class="i">$SumXbi</span><span class="sc">;</span>
1185 
1186   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
1187 <span class="s">}</span>
1188 
1189 
1190 <span class="c"># Calculate Euclidean distance coefficient between two fingerprint vectors.</span>
1191 <span class="c">#</span>
1192 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
1193 <span class="c">#</span>
<a name="EuclideanDistanceCoefficient-"></a>1194 <span class="k">sub </span><span class="m">EuclideanDistanceCoefficient ($$;$$)</span> <span class="s">{</span>
1195   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="cm">,</span> <span class="i">$CalculationMode</span><span class="cm">,</span> <span class="i">$SkipValuesCheck</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1196 
1197   <span class="i">$CalculationMode</span> = <span class="k">defined</span> <span class="i">$CalculationMode</span> ? <span class="i">$CalculationMode</span> <span class="co">:</span> <span class="q">&#39;AlgebraicForm&#39;</span><span class="sc">;</span>
1198   <span class="i">$SkipValuesCheck</span> = <span class="k">defined</span> <span class="i">$SkipValuesCheck</span> ? <span class="i">$SkipValuesCheck</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
1199 
1200   <span class="c"># Validate and process fingerprints vectors for similarity calculations...</span>
1201   <span class="c">#</span>
1202   <span class="i">_ValidateAndProcessFingerprintsVectorsForSimilarityCalculation</span><span class="s">(</span><span class="q">&quot;EuclideanDistanceCoefficient: Calculation failed&quot;</span><span class="cm">,</span> <span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="cm">,</span> <span class="i">$CalculationMode</span><span class="cm">,</span> <span class="i">$SkipValuesCheck</span><span class="s">)</span><span class="sc">;</span>
1203 
1204   <span class="c"># Perform the calculation...</span>
1205   <span class="k">if</span> <span class="s">(</span><span class="i">$CalculationMode</span> =~ <span class="q">/^AlgebraicForm$/i</span><span class="s">)</span> <span class="s">{</span>
1206     <span class="k">return</span> <span class="i">_EuclideanDistanceCoefficientUsingAlgebraicForm</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1207   <span class="s">}</span>
1208   <span class="k">elsif</span> <span class="s">(</span><span class="i">$CalculationMode</span> =~ <span class="q">/^BinaryForm$/i</span><span class="s">)</span> <span class="s">{</span>
1209     <span class="k">return</span> <span class="i">_EuclideanDistanceCoefficientUsingBinaryForm</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1210   <span class="s">}</span>
1211   <span class="k">elsif</span> <span class="s">(</span><span class="i">$CalculationMode</span> =~ <span class="q">/^SetTheoreticForm$/i</span><span class="s">)</span> <span class="s">{</span>
1212     <span class="k">return</span> <span class="i">_EuclideanDistanceCoefficientUsingSetTheoreticForm</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1213   <span class="s">}</span>
1214   <span class="k">else</span> <span class="s">{</span>
1215     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
1216   <span class="s">}</span>
1217 <span class="s">}</span>
1218 
1219 <span class="c"># Calculate Euclidean distance coefficient using algebraic form...</span>
1220 <span class="c">#</span>
<a name="_EuclideanDistanceCoefficientUsingAlgebraicForm-"></a>1221 <span class="k">sub </span><span class="m">_EuclideanDistanceCoefficientUsingAlgebraicForm</span> <span class="s">{</span>
1222   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1223   <span class="k">my</span><span class="s">(</span><span class="i">$SumSquaresSubtractionXaiXbi</span><span class="s">)</span><span class="sc">;</span>
1224 
1225   <span class="i">$SumSquaresSubtractionXaiXbi</span> = <span class="i">_GetSumOfSquaresOfSubtractionOfFingerprintsOrderedValues</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1226 
1227   <span class="k">return</span> <span class="k">sqrt</span><span class="s">(</span><span class="i">$SumSquaresSubtractionXaiXbi</span><span class="s">)</span><span class="sc">;</span>
1228 <span class="s">}</span>
1229 
1230 <span class="c"># Calculate Euclidean distance coefficient using binary form...</span>
1231 <span class="c">#</span>
<a name="_EuclideanDistanceCoefficientUsingBinaryForm-"></a>1232 <span class="k">sub </span><span class="m">_EuclideanDistanceCoefficientUsingBinaryForm</span> <span class="s">{</span>
1233   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1234   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span><span class="sc">;</span>
1235 
1236   <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span> = <span class="i">_GetNumOfIndividualAndCommonSetBits</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1237 
1238   <span class="k">return</span>  <span class="s">(</span><span class="k">sqrt</span><span class="s">(</span><span class="i">$Na</span> + <span class="i">$Nb</span> - <span class="n">2</span> * <span class="i">$Nc</span><span class="s">)</span><span class="s">)</span><span class="sc">;</span>
1239 <span class="s">}</span>
1240 
1241 <span class="c"># Calculate Euclidean distance coefficient using set theoretic form...</span>
1242 <span class="c">#</span>
<a name="_EuclideanDistanceCoefficientUsingSetTheoreticForm-"></a>1243 <span class="k">sub </span><span class="m">_EuclideanDistanceCoefficientUsingSetTheoreticForm</span> <span class="s">{</span>
1244   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1245   <span class="k">my</span><span class="s">(</span><span class="i">$SumMinXaiXbi</span><span class="cm">,</span> <span class="i">$SumXai</span><span class="cm">,</span> <span class="i">$SumXbi</span><span class="s">)</span><span class="sc">;</span>
1246 
1247   <span class="i">$SumXai</span> = <span class="i">_GetSumOfFingerprintsOrderedValues</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="s">)</span><span class="sc">;</span>
1248   <span class="i">$SumXbi</span> = <span class="i">_GetSumOfFingerprintsOrderedValues</span><span class="s">(</span><span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1249   <span class="i">$SumMinXaiXbi</span> = <span class="i">_GetSumOfMinimumOfFingerprintsOrderdedValues</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1250 
1251   <span class="k">return</span>  <span class="s">(</span><span class="k">sqrt</span><span class="s">(</span><span class="i">$SumXai</span> + <span class="i">$SumXbi</span> - <span class="n">2</span> * <span class="i">$SumMinXaiXbi</span><span class="s">)</span><span class="s">)</span><span class="sc">;</span>
1252 <span class="s">}</span>
1253 
1254 <span class="c"># Calculate Jaccard similarity cofficient between two fingerprint vectors.</span>
1255 <span class="c">#</span>
1256 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
1257 <span class="c">#</span>
<a name="JaccardSimilarityCoefficient-"></a>1258 <span class="k">sub </span><span class="m">JaccardSimilarityCoefficient ($$;$$)</span> <span class="s">{</span>
1259   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="cm">,</span> <span class="i">$CalculationMode</span><span class="cm">,</span> <span class="i">$SkipValuesCheck</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1260 
1261   <span class="k">return</span> <span class="i">TanimotoSimilarityCoefficient</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="cm">,</span> <span class="i">$CalculationMode</span><span class="cm">,</span> <span class="i">$SkipValuesCheck</span><span class="s">)</span><span class="sc">;</span>
1262 <span class="s">}</span>
1263 
1264 <span class="c"># Calculate Tanimoto similarity cofficient between two fingerprint vectors.</span>
1265 <span class="c">#</span>
1266 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
1267 <span class="c">#</span>
<a name="TanimotoSimilarityCoefficient-"></a>1268 <span class="k">sub </span><span class="m">TanimotoSimilarityCoefficient ($$;$$)</span> <span class="s">{</span>
1269   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="cm">,</span> <span class="i">$CalculationMode</span><span class="cm">,</span> <span class="i">$SkipValuesCheck</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1270 
1271   <span class="i">$CalculationMode</span> = <span class="k">defined</span> <span class="i">$CalculationMode</span> ? <span class="i">$CalculationMode</span> <span class="co">:</span> <span class="q">&#39;AlgebraicForm&#39;</span><span class="sc">;</span>
1272   <span class="i">$SkipValuesCheck</span> = <span class="k">defined</span> <span class="i">$SkipValuesCheck</span> ? <span class="i">$SkipValuesCheck</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
1273 
1274   <span class="c"># Validate and process fingerprints vectors for similarity calculations...</span>
1275   <span class="c">#</span>
1276   <span class="i">_ValidateAndProcessFingerprintsVectorsForSimilarityCalculation</span><span class="s">(</span><span class="q">&quot;TanimotoSimilarityCoefficient: Calculation failed&quot;</span><span class="cm">,</span> <span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="cm">,</span> <span class="i">$CalculationMode</span><span class="cm">,</span> <span class="i">$SkipValuesCheck</span><span class="s">)</span><span class="sc">;</span>
1277 
1278   <span class="c"># Perform the calculation...</span>
1279   <span class="k">if</span> <span class="s">(</span><span class="i">$CalculationMode</span> =~ <span class="q">/^AlgebraicForm$/i</span><span class="s">)</span> <span class="s">{</span>
1280     <span class="k">return</span> <span class="i">_TanimotoSimilarityCoefficientUsingAlgebraicForm</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1281   <span class="s">}</span>
1282   <span class="k">elsif</span> <span class="s">(</span><span class="i">$CalculationMode</span> =~ <span class="q">/^BinaryForm$/i</span><span class="s">)</span> <span class="s">{</span>
1283     <span class="k">return</span> <span class="i">_TanimotoSimilarityCoefficientUsingBinaryForm</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1284   <span class="s">}</span>
1285   <span class="k">elsif</span> <span class="s">(</span><span class="i">$CalculationMode</span> =~ <span class="q">/^SetTheoreticForm$/i</span><span class="s">)</span> <span class="s">{</span>
1286     <span class="k">return</span> <span class="i">_TanimotoSimilarityCoefficientUsingSetTheoreticForm</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1287   <span class="s">}</span>
1288   <span class="k">else</span> <span class="s">{</span>
1289     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
1290   <span class="s">}</span>
1291 <span class="s">}</span>
1292 
1293 <span class="c"># Calculate Tanimoto similarity coefficient using algebraic form...</span>
1294 <span class="c">#</span>
<a name="_TanimotoSimilarityCoefficientUsingAlgebraicForm-"></a>1295 <span class="k">sub </span><span class="m">_TanimotoSimilarityCoefficientUsingAlgebraicForm</span> <span class="s">{</span>
1296   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1297   <span class="k">my</span><span class="s">(</span><span class="i">$SumProductXaiXbi</span><span class="cm">,</span> <span class="i">$SumXai2</span><span class="cm">,</span> <span class="i">$SumXbi2</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
1298 
1299   <span class="i">$SumXai2</span> = <span class="i">_GetSumOfSquaresOfFingerprintsOrderedValues</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="s">)</span><span class="sc">;</span>
1300   <span class="i">$SumXbi2</span> = <span class="i">_GetSumOfSquaresOfFingerprintsOrderedValues</span><span class="s">(</span><span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1301   <span class="i">$SumProductXaiXbi</span> = <span class="i">_GetSumOfProductOfFingerprintsOrderedValues</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1302 
1303   <span class="i">$Numerator</span> = <span class="i">$SumProductXaiXbi</span><span class="sc">;</span>
1304   <span class="i">$Denominator</span> = <span class="i">$SumXai2</span> + <span class="i">$SumXbi2</span> - <span class="i">$SumProductXaiXbi</span><span class="sc">;</span>
1305 
1306   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
1307 <span class="s">}</span>
1308 
1309 <span class="c"># Calculate Tanimoto similarity coefficient using binary form...</span>
1310 <span class="c">#</span>
<a name="_TanimotoSimilarityCoefficientUsingBinaryForm-"></a>1311 <span class="k">sub </span><span class="m">_TanimotoSimilarityCoefficientUsingBinaryForm</span> <span class="s">{</span>
1312   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1313   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
1314 
1315   <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span> = <span class="i">_GetNumOfIndividualAndCommonSetBits</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1316 
1317   <span class="i">$Numerator</span> = <span class="i">$Nc</span><span class="sc">;</span>
1318   <span class="i">$Denominator</span> = <span class="i">$Na</span> + <span class="i">$Nb</span> - <span class="i">$Nc</span><span class="sc">;</span>
1319 
1320   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
1321 <span class="s">}</span>
1322 
1323 <span class="c"># Calculate Tanimoto similarity coefficient using set theoretic form...</span>
1324 <span class="c">#</span>
<a name="_TanimotoSimilarityCoefficientUsingSetTheoreticForm-"></a>1325 <span class="k">sub </span><span class="m">_TanimotoSimilarityCoefficientUsingSetTheoreticForm</span> <span class="s">{</span>
1326   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1327   <span class="k">my</span><span class="s">(</span><span class="i">$SumMinXaiXbi</span><span class="cm">,</span> <span class="i">$SumXai</span><span class="cm">,</span> <span class="i">$SumXbi</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
1328 
1329   <span class="i">$SumXai</span> = <span class="i">_GetSumOfFingerprintsOrderedValues</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="s">)</span><span class="sc">;</span>
1330   <span class="i">$SumXbi</span> = <span class="i">_GetSumOfFingerprintsOrderedValues</span><span class="s">(</span><span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1331   <span class="i">$SumMinXaiXbi</span> = <span class="i">_GetSumOfMinimumOfFingerprintsOrderdedValues</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1332 
1333   <span class="i">$Numerator</span> = <span class="i">$SumMinXaiXbi</span><span class="sc">;</span>
1334   <span class="i">$Denominator</span> = <span class="i">$SumXai</span> + <span class="i">$SumXbi</span> - <span class="i">$SumMinXaiXbi</span><span class="sc">;</span>
1335 
1336   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
1337 <span class="s">}</span>
1338 
1339 
1340 <span class="c"># Calculate Soergel distance coefficient between two fingerprint vectors.</span>
1341 <span class="c">#</span>
1342 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
1343 <span class="c">#</span>
<a name="SoergelDistanceCoefficient-"></a>1344 <span class="k">sub </span><span class="m">SoergelDistanceCoefficient ($$;$$)</span> <span class="s">{</span>
1345   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="cm">,</span> <span class="i">$CalculationMode</span><span class="cm">,</span> <span class="i">$SkipValuesCheck</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1346 
1347   <span class="i">$CalculationMode</span> = <span class="k">defined</span> <span class="i">$CalculationMode</span> ? <span class="i">$CalculationMode</span> <span class="co">:</span> <span class="q">&#39;AlgebraicForm&#39;</span><span class="sc">;</span>
1348   <span class="i">$SkipValuesCheck</span> = <span class="k">defined</span> <span class="i">$SkipValuesCheck</span> ? <span class="i">$SkipValuesCheck</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
1349 
1350   <span class="c"># Validate and process fingerprints vectors for similarity calculations...</span>
1351   <span class="c">#</span>
1352   <span class="i">_ValidateAndProcessFingerprintsVectorsForSimilarityCalculation</span><span class="s">(</span><span class="q">&quot;SoergelDistanceCoefficient: Calculation failed&quot;</span><span class="cm">,</span> <span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="cm">,</span> <span class="i">$CalculationMode</span><span class="cm">,</span> <span class="i">$SkipValuesCheck</span><span class="s">)</span><span class="sc">;</span>
1353 
1354   <span class="c"># Perform the calculation...</span>
1355   <span class="k">if</span> <span class="s">(</span><span class="i">$CalculationMode</span> =~ <span class="q">/^AlgebraicForm$/i</span><span class="s">)</span> <span class="s">{</span>
1356     <span class="k">return</span> <span class="i">_SoergelDistanceCoefficientUsingAlgebraicForm</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1357   <span class="s">}</span>
1358   <span class="k">elsif</span> <span class="s">(</span><span class="i">$CalculationMode</span> =~ <span class="q">/^BinaryForm$/i</span><span class="s">)</span> <span class="s">{</span>
1359     <span class="k">return</span> <span class="i">_SoergelDistanceCoefficientUsingBinaryForm</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1360   <span class="s">}</span>
1361   <span class="k">elsif</span> <span class="s">(</span><span class="i">$CalculationMode</span> =~ <span class="q">/^SetTheoreticForm$/i</span><span class="s">)</span> <span class="s">{</span>
1362     <span class="k">return</span> <span class="i">_SoergelDistanceCoefficientUsingSetTheoreticForm</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1363   <span class="s">}</span>
1364   <span class="k">else</span> <span class="s">{</span>
1365     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
1366   <span class="s">}</span>
1367 <span class="s">}</span>
1368 
1369 <span class="c"># Calculate Soergel distance coefficientusing algebraic form...</span>
1370 <span class="c">#</span>
<a name="_SoergelDistanceCoefficientUsingAlgebraicForm-"></a>1371 <span class="k">sub </span><span class="m">_SoergelDistanceCoefficientUsingAlgebraicForm</span> <span class="s">{</span>
1372   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1373   <span class="k">my</span><span class="s">(</span><span class="i">$SumAbsSubtractionXaiXbi</span><span class="cm">,</span> <span class="i">$SumMaxXaiXbi</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
1374 
1375   <span class="i">$SumAbsSubtractionXaiXbi</span> = <span class="i">_GetSumOfAbsoluteValueOfSubtractionOfFingerprintsOrderedValues</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1376   <span class="i">$SumMaxXaiXbi</span> = <span class="i">_GetSumOfMaximumOfFingerprintsOrderdedValues</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1377 
1378   <span class="i">$Numerator</span> = <span class="i">$SumAbsSubtractionXaiXbi</span><span class="sc">;</span>
1379   <span class="i">$Denominator</span> = <span class="i">$SumMaxXaiXbi</span><span class="sc">;</span>
1380 
1381   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
1382 <span class="s">}</span>
1383 
1384 <span class="c"># Calculate Soergel distance coefficient using binary form...</span>
1385 <span class="c">#</span>
<a name="_SoergelDistanceCoefficientUsingBinaryForm-"></a>1386 <span class="k">sub </span><span class="m">_SoergelDistanceCoefficientUsingBinaryForm</span> <span class="s">{</span>
1387   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1388   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
1389 
1390   <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span> = <span class="i">_GetNumOfIndividualAndCommonSetBits</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1391 
1392   <span class="i">$Numerator</span> = <span class="i">$Na</span> + <span class="i">$Nb</span> - <span class="n">2</span> * <span class="i">$Nc</span><span class="sc">;</span>
1393   <span class="i">$Denominator</span> = <span class="i">$Na</span> + <span class="i">$Nb</span> - <span class="i">$Nc</span><span class="sc">;</span>
1394 
1395   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
1396 <span class="s">}</span>
1397 
1398 <span class="c"># Calculate SoergelDistanceCoefficient using set theoretic form...</span>
1399 <span class="c">#</span>
<a name="_SoergelDistanceCoefficientUsingSetTheoreticForm-"></a>1400 <span class="k">sub </span><span class="m">_SoergelDistanceCoefficientUsingSetTheoreticForm</span> <span class="s">{</span>
1401   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1402   <span class="k">my</span><span class="s">(</span><span class="i">$SumMinXaiXbi</span><span class="cm">,</span> <span class="i">$SumXai</span><span class="cm">,</span> <span class="i">$SumXbi</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
1403 
1404   <span class="i">$SumXai</span> = <span class="i">_GetSumOfFingerprintsOrderedValues</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="s">)</span><span class="sc">;</span>
1405   <span class="i">$SumXbi</span> = <span class="i">_GetSumOfFingerprintsOrderedValues</span><span class="s">(</span><span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1406   <span class="i">$SumMinXaiXbi</span> = <span class="i">_GetSumOfMinimumOfFingerprintsOrderdedValues</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1407 
1408   <span class="i">$Numerator</span> = <span class="i">$SumXai</span> + <span class="i">$SumXbi</span> - <span class="n">2</span> * <span class="i">$SumMinXaiXbi</span><span class="sc">;</span>
1409   <span class="i">$Denominator</span> = <span class="i">$SumXai</span> + <span class="i">$SumXbi</span> - <span class="i">$SumMinXaiXbi</span><span class="sc">;</span>
1410 
1411   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
1412 <span class="s">}</span>
1413 
1414 <span class="c"># Validate and process fingerprints vectors for similarity calculations...</span>
1415 <span class="c">#</span>
<a name="_ValidateAndProcessFingerprintsVectorsForSimilarityCalculation-"></a>1416 <span class="k">sub </span><span class="m">_ValidateAndProcessFingerprintsVectorsForSimilarityCalculation</span> <span class="s">{</span>
1417   <span class="k">my</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="cm">,</span> <span class="i">$CalculationMode</span><span class="cm">,</span> <span class="i">$SkipValuesCheck</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1418 
1419   <span class="i">$CalculationMode</span> = <span class="k">defined</span> <span class="i">$CalculationMode</span> ? <span class="i">$CalculationMode</span> <span class="co">:</span> <span class="q">&#39;AlgebraicForm&#39;</span><span class="sc">;</span>
1420   <span class="i">$SkipValuesCheck</span> = <span class="k">defined</span> <span class="i">$SkipValuesCheck</span> ? <span class="i">$SkipValuesCheck</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
1421 
1422   <span class="k">if</span> <span class="s">(</span>!<span class="i">$SkipValuesCheck</span><span class="s">)</span> <span class="s">{</span>
1423     <span class="i">_ValidateFingerprintsVectorsForSimilarityCalculation</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="cm">,</span> <span class="i">$CalculationMode</span><span class="s">)</span><span class="sc">;</span>
1424   <span class="s">}</span>
1425   <span class="i">_ProcessFingerprintsVectorsForSimilarityCalculation</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="cm">,</span> <span class="i">$CalculationMode</span><span class="s">)</span><span class="sc">;</span>
1426 <span class="s">}</span>
1427 
1428 <span class="c"># Make sure fingerprint vectors are good for performing similarity/distance calculation...</span>
1429 <span class="c">#</span>
<a name="_ValidateFingerprintsVectorsForSimilarityCalculation-"></a>1430 <span class="k">sub </span><span class="m">_ValidateFingerprintsVectorsForSimilarityCalculation</span> <span class="s">{</span>
1431   <span class="k">my</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="cm">,</span> <span class="i">$CalculationMode</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1432 
1433   <span class="c"># Make sure both are fingerprint vectors..</span>
1434   <span class="k">if</span> <span class="s">(</span>!<span class="s">(</span><span class="i">IsFingerprintsVector</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="s">)</span> &amp;&amp; <span class="i">IsFingerprintsVector</span><span class="s">(</span><span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1435     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;${ErrorMsg}: Both objects must be fingerprint vectors...&quot;</span><span class="sc">;</span>
1436   <span class="s">}</span>
1437 
1438   <span class="c"># Check types...</span>
1439   <span class="k">if</span> <span class="s">(</span><span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">Type</span>} <span class="k">ne</span> <span class="i">$FingerprintsVectorB</span>-&gt;{<span class="w">Type</span>}<span class="s">)</span> <span class="s">{</span>
1440     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;${ErrorMsg}: Type of first fingerprint vector, $FingerprintsVectorA-&gt;{Type}, must be same as type of second fingerprint vector, $FingerprintsVectorB-&gt;{Type}...&quot;</span><span class="sc">;</span>
1441   <span class="s">}</span>
1442 
1443   <span class="c"># Check calculation mode...</span>
1444   <span class="k">if</span> <span class="s">(</span><span class="i">$CalculationMode</span> !~ <span class="q">/^(AlgebraicForm|BinaryForm|SetTheoreticForm)$/i</span><span class="s">)</span> <span class="s">{</span>
1445     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;${ErrorMsg}: Specified similarity calculation mode, $CalculationMode, is not valid. Supported values: AlgebraicForm, BinaryForm, and SetTheoreticForm...&quot;</span><span class="sc">;</span>
1446   <span class="s">}</span>
1447 
1448   <span class="c"># Check values and value IDs...</span>
1449   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$NIDa</span><span class="cm">,</span> <span class="i">$NIDb</span><span class="s">)</span><span class="sc">;</span>
1450   <span class="i">$Na</span> = <span class="i">$FingerprintsVectorA</span><span class="i">-&gt;GetNumOfValues</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span> <span class="i">$Nb</span> = <span class="i">$FingerprintsVectorB</span><span class="i">-&gt;GetNumOfValues</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1451   <span class="i">$NIDa</span> = <span class="i">$FingerprintsVectorA</span><span class="i">-&gt;GetNumOfValueIDs</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span> <span class="i">$NIDb</span> = <span class="i">$FingerprintsVectorB</span><span class="i">-&gt;GetNumOfValueIDs</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1452 
1453   <span class="k">if</span> <span class="s">(</span><span class="i">$Na</span> == <span class="n">0</span><span class="s">)</span> <span class="s">{</span>
1454     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;${ErrorMsg}: Number of values in first fingerprint vector, $Na, must be &gt; 0 for fingerprint vector type $FingerprintsVectorA-&gt;{Type} ...&quot;</span><span class="sc">;</span>
1455   <span class="s">}</span>
1456   <span class="k">if</span> <span class="s">(</span><span class="i">$Nb</span> == <span class="n">0</span><span class="s">)</span> <span class="s">{</span>
1457     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;${ErrorMsg}: Number of values in second fingerprint vector, $Nb, must be &gt; 0 for fingerprint vector type $FingerprintsVectorB-&gt;{Type} ...&quot;</span><span class="sc">;</span>
1458   <span class="s">}</span>
1459 
1460   <span class="k">if</span> <span class="s">(</span><span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">Type</span>} =~ <span class="q">/^OrderedNumericalValues$/i</span><span class="s">)</span> <span class="s">{</span>
1461     <span class="k">if</span> <span class="s">(</span><span class="i">$Na</span> != <span class="i">$Nb</span><span class="s">)</span> <span class="s">{</span>
1462       <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;${ErrorMsg}: Number of values in first fingerprint vector, $Na, must be equal to number of values, $Nb, in second fingerprint vector for fingerprint vector types $FingerprintsVectorA-&gt;{Type} ...&quot;</span><span class="sc">;</span>
1463     <span class="s">}</span>
1464   <span class="s">}</span>
1465   <span class="k">elsif</span> <span class="s">(</span><span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">Type</span>} =~ <span class="q">/^NumericalValues$/i</span><span class="s">)</span> <span class="s">{</span>
1466     <span class="k">if</span> <span class="s">(</span><span class="i">$NIDa</span> == <span class="n">0</span><span class="s">)</span> <span class="s">{</span>
1467       <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;${ErrorMsg}: Number of value IDs in first fingerprint vector, $NIDa, must be &gt; 0 for fingerprint vector type $FingerprintsVectorA-&gt;{Type} ...&quot;</span><span class="sc">;</span>
1468     <span class="s">}</span>
1469     <span class="k">if</span> <span class="s">(</span><span class="i">$NIDb</span> == <span class="n">0</span><span class="s">)</span> <span class="s">{</span>
1470       <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;${ErrorMsg}: Number of value IDs in first fingerprint vector, $NIDb, must be &gt; 0 for fingerprint vector type $FingerprintsVectorB-&gt;{Type} ...&quot;</span><span class="sc">;</span>
1471     <span class="s">}</span>
1472 
1473     <span class="k">if</span> <span class="s">(</span><span class="i">$NIDa</span> != <span class="i">$Na</span><span class="s">)</span> <span class="s">{</span>
1474       <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;${ErrorMsg}: Number of value IDs in first fingerprint vector, $NIDa, must be equal to its number of values, $Na, for fingerprint vector type $FingerprintsVectorA-&gt;{Type} ...&quot;</span><span class="sc">;</span>
1475     <span class="s">}</span>
1476     <span class="k">if</span> <span class="s">(</span><span class="i">$NIDb</span> != <span class="i">$Nb</span><span class="s">)</span> <span class="s">{</span>
1477       <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;${ErrorMsg}: Number of value IDs in second fingerprint vector, $NIDb, must be equal to its number of values, $Nb, for fingerprint vector type $FingerprintsVectorA-&gt;{Type} ...&quot;</span><span class="sc">;</span>
1478     <span class="s">}</span>
1479   <span class="s">}</span>
1480   <span class="k">elsif</span> <span class="s">(</span><span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">Type</span>} =~ <span class="q">/^AlphaNumericalValues$/i</span><span class="s">)</span> <span class="s">{</span>
1481     <span class="k">if</span> <span class="s">(</span><span class="i">$NIDa</span> || <span class="i">$NIDb</span><span class="s">)</span> <span class="s">{</span>
1482       <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;${ErrorMsg}: ValueIDs cann&#39;t be specified for fingerprint vector types $FingerprintsVectorA-&gt;{Type} ...&quot;</span><span class="sc">;</span>
1483     <span class="s">}</span>
1484   <span class="s">}</span>
1485   <span class="k">else</span> <span class="s">{</span>
1486     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;${ErrorMsg}: Fingerprint vector types $FingerprintsVectorA-&gt;{Type} is not valid...&quot;</span><span class="sc">;</span>
1487   <span class="s">}</span>
1488 <span class="s">}</span>
1489 
1490 <span class="c"># Process fingerprints vectors for similarity calculation by generating vectors</span>
1491 <span class="c"># containing ordered list of values...</span>
1492 <span class="c">#</span>
<a name="_ProcessFingerprintsVectorsForSimilarityCalculation-"></a>1493 <span class="k">sub </span><span class="m">_ProcessFingerprintsVectorsForSimilarityCalculation</span> <span class="s">{</span>
1494   <span class="k">my</span><span class="s">(</span><span class="i">$ErrorMsg</span><span class="cm">,</span> <span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="cm">,</span> <span class="i">$CalculationMode</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1495 
1496   <span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">OrderedValuesRef</span>} = <span class="k">undef</span><span class="sc">;</span> <span class="i">$FingerprintsVectorB</span>-&gt;{<span class="w">OrderedValuesRef</span>} = <span class="k">undef</span><span class="sc">;</span>
1497   <span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">BitVector</span>} = <span class="k">undef</span><span class="sc">;</span> <span class="i">$FingerprintsVectorB</span>-&gt;{<span class="w">BitVector</span>} = <span class="k">undef</span><span class="sc">;</span>
1498 
1499   <span class="k">if</span> <span class="s">(</span><span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">Type</span>} =~ <span class="q">/^OrderedNumericalValues$/i</span><span class="s">)</span> <span class="s">{</span>
1500     <span class="i">_ProcessOrderedNumericalValuesFingerprintsVectorsForSimilarityCalculation</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1501   <span class="s">}</span>
1502   <span class="k">elsif</span> <span class="s">(</span><span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">Type</span>} =~ <span class="q">/^NumericalValues$/i</span><span class="s">)</span> <span class="s">{</span>
1503     <span class="i">_ProcessNumericalValuesFingerprintsVectorsForSimilarityCalculation</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1504   <span class="s">}</span>
1505   <span class="k">elsif</span> <span class="s">(</span><span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">Type</span>} =~ <span class="q">/^AlphaNumericalValues$/i</span><span class="s">)</span> <span class="s">{</span>
1506     <span class="i">_ProcessAlphaNumericalValuesFingerprintsVectorsForSimilarityCalculation</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1507   <span class="s">}</span>
1508   <span class="k">else</span> <span class="s">{</span>
1509     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;${ErrorMsg}: Fingerprint vector types $FingerprintsVectorA-&gt;{Type} is not valid...&quot;</span><span class="sc">;</span>
1510   <span class="s">}</span>
1511   <span class="k">if</span> <span class="s">(</span><span class="i">$CalculationMode</span> =~ <span class="q">/^BinaryForm$/i</span><span class="s">)</span> <span class="s">{</span>
1512     <span class="i">_TransformFinalOrderedValuesIntoBitVectorsForSimilarityCalculation</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span><span class="sc">;</span>
1513   <span class="s">}</span>
1514 <span class="s">}</span>
1515 
1516 <span class="c"># Process fingerprints vectors with ordered numerical values for similarity calculations...</span>
1517 <span class="c">#</span>
<a name="_ProcessOrderedNumericalValuesFingerprintsVectorsForSimilarityCalculation-"></a>1518 <span class="k">sub </span><span class="m">_ProcessOrderedNumericalValuesFingerprintsVectorsForSimilarityCalculation</span> <span class="s">{</span>
1519   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1520 
1521   <span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">OrderedValuesRef</span>} = \<span class="i">@</span>{<span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">Values</span>}}<span class="sc">;</span>
1522   <span class="i">$FingerprintsVectorB</span>-&gt;{<span class="w">OrderedValuesRef</span>} = \<span class="i">@</span>{<span class="i">$FingerprintsVectorB</span>-&gt;{<span class="w">Values</span>}}<span class="sc">;</span>
1523 <span class="s">}</span>
1524 
1525 <span class="c"># Process fingerprints vectors with numerical values for similarity calculations...</span>
1526 <span class="c">#</span>
<a name="_ProcessNumericalValuesFingerprintsVectorsForSimilarityCalculation-"></a>1527 <span class="k">sub </span><span class="m">_ProcessNumericalValuesFingerprintsVectorsForSimilarityCalculation</span> <span class="s">{</span>
1528   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1529 
1530   <span class="c"># Set up unique IDs and values map for each fingerprint vector...</span>
1531   <span class="k">my</span><span class="s">(</span><span class="i">$Index</span><span class="cm">,</span> <span class="i">$Value</span><span class="cm">,</span> <span class="i">$ValueID</span><span class="cm">,</span> <span class="i">%UniqueFingerprintsVectorAValueIDValues</span><span class="cm">,</span> <span class="i">%UniqueFingerprintsVectorBValueIDValues</span><span class="cm">,</span> <span class="i">%UniqueFingerprintsVectorsValueIDs</span><span class="s">)</span><span class="sc">;</span>
1532 
1533   <span class="i">%UniqueFingerprintsVectorAValueIDValues</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1534   <span class="i">%UniqueFingerprintsVectorBValueIDValues</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1535   <span class="i">%UniqueFingerprintsVectorsValueIDs</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1536 
1537   <span class="c"># Go over first vector...</span>
1538   <span class="k">for</span> <span class="i">$Index</span> <span class="s">(</span><span class="n">0</span> .. <span class="i">$#</span>{<span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">ValueIDs</span>}}<span class="s">)</span> <span class="s">{</span>
1539     <span class="i">$ValueID</span> = <span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">ValueIDs</span>}[<span class="i">$Index</span>]<span class="sc">;</span>
1540     <span class="i">$Value</span> = <span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">Values</span>}[<span class="i">$Index</span>]<span class="sc">;</span>
1541     <span class="k">if</span> <span class="s">(</span><span class="k">exists</span> <span class="i">$UniqueFingerprintsVectorAValueIDValues</span>{<span class="i">$ValueID</span>}<span class="s">)</span> <span class="s">{</span>
1542       <span class="i">$UniqueFingerprintsVectorAValueIDValues</span>{<span class="i">$ValueID</span>} += <span class="i">$Value</span><span class="sc">;</span>
1543     <span class="s">}</span>
1544     <span class="k">else</span> <span class="s">{</span>
1545       <span class="i">$UniqueFingerprintsVectorAValueIDValues</span>{<span class="i">$ValueID</span>} = <span class="i">$Value</span><span class="sc">;</span>
1546     <span class="s">}</span>
1547     <span class="k">if</span> <span class="s">(</span>!<span class="k">exists</span> <span class="i">$UniqueFingerprintsVectorsValueIDs</span>{<span class="i">$ValueID</span>}<span class="s">)</span> <span class="s">{</span>
1548       <span class="i">$UniqueFingerprintsVectorsValueIDs</span>{<span class="i">$ValueID</span>} = <span class="n">1</span><span class="sc">;</span>
1549     <span class="s">}</span>
1550   <span class="s">}</span>
1551 
1552   <span class="c"># Go over second vector...</span>
1553   <span class="k">for</span> <span class="i">$Index</span> <span class="s">(</span><span class="n">0</span> .. <span class="i">$#</span>{<span class="i">$FingerprintsVectorB</span>-&gt;{<span class="w">ValueIDs</span>}}<span class="s">)</span> <span class="s">{</span>
1554     <span class="i">$ValueID</span> = <span class="i">$FingerprintsVectorB</span>-&gt;{<span class="w">ValueIDs</span>}[<span class="i">$Index</span>]<span class="sc">;</span>
1555     <span class="i">$Value</span> = <span class="i">$FingerprintsVectorB</span>-&gt;{<span class="w">Values</span>}[<span class="i">$Index</span>]<span class="sc">;</span>
1556     <span class="k">if</span> <span class="s">(</span><span class="k">exists</span> <span class="i">$UniqueFingerprintsVectorBValueIDValues</span>{<span class="i">$ValueID</span>}<span class="s">)</span> <span class="s">{</span>
1557       <span class="i">$UniqueFingerprintsVectorBValueIDValues</span>{<span class="i">$ValueID</span>} += <span class="i">$Value</span><span class="sc">;</span>
1558     <span class="s">}</span>
1559     <span class="k">else</span> <span class="s">{</span>
1560       <span class="i">$UniqueFingerprintsVectorBValueIDValues</span>{<span class="i">$ValueID</span>} = <span class="i">$Value</span><span class="sc">;</span>
1561     <span class="s">}</span>
1562     <span class="k">if</span> <span class="s">(</span>!<span class="k">exists</span> <span class="i">$UniqueFingerprintsVectorsValueIDs</span>{<span class="i">$ValueID</span>}<span class="s">)</span> <span class="s">{</span>
1563       <span class="i">$UniqueFingerprintsVectorsValueIDs</span>{<span class="i">$ValueID</span>} = <span class="n">1</span><span class="sc">;</span>
1564     <span class="s">}</span>
1565   <span class="s">}</span>
1566 
1567   <span class="c"># Setup ordered values...</span>
1568   <span class="k">my</span><span class="s">(</span><span class="i">@UniqueOrderedValueIDs</span><span class="cm">,</span> <span class="i">@OrderedValuesA</span><span class="cm">,</span> <span class="i">@OrderedValuesB</span><span class="s">)</span><span class="sc">;</span>
1569 
1570   <span class="i">@UniqueOrderedValueIDs</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1571   <span class="i">@UniqueOrderedValueIDs</span> = <span class="k">sort</span> <span class="k">keys</span> <span class="i">%UniqueFingerprintsVectorsValueIDs</span><span class="sc">;</span>
1572 
1573   <span class="i">@OrderedValuesA</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1574   <span class="i">@OrderedValuesA</span> = <span class="k">map</span> <span class="s">{</span> <span class="k">exists</span> <span class="i">$UniqueFingerprintsVectorAValueIDValues</span>{<span class="i">$_</span>} ? <span class="i">$UniqueFingerprintsVectorAValueIDValues</span>{<span class="i">$_</span>} <span class="co">:</span> <span class="n">0</span> <span class="s">}</span> <span class="i">@UniqueOrderedValueIDs</span><span class="sc">;</span>
1575 
1576   <span class="i">@OrderedValuesB</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1577   <span class="i">@OrderedValuesB</span> = <span class="k">map</span> <span class="s">{</span> <span class="k">exists</span> <span class="i">$UniqueFingerprintsVectorBValueIDValues</span>{<span class="i">$_</span>} ? <span class="i">$UniqueFingerprintsVectorBValueIDValues</span>{<span class="i">$_</span>} <span class="co">:</span> <span class="n">0</span> <span class="s">}</span> <span class="i">@UniqueOrderedValueIDs</span><span class="sc">;</span>
1578 
1579   <span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">OrderedValuesRef</span>} = \<span class="i">@OrderedValuesA</span><span class="sc">;</span>
1580   <span class="i">$FingerprintsVectorB</span>-&gt;{<span class="w">OrderedValuesRef</span>} = \<span class="i">@OrderedValuesB</span><span class="sc">;</span>
1581 <span class="s">}</span>
1582 
1583 <span class="c"># Process fingerprints vectors with allpha numerical values for similarity calculations...</span>
1584 <span class="c">#</span>
<a name="_ProcessAlphaNumericalValuesFingerprintsVectorsForSimilarityCalculation-"></a>1585 <span class="k">sub </span><span class="m">_ProcessAlphaNumericalValuesFingerprintsVectorsForSimilarityCalculation</span> <span class="s">{</span>
1586   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1587 
1588   <span class="c"># Set up unique IDs and values map for each vector...</span>
1589   <span class="k">my</span><span class="s">(</span><span class="i">$Index</span><span class="cm">,</span> <span class="i">$Value</span><span class="cm">,</span> <span class="i">$ValueID</span><span class="cm">,</span> <span class="i">%UniqueFingerprintsVectorAValuesCount</span><span class="cm">,</span> <span class="i">%UniqueFingerprintsVectorBValuesCount</span><span class="cm">,</span> <span class="i">%UniqueFingerprintsVectorsValues</span><span class="s">)</span><span class="sc">;</span>
1590 
1591   <span class="i">%UniqueFingerprintsVectorAValuesCount</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1592   <span class="i">%UniqueFingerprintsVectorBValuesCount</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1593   <span class="i">%UniqueFingerprintsVectorsValues</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1594 
1595   <span class="c"># Go over first vector...</span>
1596   <span class="k">for</span> <span class="i">$Value</span> <span class="s">(</span><span class="i">@</span>{<span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">Values</span>}}<span class="s">)</span> <span class="s">{</span>
1597     <span class="k">if</span> <span class="s">(</span><span class="k">exists</span> <span class="i">$UniqueFingerprintsVectorAValuesCount</span>{<span class="i">$Value</span>}<span class="s">)</span> <span class="s">{</span>
1598       <span class="i">$UniqueFingerprintsVectorAValuesCount</span>{<span class="i">$Value</span>} += <span class="n">1</span><span class="sc">;</span>
1599     <span class="s">}</span>
1600     <span class="k">else</span> <span class="s">{</span>
1601       <span class="i">$UniqueFingerprintsVectorAValuesCount</span>{<span class="i">$Value</span>} = <span class="n">1</span><span class="sc">;</span>
1602     <span class="s">}</span>
1603     <span class="k">if</span> <span class="s">(</span>!<span class="k">exists</span> <span class="i">$UniqueFingerprintsVectorsValues</span>{<span class="i">$Value</span>}<span class="s">)</span> <span class="s">{</span>
1604       <span class="i">$UniqueFingerprintsVectorsValues</span>{<span class="i">$Value</span>} = <span class="n">1</span><span class="sc">;</span>
1605     <span class="s">}</span>
1606   <span class="s">}</span>
1607 
1608   <span class="c"># Go over second vector...</span>
1609   <span class="k">for</span> <span class="i">$Value</span> <span class="s">(</span><span class="i">@</span>{<span class="i">$FingerprintsVectorB</span>-&gt;{<span class="w">Values</span>}}<span class="s">)</span> <span class="s">{</span>
1610     <span class="k">if</span> <span class="s">(</span><span class="k">exists</span> <span class="i">$UniqueFingerprintsVectorBValuesCount</span>{<span class="i">$Value</span>}<span class="s">)</span> <span class="s">{</span>
1611       <span class="i">$UniqueFingerprintsVectorBValuesCount</span>{<span class="i">$Value</span>} += <span class="n">1</span><span class="sc">;</span>
1612     <span class="s">}</span>
1613     <span class="k">else</span> <span class="s">{</span>
1614       <span class="i">$UniqueFingerprintsVectorBValuesCount</span>{<span class="i">$Value</span>} = <span class="n">1</span><span class="sc">;</span>
1615     <span class="s">}</span>
1616     <span class="k">if</span> <span class="s">(</span>!<span class="k">exists</span> <span class="i">$UniqueFingerprintsVectorsValues</span>{<span class="i">$Value</span>}<span class="s">)</span> <span class="s">{</span>
1617       <span class="i">$UniqueFingerprintsVectorsValues</span>{<span class="i">$Value</span>} = <span class="n">1</span><span class="sc">;</span>
1618     <span class="s">}</span>
1619   <span class="s">}</span>
1620 
1621   <span class="c"># Setup ordered values...</span>
1622   <span class="k">my</span><span class="s">(</span><span class="i">@UniqueOrderedValueIDs</span><span class="cm">,</span> <span class="i">@OrderedValuesA</span><span class="cm">,</span> <span class="i">@OrderedValuesB</span><span class="s">)</span><span class="sc">;</span>
1623 
1624   <span class="i">@UniqueOrderedValueIDs</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1625   <span class="i">@UniqueOrderedValueIDs</span> = <span class="k">sort</span> <span class="k">keys</span> <span class="i">%UniqueFingerprintsVectorsValues</span><span class="sc">;</span>
1626 
1627   <span class="i">@OrderedValuesA</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1628   <span class="i">@OrderedValuesA</span> = <span class="k">map</span> <span class="s">{</span> <span class="k">exists</span> <span class="i">$UniqueFingerprintsVectorAValuesCount</span>{<span class="i">$_</span>} ? <span class="i">$UniqueFingerprintsVectorAValuesCount</span>{<span class="i">$_</span>} <span class="co">:</span> <span class="n">0</span> <span class="s">}</span> <span class="i">@UniqueOrderedValueIDs</span><span class="sc">;</span>
1629 
1630   <span class="i">@OrderedValuesB</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1631   <span class="i">@OrderedValuesB</span> = <span class="k">map</span> <span class="s">{</span> <span class="k">exists</span> <span class="i">$UniqueFingerprintsVectorBValuesCount</span>{<span class="i">$_</span>} ? <span class="i">$UniqueFingerprintsVectorBValuesCount</span>{<span class="i">$_</span>} <span class="co">:</span> <span class="n">0</span> <span class="s">}</span> <span class="i">@UniqueOrderedValueIDs</span><span class="sc">;</span>
1632 
1633   <span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">OrderedValuesRef</span>} = \<span class="i">@OrderedValuesA</span><span class="sc">;</span>
1634   <span class="i">$FingerprintsVectorB</span>-&gt;{<span class="w">OrderedValuesRef</span>} = \<span class="i">@OrderedValuesB</span><span class="sc">;</span>
1635 
1636 <span class="s">}</span>
1637 
1638 <span class="c"># Transform final ordered values array into a BitVector for similarity calculation...</span>
1639 <span class="c">#</span>
<a name="_TransformFinalOrderedValuesIntoBitVectorsForSimilarityCalculation-"></a>1640 <span class="k">sub </span><span class="m">_TransformFinalOrderedValuesIntoBitVectorsForSimilarityCalculation</span> <span class="s">{</span>
1641   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1642   <span class="k">my</span><span class="s">(</span><span class="i">$Index</span><span class="cm">,</span> <span class="i">$Size</span><span class="cm">,</span> <span class="i">$BitVectorA</span><span class="cm">,</span> <span class="i">$BitVectorB</span><span class="cm">,</span> <span class="i">$SkipCheck</span><span class="s">)</span><span class="sc">;</span>
1643 
1644   <span class="c"># Create bit vectors...</span>
1645   <span class="i">$Size</span> = <span class="k">scalar</span> <span class="i">@</span>{<span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">OrderedValuesRef</span>}}<span class="sc">;</span>
1646 
1647   <span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">BitVector</span>} = <span class="i">new</span> <span class="i">BitVector</span><span class="s">(</span><span class="i">$Size</span><span class="s">)</span><span class="sc">;</span>
1648   <span class="i">$FingerprintsVectorB</span>-&gt;{<span class="w">BitVector</span>} = <span class="i">new</span> <span class="i">BitVector</span><span class="s">(</span><span class="i">$Size</span><span class="s">)</span><span class="sc">;</span>
1649 
1650   <span class="c"># Set bits...</span>
1651   <span class="i">$SkipCheck</span> = <span class="n">1</span><span class="sc">;</span>
1652   <span class="k">for</span> <span class="i">$Index</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$Size</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1653     <span class="k">if</span> <span class="s">(</span><span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">OrderedValuesRef</span>}[<span class="i">$Index</span>]<span class="s">)</span> <span class="s">{</span>
1654       <span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">BitVector</span>}<span class="i">-&gt;SetBit</span><span class="s">(</span><span class="i">$Index</span><span class="cm">,</span> <span class="i">$SkipCheck</span><span class="s">)</span><span class="sc">;</span>
1655     <span class="s">}</span>
1656     <span class="k">if</span> <span class="s">(</span><span class="i">$FingerprintsVectorB</span>-&gt;{<span class="w">OrderedValuesRef</span>}[<span class="i">$Index</span>]<span class="s">)</span> <span class="s">{</span>
1657       <span class="i">$FingerprintsVectorB</span>-&gt;{<span class="w">BitVector</span>}<span class="i">-&gt;SetBit</span><span class="s">(</span><span class="i">$Index</span><span class="cm">,</span> <span class="i">$SkipCheck</span><span class="s">)</span><span class="sc">;</span>
1658     <span class="s">}</span>
1659   <span class="s">}</span>
1660 <span class="s">}</span>
1661 
1662 <span class="c"># Return sum of ordered vector values...</span>
1663 <span class="c">#</span>
<a name="_GetSumOfFingerprintsOrderedValues-"></a>1664 <span class="k">sub </span><span class="m">_GetSumOfFingerprintsOrderedValues</span> <span class="s">{</span>
1665   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintVector</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1666 
1667   <span class="k">return</span> <span class="i">StatisticsUtil::Sum</span><span class="s">(</span><span class="i">$FingerprintVector</span>-&gt;{<span class="w">OrderedValuesRef</span>}<span class="s">)</span><span class="sc">;</span>
1668 <span class="s">}</span>
1669 
1670 <span class="c"># Return sum of squared ordered vector values...</span>
1671 <span class="c">#</span>
<a name="_GetSumOfSquaresOfFingerprintsOrderedValues-"></a>1672 <span class="k">sub </span><span class="m">_GetSumOfSquaresOfFingerprintsOrderedValues</span> <span class="s">{</span>
1673   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintVector</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1674 
1675   <span class="k">return</span> <span class="i">StatisticsUtil::SumOfSquares</span><span class="s">(</span><span class="i">$FingerprintVector</span>-&gt;{<span class="w">OrderedValuesRef</span>}<span class="s">)</span><span class="sc">;</span>
1676 <span class="s">}</span>
1677 
1678 <span class="c"># Return sum of product of correponding ordered vector values...</span>
1679 <span class="c">#</span>
<a name="_GetSumOfProductOfFingerprintsOrderedValues-"></a>1680 <span class="k">sub </span><span class="m">_GetSumOfProductOfFingerprintsOrderedValues</span> <span class="s">{</span>
1681   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1682   <span class="k">my</span><span class="s">(</span><span class="i">$Index</span><span class="cm">,</span> <span class="i">$SumProductXaiXbi</span><span class="s">)</span><span class="sc">;</span>
1683 
1684   <span class="i">$SumProductXaiXbi</span> = <span class="n">0</span><span class="sc">;</span>
1685   <span class="k">for</span> <span class="i">$Index</span> <span class="s">(</span><span class="n">0</span> .. <span class="i">$#</span>{<span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">OrderedValuesRef</span>}}<span class="s">)</span> <span class="s">{</span>
1686     <span class="i">$SumProductXaiXbi</span> += <span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">OrderedValuesRef</span>}[<span class="i">$Index</span>] * <span class="i">$FingerprintsVectorB</span>-&gt;{<span class="w">OrderedValuesRef</span>}[<span class="i">$Index</span>]<span class="sc">;</span>
1687   <span class="s">}</span>
1688   <span class="k">return</span> <span class="i">$SumProductXaiXbi</span><span class="sc">;</span>
1689 <span class="s">}</span>
1690 
1691 <span class="c"># Return sum of absolute value of subtraction of correponding ordered vector values...</span>
1692 <span class="c">#</span>
<a name="_GetSumOfAbsoluteValueOfSubtractionOfFingerprintsOrderedValues-"></a>1693 <span class="k">sub </span><span class="m">_GetSumOfAbsoluteValueOfSubtractionOfFingerprintsOrderedValues</span> <span class="s">{</span>
1694   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1695   <span class="k">my</span><span class="s">(</span><span class="i">$Index</span><span class="cm">,</span> <span class="i">$SumAbsSubtractionXaiXbi</span><span class="s">)</span><span class="sc">;</span>
1696 
1697   <span class="i">$SumAbsSubtractionXaiXbi</span> = <span class="n">0</span><span class="sc">;</span>
1698   <span class="k">for</span> <span class="i">$Index</span> <span class="s">(</span><span class="n">0</span> .. <span class="i">$#</span>{<span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">OrderedValuesRef</span>}}<span class="s">)</span> <span class="s">{</span>
1699     <span class="i">$SumAbsSubtractionXaiXbi</span> += <span class="k">abs</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">OrderedValuesRef</span>}[<span class="i">$Index</span>] - <span class="i">$FingerprintsVectorB</span>-&gt;{<span class="w">OrderedValuesRef</span>}[<span class="i">$Index</span>]<span class="s">)</span><span class="sc">;</span>
1700   <span class="s">}</span>
1701   <span class="k">return</span> <span class="i">$SumAbsSubtractionXaiXbi</span><span class="sc">;</span>
1702 <span class="s">}</span>
1703 
1704 <span class="c"># Return sum of squares of subtraction of correponding ordered vector values...</span>
1705 <span class="c">#</span>
<a name="_GetSumOfSquaresOfSubtractionOfFingerprintsOrderedValues-"></a>1706 <span class="k">sub </span><span class="m">_GetSumOfSquaresOfSubtractionOfFingerprintsOrderedValues</span> <span class="s">{</span>
1707   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1708   <span class="k">my</span><span class="s">(</span><span class="i">$Index</span><span class="cm">,</span> <span class="i">$SumSquaresSubtractionXaiXbi</span><span class="s">)</span><span class="sc">;</span>
1709 
1710   <span class="i">$SumSquaresSubtractionXaiXbi</span> = <span class="n">0</span><span class="sc">;</span>
1711   <span class="k">for</span> <span class="i">$Index</span> <span class="s">(</span><span class="n">0</span> .. <span class="i">$#</span>{<span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">OrderedValuesRef</span>}}<span class="s">)</span> <span class="s">{</span>
1712     <span class="i">$SumSquaresSubtractionXaiXbi</span> += <span class="s">(</span><span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">OrderedValuesRef</span>}[<span class="i">$Index</span>] - <span class="i">$FingerprintsVectorB</span>-&gt;{<span class="w">OrderedValuesRef</span>}[<span class="i">$Index</span>]<span class="s">)</span>**<span class="n">2</span><span class="sc">;</span>
1713   <span class="s">}</span>
1714   <span class="k">return</span> <span class="i">$SumSquaresSubtractionXaiXbi</span><span class="sc">;</span>
1715 <span class="s">}</span>
1716 
1717 <span class="c"># Return sum of minimum of correponding ordered vector values...</span>
1718 <span class="c">#</span>
<a name="_GetSumOfMinimumOfFingerprintsOrderdedValues-"></a>1719 <span class="k">sub </span><span class="m">_GetSumOfMinimumOfFingerprintsOrderdedValues</span> <span class="s">{</span>
1720   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1721   <span class="k">my</span><span class="s">(</span><span class="i">$Index</span><span class="cm">,</span> <span class="i">$SumMinXaiXbi</span><span class="s">)</span><span class="sc">;</span>
1722 
1723   <span class="i">$SumMinXaiXbi</span> = <span class="n">0</span><span class="sc">;</span>
1724   <span class="k">for</span> <span class="i">$Index</span> <span class="s">(</span><span class="n">0</span> .. <span class="i">$#</span>{<span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">OrderedValuesRef</span>}}<span class="s">)</span> <span class="s">{</span>
1725     <span class="i">$SumMinXaiXbi</span> += <span class="i">MathUtil::min</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">OrderedValuesRef</span>}[<span class="i">$Index</span>]<span class="cm">,</span> <span class="i">$FingerprintsVectorB</span>-&gt;{<span class="w">OrderedValuesRef</span>}[<span class="i">$Index</span>]<span class="s">)</span><span class="sc">;</span>
1726   <span class="s">}</span>
1727   <span class="k">return</span> <span class="i">$SumMinXaiXbi</span><span class="sc">;</span>
1728 <span class="s">}</span>
1729 
1730 <span class="c"># Return sum of maximum of correponding ordered vector values...</span>
1731 <span class="c">#</span>
<a name="_GetSumOfMaximumOfFingerprintsOrderdedValues-"></a>1732 <span class="k">sub </span><span class="m">_GetSumOfMaximumOfFingerprintsOrderdedValues</span> <span class="s">{</span>
1733   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1734   <span class="k">my</span><span class="s">(</span><span class="i">$Index</span><span class="cm">,</span> <span class="i">$SumMaxXaiXbi</span><span class="s">)</span><span class="sc">;</span>
1735 
1736   <span class="i">$SumMaxXaiXbi</span> = <span class="n">0</span><span class="sc">;</span>
1737   <span class="k">for</span> <span class="i">$Index</span> <span class="s">(</span><span class="n">0</span> .. <span class="i">$#</span>{<span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">OrderedValuesRef</span>}}<span class="s">)</span> <span class="s">{</span>
1738     <span class="i">$SumMaxXaiXbi</span> += <span class="i">MathUtil::max</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">OrderedValuesRef</span>}[<span class="i">$Index</span>]<span class="cm">,</span> <span class="i">$FingerprintsVectorB</span>-&gt;{<span class="w">OrderedValuesRef</span>}[<span class="i">$Index</span>]<span class="s">)</span><span class="sc">;</span>
1739   <span class="s">}</span>
1740   <span class="k">return</span> <span class="i">$SumMaxXaiXbi</span><span class="sc">;</span>
1741 <span class="s">}</span>
1742 
1743 <span class="c"># Get number of Na, Nb and Nc bits in vector A and B for BinaryForm calculation...</span>
1744 <span class="c">#</span>
<a name="_GetNumOfIndividualAndCommonSetBits-"></a>1745 <span class="k">sub </span><span class="m">_GetNumOfIndividualAndCommonSetBits ($$)</span> <span class="s">{</span>
1746   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1747   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="cm">,</span> <span class="i">$Nd</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
1748 
1749   <span class="i">$FingerprintsBitVectorA</span> = <span class="i">$FingerprintsVectorA</span>-&gt;{<span class="w">BitVector</span>}<span class="sc">;</span>
1750   <span class="i">$FingerprintsBitVectorB</span> = <span class="i">$FingerprintsVectorB</span>-&gt;{<span class="w">BitVector</span>}<span class="sc">;</span>
1751 
1752   <span class="c"># Number of bits set to &quot;1&quot; in A</span>
1753   <span class="i">$Na</span> = <span class="i">$FingerprintsBitVectorA</span><span class="i">-&gt;GetNumOfSetBits</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1754 
1755   <span class="c"># Number of bits set to &quot;1&quot; in B</span>
1756   <span class="i">$Nb</span> = <span class="i">$FingerprintsBitVectorB</span><span class="i">-&gt;GetNumOfSetBits</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1757 
1758   <span class="c"># Number of bits set to &quot;1&quot; in both A and B</span>
1759   <span class="k">my</span><span class="s">(</span><span class="i">$NcBitVector</span><span class="s">)</span><span class="sc">;</span>
1760   <span class="i">$NcBitVector</span> = <span class="i">$FingerprintsBitVectorA</span> &amp; <span class="i">$FingerprintsBitVectorB</span><span class="sc">;</span>
1761   <span class="i">$Nc</span> = <span class="i">$NcBitVector</span><span class="i">-&gt;GetNumOfSetBits</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1762 
1763   <span class="k">return</span> <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span><span class="sc">;</span>
1764 <span class="s">}</span>
1765 
1766 <span class="c"># Return a list of supported distance coefficients...</span>
1767 <span class="c">#</span>
<a name="GetSupportedDistanceCoefficients-"></a>1768 <span class="k">sub </span><span class="m">GetSupportedDistanceCoefficients ()</span> <span class="s">{</span>
1769 
1770   <span class="k">return</span> <span class="i">@DistanceCoefficients</span><span class="sc">;</span>
1771 <span class="s">}</span>
1772 
1773 <span class="c"># Return a list of supported similarity coefficients...</span>
1774 <span class="c">#</span>
<a name="GetSupportedSimilarityCoefficients-"></a>1775 <span class="k">sub </span><span class="m">GetSupportedSimilarityCoefficients ()</span> <span class="s">{</span>
1776 
1777   <span class="k">return</span> <span class="i">@SimilarityCoefficients</span><span class="sc">;</span>
1778 <span class="s">}</span>
1779 
1780 <span class="c"># Return a list of supported distance and similarity coefficients...</span>
1781 <span class="c">#</span>
<a name="GetSupportedDistanceAndSimilarityCoefficients-"></a>1782 <span class="k">sub </span><span class="m">GetSupportedDistanceAndSimilarityCoefficients ()</span> <span class="s">{</span>
1783   <span class="k">my</span><span class="s">(</span><span class="i">@DistanceAndSimilarityCoefficients</span><span class="s">)</span><span class="sc">;</span>
1784 
1785   <span class="i">@DistanceAndSimilarityCoefficients</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1786   <span class="k">push</span> <span class="i">@DistanceAndSimilarityCoefficients</span><span class="cm">,</span> <span class="i">@DistanceCoefficients</span><span class="sc">;</span>
1787   <span class="k">push</span> <span class="i">@DistanceAndSimilarityCoefficients</span><span class="cm">,</span> <span class="i">@SimilarityCoefficients</span><span class="sc">;</span>
1788 
1789   <span class="k">return</span> <span class="k">sort</span> <span class="i">@DistanceAndSimilarityCoefficients</span><span class="sc">;</span>
1790 <span class="s">}</span>
1791 
1792 <span class="c"># Is it a fingerprints vector object?</span>
<a name="IsFingerprintsVector-"></a>1793 <span class="k">sub </span><span class="m">IsFingerprintsVector ($)</span> <span class="s">{</span>
1794   <span class="k">my</span><span class="s">(</span><span class="i">$Object</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1795 
1796   <span class="k">return</span> <span class="i">_IsFingerprintsVector</span><span class="s">(</span><span class="i">$Object</span><span class="s">)</span><span class="sc">;</span>
1797 <span class="s">}</span>
1798 
1799 <span class="c"># Is it a fingerprints vector object?</span>
<a name="_IsFingerprintsVector-"></a>1800 <span class="k">sub </span><span class="m">_IsFingerprintsVector</span> <span class="s">{</span>
1801   <span class="k">my</span><span class="s">(</span><span class="i">$Object</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1802 
1803   <span class="k">return</span> <span class="s">(</span><span class="i">Scalar::Util::blessed</span><span class="s">(</span><span class="i">$Object</span><span class="s">)</span> &amp;&amp; <span class="i">$Object</span><span class="i">-&gt;isa</span><span class="s">(</span><span class="i">$ClassName</span><span class="s">)</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
1804 <span class="s">}</span>
1805 
1806 <span class="c"># Return a string containing vector values...</span>
<a name="StringifyFingerprintsVector-"></a>1807 <span class="k">sub </span><span class="m">StringifyFingerprintsVector</span> <span class="s">{</span>
1808   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1809   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsVectorString</span><span class="s">)</span><span class="sc">;</span>
1810 
1811   <span class="c"># Set type, values and value IDs...</span>
1812   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfValues</span><span class="cm">,</span> <span class="i">$ValuesString</span><span class="cm">,</span> <span class="i">$NumOfValueIDs</span><span class="cm">,</span> <span class="i">$ValueIDsString</span><span class="cm">,</span> <span class="i">$MaxValuesToStringify</span><span class="s">)</span><span class="sc">;</span>
1813 
1814   <span class="i">$NumOfValues</span> = <span class="i">$This</span><span class="i">-&gt;GetNumOfValues</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1815   <span class="i">$MaxValuesToStringify</span> = <span class="n">500</span><span class="sc">;</span>
1816 
1817   <span class="k">if</span> <span class="s">(</span><span class="i">$NumOfValues</span> &lt; <span class="i">$MaxValuesToStringify</span><span class="s">)</span> <span class="s">{</span>
1818     <span class="c"># Append all values...</span>
1819     <span class="i">$ValuesString</span> = <span class="i">$NumOfValues</span> ? <span class="k">join</span> <span class="q">&#39; &#39;</span><span class="cm">,</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">Values</span>}} <span class="co">:</span> <span class="q">&#39;None&#39;</span><span class="sc">;</span>
1820   <span class="s">}</span>
1821   <span class="k">else</span> <span class="s">{</span>
1822     <span class="c"># Truncate values...</span>
1823     <span class="k">my</span><span class="s">(</span><span class="i">$Index</span><span class="cm">,</span> <span class="i">@Values</span><span class="s">)</span><span class="sc">;</span>
1824     <span class="k">for</span> <span class="i">$Index</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$MaxValuesToStringify</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1825       <span class="k">push</span> <span class="i">@Values</span><span class="cm">,</span> <span class="i">$This</span>-&gt;{<span class="w">Values</span>}[<span class="i">$Index</span>]<span class="sc">;</span>
1826     <span class="s">}</span>
1827     <span class="i">$ValuesString</span> = <span class="k">join</span><span class="s">(</span><span class="q">&#39; &#39;</span><span class="cm">,</span> <span class="i">@Values</span><span class="s">)</span> . <span class="q">&quot; ...&quot;</span><span class="sc">;</span>
1828   <span class="s">}</span>
1829 
1830   <span class="i">$NumOfValueIDs</span> = <span class="i">$This</span><span class="i">-&gt;GetNumOfValueIDs</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1831   <span class="k">if</span> <span class="s">(</span><span class="i">$NumOfValueIDs</span> &lt; <span class="i">$MaxValuesToStringify</span><span class="s">)</span> <span class="s">{</span>
1832     <span class="c"># Append all valueIDs...</span>
1833     <span class="i">$ValueIDsString</span> = <span class="i">$NumOfValueIDs</span> ? <span class="k">join</span> <span class="q">&#39; &#39;</span><span class="cm">,</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">ValueIDs</span>}} <span class="co">:</span> <span class="q">&#39;None&#39;</span><span class="sc">;</span>
1834   <span class="s">}</span>
1835   <span class="k">else</span> <span class="s">{</span>
1836     <span class="c"># Truncate value IDs...</span>
1837     <span class="k">my</span><span class="s">(</span><span class="i">$Index</span><span class="cm">,</span> <span class="i">@ValueIDs</span><span class="s">)</span><span class="sc">;</span>
1838     <span class="i">@ValueIDs</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1839     <span class="k">for</span> <span class="i">$Index</span> <span class="s">(</span><span class="n">0</span> .. <span class="s">(</span><span class="i">$MaxValuesToStringify</span> - <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1840       <span class="k">push</span> <span class="i">@ValueIDs</span><span class="cm">,</span> <span class="i">$This</span>-&gt;{<span class="w">ValueIDs</span>}[<span class="i">$Index</span>]<span class="sc">;</span>
1841     <span class="s">}</span>
1842     <span class="i">$ValueIDsString</span> = <span class="k">join</span><span class="s">(</span><span class="q">&#39; &#39;</span><span class="cm">,</span> <span class="i">@ValueIDs</span><span class="s">)</span> . <span class="q">&quot; ...&quot;</span><span class="sc">;</span>
1843   <span class="s">}</span>
1844 
1845   <span class="i">$FingerprintsVectorString</span> = <span class="q">&quot;Type: $This-&gt;{Type}; NumOfValues: $NumOfValues&quot;</span><span class="sc">;</span>
1846   <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Type</span>} =~ <span class="q">/^(OrderedNumericalValues|NumericalValues)$/i</span><span class="s">)</span> <span class="s">{</span>
1847     <span class="k">my</span><span class="s">(</span><span class="i">$NumOfNonZeroValues</span><span class="s">)</span><span class="sc">;</span>
1848     <span class="i">$NumOfNonZeroValues</span> = <span class="i">$This</span><span class="i">-&gt;GetNumOfNonZeroValues</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1849     <span class="i">$FingerprintsVectorString</span> .= <span class="q">&quot;; NumOfNonZeroValues: $NumOfNonZeroValues&quot;</span><span class="sc">;</span>
1850   <span class="s">}</span>
1851 
1852   <span class="c"># Append all the values and value IDs...</span>
1853   <span class="k">if</span> <span class="s">(</span><span class="i">$NumOfValues</span> &lt; <span class="i">$MaxValuesToStringify</span><span class="s">)</span> <span class="s">{</span>
1854     <span class="i">$FingerprintsVectorString</span> .= <span class="q">&quot;; Values: &lt;$ValuesString&gt;; NumOfValueIDs: $NumOfValueIDs; ValueIDs: &lt;$ValueIDsString&gt;&quot;</span><span class="sc">;</span>
1855   <span class="s">}</span>
1856   <span class="k">else</span> <span class="s">{</span>
1857     <span class="i">$FingerprintsVectorString</span> .= <span class="q">&quot;; Values (Truncated after $MaxValuesToStringify): &lt;$ValuesString&gt;; NumOfValueIDs: $NumOfValueIDs; ValueIDs (Truncated after $MaxValuesToStringify): &lt;$ValueIDsString&gt;&quot;</span><span class="sc">;</span>
1858   <span class="s">}</span>
1859 
1860   <span class="k">return</span> <span class="i">$FingerprintsVectorString</span><span class="sc">;</span>
1861 <span class="s">}</span>
1862 
<a name="EOF-"></a></pre>
<p>&nbsp;</p>
<br />
<center>
<img src="../../../images/h2o2.png">
</center>
</body>
</html>
